<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØªØ·Ø¨ÙŠÙ‚ Ø¢Ù„ Ø³Ø¹ÙŠØ¯Ø§Ù† Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ø¹ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„ Ø§Ù„Ù…ØªØ±Ø§Ø¨Ø·Ø© (Ù…Ø­Ø¯Ø« 2024-09-28)</title>
    
    <!-- CSS Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet" />
    
    <!-- Arabic Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    
    <!-- Chart.js for Statistics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        body { 
            font-family: 'Noto Sans Arabic', Arial, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .nav-item.active {
            background: linear-gradient(135deg, #3b82f6, #10b981);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }

        /* Mobile Navigation Styles */
        .nav-item-mobile.active {
            background: linear-gradient(135deg, #3b82f6, #10b981);
            color: white !important;
            font-weight: 600;
        }
        
        .nav-item-mobile {
            border: 1px solid transparent;
            font-weight: 500;
        }
        
        .nav-item-mobile:hover {
            background: #f3f4f6;
            border-color: #e5e7eb;
        }

        /* Enhanced Mobile-Responsive Design */
        @media (max-width: 768px) {
            /* Basic Layout */
            body {
                padding: 0;
                margin: 0;
            }
            
            .container {
                padding-left: 8px;
                padding-right: 8px;
            }
            
            /* Cards & Content */
            .card {
                margin: 6px 0;
                padding: 12px !important;
                border-radius: 8px;
            }
            
            /* Grid Layouts */
            .grid {
                grid-template-columns: 1fr !important;
                gap: 8px !important;
            }
            
            .grid-cols-2 {
                grid-template-columns: 1fr 1fr !important;
                gap: 6px !important;
            }
            
            .grid-cols-1 {
                grid-template-columns: 1fr !important;
            }
            
            /* Statistics Cards */
            .stat-card {
                padding: 16px;
                text-align: center;
                margin-bottom: 8px;
            }
            
            /* Modal Improvements */
            .modal .max-w-4xl, .modal .max-w-6xl, .modal .max-w-2xl {
                max-width: 95% !important;
                margin: 8px;
                border-radius: 8px;
            }
            
            .modal-content {
                max-height: 85vh;
                overflow-y: auto;
            }
            
            /* Typography Scaling */
            .text-4xl {
                font-size: 1.75rem !important;
                line-height: 1.2;
            }
            
            .text-3xl {
                font-size: 1.5rem !important;
                line-height: 1.3;
            }
            
            .text-2xl {
                font-size: 1.25rem !important;
                line-height: 1.4;
            }
            
            .text-xl {
                font-size: 1.125rem !important;
            }
            
            /* Spacing Adjustments */
            .px-8, .px-6 {
                padding-left: 12px !important;
                padding-right: 12px !important;
            }
            
            .py-8, .py-6 {
                padding-top: 16px !important;
                padding-bottom: 16px !important;
            }
            
            .mb-8, .mb-6 {
                margin-bottom: 16px !important;
            }
            
            .space-y-6 > * + * {
                margin-top: 12px !important;
            }
            
            .space-y-4 > * + * {
                margin-top: 8px !important;
            }
            
            /* Hide desktop-specific elements */
            .hidden-mobile {
                display: none !important;
            }
            
            /* Mobile-specific visibility */
            .show-mobile {
                display: block !important;
            }
            
            /* Navigation improvements */
            .nav-header {
                padding: 8px 12px !important;
            }
            
            /* Enhanced Data Display for Mobile */
            .family-member-card {
                padding: 10px;
                margin: 3px;
                font-size: 13px;
                border-radius: 6px;
                border: 1px solid #e5e7eb;
                background: rgba(255, 255, 255, 0.95);
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                transition: all 0.2s ease;
            }
            
            .family-member-card:active {
                transform: scale(0.98);
                box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            }
            
            .generation-title {
                font-size: 1rem !important;
                padding: 6px 0;
                text-align: center;
                background: rgba(59, 130, 246, 0.1);
                border-radius: 6px;
                margin: 8px 0;
            }
            
            /* Card Grid Improvements */
            .grid.grid-cols-1 .family-member-card,
            .grid.grid-cols-2 .family-member-card,
            .grid.grid-cols-3 .family-member-card {
                min-height: 120px;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
            }
            
            /* Stats Cards */
            .stat-card {
                padding: 12px !important;
                border-radius: 8px;
                text-align: center;
                background: rgba(255, 255, 255, 0.9);
                border: 1px solid rgba(59, 130, 246, 0.2);
            }
            
            .stat-card h4 {
                font-size: 0.875rem;
                margin-bottom: 4px;
            }
            
            .stat-card .text-3xl {
                font-size: 1.5rem !important;
                font-weight: 700;
            }
            
            /* Event Cards */
            .event-card {
                padding: 12px;
                margin: 6px 0;
                border-radius: 8px;
                background: rgba(255, 255, 255, 0.95);
                border-left: 4px solid #3b82f6;
            }
            
            /* Suggestion Cards */
            .suggestion-card {
                padding: 10px;
                margin: 4px 0;
                border-radius: 6px;
                font-size: 14px;
                background: rgba(255, 255, 255, 0.9);
            }
            
            /* Library Cards */
            .library-item {
                padding: 12px;
                border-radius: 8px;
                background: rgba(255, 255, 255, 0.95);
                margin-bottom: 8px;
            }
            
            .library-item h4 {
                font-size: 1rem;
                line-height: 1.3;
                margin-bottom: 6px;
            }
            
            .library-item p {
                font-size: 0.875rem;
                line-height: 1.4;
                color: #6b7280;
            }
            
            /* Table Alternatives for Mobile */
            .mobile-table {
                display: block;
            }
            
            .mobile-table-row {
                display: block;
                padding: 12px;
                margin: 6px 0;
                background: white;
                border-radius: 6px;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            }
            
            .mobile-table-cell {
                display: block;
                padding: 4px 0;
                border-bottom: 1px solid #f3f4f6;
            }
            
            .mobile-table-cell:last-child {
                border-bottom: none;
            }
            
            .mobile-table-label {
                font-weight: 600;
                color: #374151;
                font-size: 0.875rem;
                margin-bottom: 2px;
            }
            
            .mobile-table-value {
                color: #6b7280;
                font-size: 0.875rem;
            }
            
            /* Bottom Navigation for Mobile */
            .bottom-nav {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: rgba(255, 255, 255, 0.95);
                backdrop-filter: blur(10px);
                border-top: 1px solid #e5e7eb;
                padding: 8px 0 max(8px, env(safe-area-inset-bottom));
                z-index: 100;
                display: none;
            }
            
            .bottom-nav-grid {
                display: grid;
                grid-template-columns: repeat(5, 1fr);
                gap: 0;
                max-width: 500px;
                margin: 0 auto;
                padding: 0 8px;
            }
            
            .bottom-nav-item {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                padding: 6px 4px;
                border-radius: 6px;
                text-decoration: none;
                color: #6b7280;
                font-size: 11px;
                font-weight: 500;
                transition: all 0.2s ease;
                touch-action: manipulation;
                min-height: 48px;
            }
            
            .bottom-nav-item i {
                font-size: 18px;
                margin-bottom: 2px;
            }
            
            .bottom-nav-item.active {
                color: #3b82f6;
                background: rgba(59, 130, 246, 0.1);
            }
            
            .bottom-nav-item:active {
                transform: scale(0.95);
            }
            
            /* Show bottom nav on mobile */
            @media (max-width: 768px) {
                .bottom-nav {
                    display: block;
                }
                
                /* Add bottom padding to content to avoid overlap */
                .main-content {
                    padding-bottom: 80px;
                }
            }
        }

        /* Enhanced Touch-Friendly Elements */
        @media (max-width: 768px) {
            /* Buttons */
            button, .btn, .nav-item-mobile {
                min-height: 48px;
                padding: 14px 18px;
                font-size: 16px;
                border-radius: 8px;
                transition: all 0.2s ease;
                touch-action: manipulation;
            }
            
            /* Form Elements */
            input, select, textarea {
                min-height: 48px;
                padding: 14px 16px;
                font-size: 16px;
                border-radius: 6px;
                border: 2px solid #e5e7eb;
                transition: border-color 0.2s ease;
            }
            
            input:focus, select:focus, textarea:focus {
                border-color: #3b82f6;
                outline: none;
                box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            }
            
            /* Mobile Menu Enhancements */
            #mobileNavigation {
                position: fixed;
                top: 100%;
                left: 0;
                right: 0;
                background: white;
                border-radius: 16px 16px 0 0;
                box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);
                transform: translateY(0);
                transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                z-index: 1000;
                max-height: 70vh;
                overflow-y: auto;
            }
            
            #mobileNavigation.show {
                transform: translateY(-100%);
            }
            
            .nav-item-mobile {
                display: flex;
                align-items: center;
                justify-content: flex-start;
                margin-bottom: 4px;
                font-weight: 500;
                border: 2px solid transparent;
            }
            
            .nav-item-mobile:active {
                transform: scale(0.98);
            }
            
            .nav-item-mobile.active {
                background: linear-gradient(135deg, #3b82f6, #10b981);
                color: white !important;
                border-color: transparent;
                box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
            }
            
            .nav-item-mobile i {
                width: 24px;
                text-align: center;
                margin-left: 12px;
                font-size: 18px;
            }
            
            /* Mobile Menu Button */
            #mobileMenuButton {
                min-height: 44px;
                min-width: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 8px;
                transition: all 0.2s ease;
            }
            
            #mobileMenuButton:active {
                transform: scale(0.95);
            }
            
            /* Toast Positioning for Mobile */
            .toast {
                top: 10px;
                right: 10px;
                left: 10px;
                transform: translateY(-100px);
                border-radius: 6px;
                font-size: 14px;
            }
            
            .toast.show {
                transform: translateY(0);
            }
        }
        
        /* Extra Small Screens (phones in portrait) */
        @media (max-width: 480px) {
            .container {
                padding: 4px;
            }
            
            .card {
                padding: 8px !important;
                margin: 4px 0;
            }
            
            button, .btn {
                min-height: 44px;
                padding: 12px 16px;
                font-size: 15px;
            }
            
            .text-3xl {
                font-size: 1.375rem !important;
            }
            
            .text-2xl {
                font-size: 1.125rem !important;
            }
        }
        
        .section { display: none; }
        .section.active { display: block; }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }
        .card:hover {
            box-shadow: 0 10px 25px -3px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .modal { 
            backdrop-filter: blur(5px);
        }
        
        /* Enhanced Modal Styles for Mobile */
        @media (max-width: 768px) {
            .modal {
                padding: 8px;
            }
            
            .modal .bg-white {
                max-height: 90vh;
                border-radius: 12px 12px 0 0;
                margin-top: auto;
                margin-bottom: 0;
            }
            
            .modal .max-w-4xl, .modal .max-w-6xl, .modal .max-w-2xl, .modal .max-w-lg {
                max-width: 100% !important;
                width: 100% !important;
                margin: 0;
            }
            
            /* Modal Header */
            .modal h3 {
                font-size: 1.25rem;
                line-height: 1.4;
            }
            
            /* Modal Content */
            .modal .overflow-y-auto {
                max-height: 75vh;
            }
            
            /* Form Grid in Modals */
            .modal .grid-cols-2 {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .modal .grid-cols-3 {
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            /* Modal Buttons */
            .modal button {
                min-height: 48px;
                padding: 12px 20px;
                font-size: 16px;
            }
            
            .modal .flex.gap-4 {
                flex-direction: column;
                gap: 8px;
            }
            
            .modal .flex.gap-4 button {
                width: 100%;
            }
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #10b981);
            transition: all 0.3s;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #2563eb, #059669);
            transform: translateY(-1px);
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            padding: 12px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        .toast.show { transform: translateX(0); }
        .toast.success { background: linear-gradient(135deg, #10b981, #059669); }
        .toast.error { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .toast.warning { background: linear-gradient(135deg, #f59e0b, #d97706); }

        /* Ø¥ØµÙ„Ø§Ø­ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© */
        canvas {
            max-height: 300px !important;
            width: 100% !important;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            overflow: hidden;
        }

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ© Ø§Ù„Ù…Ø­Ø³Ù† */
        .generation {
            margin-bottom: 40px;
            border-left: 4px solid #3b82f6;
            padding-left: 25px;
            position: relative;
        }
        
        .generation::before {
            content: '';
            position: absolute;
            left: -2px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, #3b82f6, #10b981);
        }
        
        .generation-header {
            background: linear-gradient(135deg, #3b82f6, #10b981);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        
        .member-card {
            margin: 15px 0;
            border-right: 3px solid #10b981;
            padding-right: 20px;
            position: relative;
        }
        
        .founder-card {
            border-right: 3px solid #fbbf24;
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(59, 130, 246, 0.05));
        }
        
        .connection-line {
            border-left: 2px dashed #cbd5e1;
            margin-right: 25px;
            padding-left: 25px;
            position: relative;
        }
        
        .connection-line::before {
            content: 'â†³';
            position: absolute;
            left: -15px;
            top: 20px;
            color: #3b82f6;
            font-size: 18px;
            font-weight: bold;
        }

        .member-actions {
            position: absolute;
            top: 15px;
            left: 15px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .member-card:hover .member-actions {
            opacity: 1;
        }
        
        .edit-btn, .delete-btn {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 8px;
            margin: 2px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .edit-btn:hover { background: #3b82f6; color: white; }
        .delete-btn:hover { background: #ef4444; color: white; }

        /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }
        
        .stat-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold text-gray-800 ml-4">
                        <i class="fas fa-home text-blue-600 ml-2"></i>
                        ØªØ·Ø¨ÙŠÙ‚ Ø¢Ù„ Ø³Ø¹ÙŠØ¯Ø§Ù† Ø§Ù„Ø´Ø§Ù…Ù„
                    </h1>
                </div>
                
                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-8 rtl:space-x-reverse">
                    <!-- Navigation Items (shown when logged in) -->
                    <div id="mainNavigation" class="flex space-x-8 rtl:space-x-reverse">
                        <button id="nav-home" class="nav-item active px-4 py-2 rounded-lg transition" onclick="showSection('home')">
                            <i class="fas fa-home ml-2"></i>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                        </button>
                        <button id="nav-family" class="nav-item px-4 py-2 rounded-lg transition" onclick="showSection('family')">
                            <i class="fas fa-users ml-2"></i>Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ©
                        </button>
                        <button id="nav-events" class="nav-item px-4 py-2 rounded-lg transition" onclick="showSection('events')">
                            <i class="fas fa-calendar ml-2"></i>Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
                        </button>
                        <button id="nav-suggestions" class="nav-item px-4 py-2 rounded-lg transition" onclick="showSection('suggestions')">
                            <i class="fas fa-lightbulb ml-2"></i>Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
                        </button>
                        <button id="nav-library" class="nav-item px-4 py-2 rounded-lg transition" onclick="showSection('library')">
                            <i class="fas fa-book ml-2"></i>Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©
                        </button>
                    </div>

                    <!-- Desktop User Menu -->
                    <div class="flex items-center space-x-4 rtl:space-x-reverse">
                        <!-- Admin Panel (admin only) -->
                        <button id="nav-admin-desktop" class="nav-item px-4 py-2 rounded-lg transition bg-red-100 text-red-700 border border-red-300 hidden relative" onclick="showSection('admin')">
                            <i class="fas fa-cog ml-2"></i>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                            <span id="pending-badge-desktop" class="hidden absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center animate-pulse"></span>
                        </button>
                        
                        <!-- User Profile -->
                        <div class="relative" id="userProfileMenuDesktop">
                            <button onclick="showSection('profile')" class="flex items-center px-4 py-2 rounded-lg bg-blue-100 text-blue-700 hover:bg-blue-200 transition">
                                <i class="fas fa-user ml-2"></i>
                                <span id="currentUserNameDesktop">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</span>
                            </button>
                        </div>
                        
                        <!-- Logout -->
                        <button onclick="logout()" class="px-4 py-2 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200 transition">
                            <i class="fas fa-sign-out-alt ml-2"></i>Ø®Ø±ÙˆØ¬
                        </button>
                    </div>
                    
                    <!-- Desktop Login/Register buttons (shown when not logged in) -->
                    <div id="authButtonsDesktop" class="flex items-center space-x-4 rtl:space-x-reverse">
                        <button onclick="showLoginModal()" class="px-6 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition">
                            <i class="fas fa-sign-in-alt ml-2"></i>Ø¯Ø®ÙˆÙ„
                        </button>
                        <button onclick="showRegisterModal()" class="px-6 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 transition">
                            <i class="fas fa-user-plus ml-2"></i>ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
                        </button>
                    </div>
                </div>

                <!-- Mobile Menu Button -->
                <div class="md:hidden">
                    <button id="mobileMenuButton" onclick="toggleMobileMenu()" class="p-2 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200 transition">
                        <i id="mobileMenuIcon" class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
            
            <!-- Mobile Navigation Menu -->
            <div id="mobileNavigation" class="md:hidden hidden bg-white border-t border-gray-200">
                <div class="px-4 py-4 space-y-2">
                    <!-- Mobile Main Navigation -->
                    <div id="mainNavigationMobile" class="space-y-2 border-b border-gray-200 pb-4">
                        <button class="w-full text-right py-3 px-4 rounded-lg hover:bg-gray-100 transition nav-item-mobile active" onclick="showSection('home'); toggleMobileMenu();">
                            <i class="fas fa-home ml-2 text-blue-600"></i>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                        </button>
                        <button class="w-full text-right py-3 px-4 rounded-lg hover:bg-gray-100 transition nav-item-mobile" onclick="showSection('family'); toggleMobileMenu();">
                            <i class="fas fa-users ml-2 text-green-600"></i>Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ©
                        </button>
                        <button class="w-full text-right py-3 px-4 rounded-lg hover:bg-gray-100 transition nav-item-mobile" onclick="showSection('events'); toggleMobileMenu();">
                            <i class="fas fa-calendar ml-2 text-purple-600"></i>Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
                        </button>
                        <button class="w-full text-right py-3 px-4 rounded-lg hover:bg-gray-100 transition nav-item-mobile" onclick="showSection('suggestions'); toggleMobileMenu();">
                            <i class="fas fa-lightbulb ml-2 text-yellow-600"></i>Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
                        </button>
                        <button class="w-full text-right py-3 px-4 rounded-lg hover:bg-gray-100 transition nav-item-mobile" onclick="showSection('library'); toggleMobileMenu();">
                            <i class="fas fa-book ml-2 text-indigo-600"></i>Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©
                        </button>
                    </div>
                    
                    <!-- Mobile User Menu (logged in) -->
                    <div id="userMenuMobile" class="space-y-2 border-b border-gray-200 pb-4">
                        <!-- Admin Panel (admin only) -->
                        <button id="nav-admin-mobile" class="w-full text-right py-3 px-4 rounded-lg bg-red-50 text-red-700 hover:bg-red-100 transition hidden relative" onclick="showSection('admin'); toggleMobileMenu();">
                            <i class="fas fa-cog ml-2"></i>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                            <span id="pending-badge-mobile" class="hidden absolute top-2 left-4 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center animate-pulse"></span>
                        </button>
                        
                        <!-- User Profile -->
                        <button class="w-full text-right py-3 px-4 rounded-lg bg-blue-50 text-blue-700 hover:bg-blue-100 transition" onclick="showSection('profile'); toggleMobileMenu();">
                            <i class="fas fa-user ml-2"></i>
                            <span id="currentUserNameMobile">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</span>
                        </button>
                        
                        <!-- Logout -->
                        <button onclick="logout(); toggleMobileMenu();" class="w-full text-right py-3 px-4 rounded-lg bg-gray-50 text-gray-700 hover:bg-gray-100 transition">
                            <i class="fas fa-sign-out-alt ml-2"></i>Ø®Ø±ÙˆØ¬
                        </button>
                    </div>
                    
                    <!-- Mobile Login/Register buttons (not logged in) -->
                    <div id="authButtonsMobile" class="space-y-2">
                        <button onclick="showLoginModal(); toggleMobileMenu();" class="w-full py-3 px-4 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition">
                            <i class="fas fa-sign-in-alt ml-2"></i>Ø¯Ø®ÙˆÙ„
                        </button>
                        <button onclick="showRegisterModal(); toggleMobileMenu();" class="w-full py-3 px-4 rounded-lg bg-green-600 text-white hover:bg-green-700 transition">
                            <i class="fas fa-user-plus ml-2"></i>ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Sync Status Bar -->
    <div class="bg-blue-50 border-b border-blue-200">
        <div class="max-w-7xl mx-auto px-4 py-2">
            <div id="syncStatus" class="text-center text-blue-700">
                <span class="font-medium">ğŸ”„ ØªØ·Ø¨ÙŠÙ‚ Ø¢Ù„ Ø³Ø¹ÙŠØ¯Ø§Ù† Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ø¹ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„ Ø§Ù„Ù…ØªØ±Ø§Ø¨Ø·Ø©</span>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-2 md:px-4 py-4 md:py-8 main-content">
        <!-- Home Section -->
        <section id="home-section" class="section active">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <!-- Statistics Cards -->
                <div class="stat-card">
                    <i class="fas fa-users stat-icon text-blue-600"></i>
                    <div class="stat-number text-blue-600" id="total-members">0</div>
                    <p class="text-gray-600 font-medium">Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-calendar-alt stat-icon text-green-600"></i>
                    <div class="stat-number text-green-600" id="total-events">0</div>
                    <p class="text-gray-600 font-medium">Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-lightbulb stat-icon text-yellow-600"></i>
                    <div class="stat-number text-yellow-600" id="total-suggestions">0</div>
                    <p class="text-gray-600 font-medium">Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-book stat-icon text-purple-600"></i>
                    <div class="stat-number text-purple-600" id="total-library">0</div>
                    <p class="text-gray-600 font-medium">Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</p>
                </div>
            </div>
            
            <!-- Additional Statistics -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="stat-card">
                    <i class="fas fa-layer-group stat-icon text-indigo-600"></i>
                    <div class="stat-number text-indigo-600" id="total-generations">1</div>
                    <p class="text-gray-600 font-medium">Ø§Ù„Ø£Ø¬ÙŠØ§Ù„</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-crown stat-icon text-amber-600"></i>
                    <div class="stat-number text-amber-600" id="board-members">0</div>
                    <p class="text-gray-600 font-medium">Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-chart-line stat-icon text-rose-600"></i>
                    <div class="stat-number text-rose-600" id="active-events">0</div>
                    <p class="text-gray-600 font-medium">Ø£Ø­Ø¯Ø§Ø« Ù†Ø´Ø·Ø©</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-thumbs-up stat-icon text-emerald-600"></i>
                    <div class="stat-number text-emerald-600" id="approved-suggestions">0</div>
                    <p class="text-gray-600 font-medium">Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ù…Ù‚Ø¨ÙˆÙ„Ø©</p>
                </div>
            </div>
            
            <!-- Welcome Message -->
            <div class="card p-8 text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒÙ… ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø¢Ù„ Ø³Ø¹ÙŠØ¯Ø§Ù† Ø§Ù„Ø´Ø§Ù…Ù„</h2>
                <p class="text-xl text-gray-600 mb-6">Ø¥Ø¯Ø§Ø±Ø© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ© Ù…Ø¹ Ø±Ø¨Ø· Ø§Ù„Ø£Ø¬ÙŠØ§Ù„ØŒ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«ØŒ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª ÙˆØ§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</p>
                
                <div class="bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-lg p-6 mb-6">
                    <h3 class="text-xl font-bold text-blue-800 mb-3">
                        <i class="fas fa-sitemap ml-2"></i>
                        Ø§Ù„Ù…ÙŠØ²Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©: Ø§Ù„Ø£Ø¬ÙŠØ§Ù„ Ø§Ù„Ù…ØªØ±Ø§Ø¨Ø·Ø©
                    </h3>
                    <p class="text-blue-700 font-medium mb-2">ğŸŒ³ ÙƒÙ„ Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯ ÙŠÙØ±Ø¨Ø· ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø³Ø§Ø¨Ù‚</p>
                    <p class="text-blue-700 font-medium mb-2">ğŸ”¢ Ø­Ø³Ø§Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø£Ø¬ÙŠØ§Ù„: Ø§Ù„Ø¬ÙŠÙ„ = Ø¬ÙŠÙ„ Ø§Ù„ÙˆØ§Ù„Ø¯ + 1</p>
                    <p class="text-blue-700 font-medium">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Ø¹Ø±Ø¶ Ù‡Ø±Ù…ÙŠ Ù…Ù†Ø¸Ù… Ù„Ù„Ø¹Ø§Ø¦Ù„Ø© Ø­Ø³Ø¨ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <button onclick="showSection('family')" class="btn-primary text-white px-8 py-4 rounded-lg text-lg">
                        <i class="fas fa-sitemap ml-2"></i>Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ©
                    </button>
                    <button onclick="loadSampleData()" class="bg-amber-600 text-white px-8 py-4 rounded-lg text-lg hover:bg-amber-700">
                        <i class="fas fa-database ml-2"></i>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                    </button>
                    <button onclick="app.showDataSyncStatus()" class="bg-blue-600 text-white px-8 py-4 rounded-lg text-lg hover:bg-blue-700">
                        <i class="fas fa-sync-alt ml-2"></i>Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    </button>
                    <button onclick="window.open('enhanced-data-sync.html', '_blank')" class="bg-indigo-600 text-white px-8 py-4 rounded-lg text-lg hover:bg-indigo-700">
                        <i class="fas fa-cogs ml-2"></i>Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
                    </button>
                    <button onclick="resetAndReloadFamily()" class="bg-red-600 text-white px-8 py-4 rounded-lg text-lg hover:bg-red-700">
                        <i class="fas fa-refresh ml-2"></i>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒØ§Ù…Ù„
                    </button>
                    <button onclick="checkMemberCount()" class="bg-blue-600 text-white px-8 py-4 rounded-lg text-lg hover:bg-blue-700">
                        <i class="fas fa-info-circle ml-2"></i>ÙØ­Øµ Ø§Ù„Ø¹Ø¯Ø¯
                    </button>
                    <button onclick="forceLoadRealFamily()" class="bg-green-600 text-white px-8 py-4 rounded-lg text-lg hover:bg-green-700">
                        <i class="fas fa-rocket ml-2"></i>Ø­Ù‚Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
                    </button>
                    <button onclick="quickLogin()" class="bg-purple-600 text-white px-8 py-4 rounded-lg text-lg hover:bg-purple-700">
                        <i class="fas fa-key ml-2"></i>Ø¯Ø®ÙˆÙ„ Ø³Ø±ÙŠØ¹ ÙƒÙ…Ø¯ÙŠØ±
                    </button>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©</h3>
                    <div class="chart-container">
                        <canvas id="membershipChart"></canvas>
                    </div>
                </div>
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ</h3>
                    <div class="chart-container">
                        <canvas id="activityChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Family Section -->
        <section id="family-section" class="section">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-bold text-white">Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ© Ø¨Ø§Ù„Ø£Ø¬ÙŠØ§Ù„ Ø§Ù„Ù…ØªØ±Ø§Ø¨Ø·Ø©</h2>
                <div class="flex gap-3">
                    <button onclick="testSecondGenerationRetrieval()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700" title="Ø§Ø®ØªØ¨Ø§Ø± Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ">
                        <i class="fas fa-search ml-2"></i>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ
                    </button>
                    <button onclick="loadFounderFamily()" class="bg-amber-600 text-white px-4 py-2 rounded-lg hover:bg-amber-700">
                        <i class="fas fa-crown ml-2"></i>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                    </button>
                    <button onclick="resetAndReloadFamily()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">
                        <i class="fas fa-refresh ml-2"></i>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† + ØªØ­Ù…ÙŠÙ„
                    </button>
                    <button onclick="forceLoadRealFamily()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                        <i class="fas fa-rocket ml-2"></i>Ø­Ù‚Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    </button>
                    <button onclick="showFamilyModal()" class="btn-primary text-white px-6 py-3 rounded-lg">
                        <i class="fas fa-plus ml-2"></i>Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯
                    </button>
                </div>
            </div>
            
            <!-- Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
            <div id="data-status" class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 text-center">
                <div class="flex items-center justify-center space-x-4 rtl:space-x-reverse">
                    <div class="text-blue-700">
                        <span id="member-count-display">ğŸ“Š Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</span>
                    </div>
                    <div class="text-green-700">
                        <span id="generation-count-display">ğŸŒ³ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„: 0</span>
                    </div>
                </div>
            </div>

            <div id="family-tree" class="space-y-6">
                <!-- Family tree will be displayed here -->
            </div>
        </section>

        <!-- Events Section -->
        <section id="events-section" class="section">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-bold text-white">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ©</h2>
                <button onclick="showEventModal()" class="btn-primary text-white px-6 py-3 rounded-lg">
                    <i class="fas fa-plus ml-2"></i>Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø¬Ø¯ÙŠØ¯
                </button>
            </div>

            <!-- Event Categories -->
            <div class="card p-6 mb-8">
                <h3 class="text-xl font-bold text-gray-800 mb-4">ÙØ¦Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <button onclick="filterEventsByType('wedding')" class="p-4 bg-pink-100 rounded-lg hover:bg-pink-200 transition">
                        <i class="fas fa-heart text-pink-600 text-2xl mb-2"></i>
                        <p class="text-pink-700 font-semibold">Ø§Ù„Ø£ÙØ±Ø§Ø­ ÙˆØ§Ù„Ø²ÙˆØ§Ø¬</p>
                    </button>
                    <button onclick="filterEventsByType('birth')" class="p-4 bg-blue-100 rounded-lg hover:bg-blue-200 transition">
                        <i class="fas fa-baby text-blue-600 text-2xl mb-2"></i>
                        <p class="text-blue-700 font-semibold">Ø§Ù„Ù…ÙˆØ§Ù„ÙŠØ¯</p>
                    </button>
                    <button onclick="filterEventsByType('graduation')" class="p-4 bg-green-100 rounded-lg hover:bg-green-200 transition">
                        <i class="fas fa-graduation-cap text-green-600 text-2xl mb-2"></i>
                        <p class="text-green-700 font-semibold">Ø§Ù„ØªØ®Ø±Ø¬ ÙˆØ§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</p>
                    </button>
                    <button onclick="filterEventsByType('gathering')" class="p-4 bg-yellow-100 rounded-lg hover:bg-yellow-200 transition">
                        <i class="fas fa-users text-yellow-600 text-2xl mb-2"></i>
                        <p class="text-yellow-700 font-semibold">Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ©</p>
                    </button>
                </div>
            </div>
            
            <!-- Events Grid -->
            <div id="events-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Events will be displayed here -->
            </div>
        </section>

        <!-- Suggestions Section -->
        <section id="suggestions-section" class="section">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-bold text-white">Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª ÙˆØ§Ù„ØªØ·ÙˆÙŠØ±</h2>
                <button onclick="showSuggestionModal()" class="btn-primary text-white px-6 py-3 rounded-lg">
                    <i class="fas fa-plus ml-2"></i>Ø¥Ø¶Ø§ÙØ© Ø§Ù‚ØªØ±Ø§Ø­ Ø¬Ø¯ÙŠØ¯
                </button>
            </div>

            <!-- Filter Bar -->
            <div class="card p-6 mb-8">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <!-- Status Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­</label>
                        <select id="suggestionStatusFilter" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                onchange="filterSuggestionsByStatus(this.value)">
                            <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                            <option value="pending">â³ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</option>
                            <option value="approved">âœ… Ù…Ù‚Ø¨ÙˆÙ„</option>
                            <option value="rejected">âŒ Ù…Ø±ÙÙˆØ¶</option>
                            <option value="under_review">ğŸ” ØªØ­Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</option>
                        </select>
                    </div>

                    <!-- Category Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ÙØ¦Ø©</label>
                        <select id="suggestionCategoryFilter" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                onchange="filterSuggestionsByCategory(this.value)">
                            <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</option>
                            <option value="technology">ğŸ”§ ØªÙ‚Ù†ÙŠ</option>
                            <option value="events">ğŸ‰ ÙØ¹Ø§Ù„ÙŠØ§Øª</option>
                            <option value="services">ğŸ›ï¸ Ø®Ø¯Ù…Ø§Øª</option>
                            <option value="education">ğŸ“š ØªØ¹Ù„ÙŠÙ…ÙŠ</option>
                            <option value="social">ğŸ‘¥ Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ</option>
                            <option value="business">ğŸ’¼ ØªØ¬Ø§Ø±ÙŠ</option>
                            <option value="other">ğŸ“ Ø£Ø®Ø±Ù‰</option>
                        </select>
                    </div>

                    <!-- Priority Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</label>
                        <select id="suggestionPriorityFilter" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                onchange="filterSuggestionsByPriority(this.value)">
                            <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª</option>
                            <option value="urgent">ğŸš¨ Ø¹Ø§Ø¬Ù„</option>
                            <option value="high">ğŸ”´ Ø¹Ø§Ù„ÙŠØ©</option>
                            <option value="medium">ğŸŸ¡ Ù…ØªÙˆØ³Ø·Ø©</option>
                            <option value="low">ğŸŸ¢ Ù…Ù†Ø®ÙØ¶Ø©</option>
                        </select>
                    </div>
                </div>

                <!-- Quick Stats -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 pt-4 border-t border-gray-200">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-blue-600" id="suggestions-total">0</div>
                        <p class="text-sm text-gray-600">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª</p>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-yellow-600" id="suggestions-pending">0</div>
                        <p class="text-sm text-gray-600">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</p>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-600" id="suggestions-approved">0</div>
                        <p class="text-sm text-gray-600">Ù…Ù‚Ø¨ÙˆÙ„Ø©</p>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-red-600" id="suggestions-high-priority">0</div>
                        <p class="text-sm text-gray-600">Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ©</p>
                    </div>
                </div>
            </div>
            
            <div id="suggestions-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Suggestions will be displayed here -->
            </div>
        </section>

        <!-- Library Section -->
        <section id="library-section" class="section">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-bold text-white">Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ© ÙˆÙ…ÙƒØªØ¨Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</h2>
                <div class="flex gap-3">
                    <button onclick="showVideoUploadModal()" class="bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700">
                        <i class="fas fa-video ml-2"></i>Ø±ÙØ¹ ÙÙŠØ¯ÙŠÙˆ
                    </button>
                    <button onclick="showLibraryModal()" class="btn-primary text-white px-6 py-3 rounded-lg">
                        <i class="fas fa-plus ml-2"></i>Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰
                    </button>
                </div>
            </div>

            <!-- Library Tabs -->
            <div class="card p-6 mb-8">
                <div class="flex border-b border-gray-200 mb-6">
                    <button id="tab-all" onclick="switchLibraryTab('all')" class="library-tab px-6 py-3 font-semibold text-blue-600 border-b-2 border-blue-600">
                        <i class="fas fa-th-large ml-2"></i>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª
                    </button>
                    <button id="tab-videos" onclick="switchLibraryTab('videos')" class="library-tab px-6 py-3 font-semibold text-gray-600 hover:text-blue-600">
                        <i class="fas fa-video ml-2"></i>Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                    </button>
                    <button id="tab-photos" onclick="switchLibraryTab('photos')" class="library-tab px-6 py-3 font-semibold text-gray-600 hover:text-blue-600">
                        <i class="fas fa-image ml-2"></i>Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ø°ÙƒØ±ÙŠØ§Øª
                    </button>
                    <button id="tab-documents" onclick="switchLibraryTab('documents')" class="library-tab px-6 py-3 font-semibold text-gray-600 hover:text-blue-600">
                        <i class="fas fa-file-alt ml-2"></i>Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚
                    </button>
                </div>
                
                <!-- Video Library Stats -->
                <div id="video-stats" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                    <div class="text-center p-4 bg-red-50 rounded-lg">
                        <i class="fas fa-video text-red-600 text-2xl mb-2"></i>
                        <div class="text-2xl font-bold text-red-600" id="total-videos">0</div>
                        <p class="text-sm text-gray-600">Ù…Ù‚Ø§Ø·Ø¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</p>
                    </div>
                    <div class="text-center p-4 bg-blue-50 rounded-lg">
                        <i class="fas fa-play text-blue-600 text-2xl mb-2"></i>
                        <div class="text-2xl font-bold text-blue-600" id="total-views">0</div>
                        <p class="text-sm text-gray-600">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª</p>
                    </div>
                    <div class="text-center p-4 bg-green-50 rounded-lg">
                        <i class="fas fa-calendar text-green-600 text-2xl mb-2"></i>
                        <div class="text-2xl font-bold text-green-600" id="recent-uploads">0</div>
                        <p class="text-sm text-gray-600">Ø±ÙÙØ¹ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</p>
                    </div>
                    <div class="text-center p-4 bg-yellow-50 rounded-lg">
                        <i class="fas fa-star text-yellow-600 text-2xl mb-2"></i>
                        <div class="text-2xl font-bold text-yellow-600" id="featured-videos">0</div>
                        <p class="text-sm text-gray-600">ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù…Ù…ÙŠØ²Ø©</p>
                    </div>
                </div>
            </div>

            <!-- Search and Filter Bar -->
            <div class="card p-6 mb-8">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <!-- Search -->
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…ÙƒØªØ¨Ø©</label>
                        <div class="relative">
                            <input type="text" id="librarySearch" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†ØŒ Ø§Ù„ÙˆØµÙØŒ Ø§Ù„Ù…Ø¤Ù„ÙØŒ Ø£Ùˆ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©..." 
                                   class="w-full p-3 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                   oninput="searchLibrary(this.value)">
                            <i class="fas fa-search absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        </div>
                    </div>

                    <!-- Category Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©</label>
                        <select id="libraryCategoryFilter" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                onchange="filterLibraryByCategory(this.value)">
                            <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</option>
                            <option value="family_history">ğŸ›ï¸ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</option>
                            <option value="genealogy">ğŸŒ³ Ø§Ù„Ø£Ù†Ø³Ø§Ø¨</option>
                            <option value="documents">ğŸ“‹ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø±Ø³Ù…ÙŠØ©</option>
                            <option value="photos">ğŸ“¸ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ø°ÙƒØ±ÙŠØ§Øª</option>
                            <option value="achievements">ğŸ† Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</option>
                            <option value="stories">ğŸ“– Ø§Ù„Ù‚ØµØµ ÙˆØ§Ù„Ø­ÙƒØ§ÙŠØ§Øª</option>
                            <option value="education">ğŸ“ Ø§Ù„ØªØ¹Ù„ÙŠÙ… ÙˆØ§Ù„Ù…Ù‡Ø§Ø±Ø§Øª</option>
                            <option value="business">ğŸ’¼ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ ÙˆØ§Ù„ØªØ¬Ø§Ø±Ø©</option>
                        </select>
                    </div>
                </div>

                <!-- Quick Stats -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 pt-4 border-t border-gray-200">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-blue-600" id="library-total-items">0</div>
                        <p class="text-sm text-gray-600">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª</p>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-600" id="library-featured-items">0</div>
                        <p class="text-sm text-gray-600">Ù…Ø­ØªÙˆÙ‰ Ù…Ù…ÙŠØ²</p>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-purple-600" id="library-total-views">0</div>
                        <p class="text-sm text-gray-600">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª</p>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-orange-600" id="library-total-downloads">0</div>
                        <p class="text-sm text-gray-600">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„Ø§Øª</p>
                    </div>
                </div>
            </div>
            
            <div id="library-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Library items will be displayed here -->
            </div>
        </section>

        <!-- Profile Section -->
        <section id="profile-section" class="section">
            <div class="max-w-4xl mx-auto">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
                    <h2 class="text-3xl font-bold text-white flex items-center">
                        <i class="fas fa-user-circle ml-3"></i>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
                    </h2>
                    <div class="flex gap-3">
                        <button onclick="editProfile()" class="btn-primary text-white px-6 py-3 rounded-lg hover:shadow-lg transition">
                            <i class="fas fa-edit ml-2"></i>ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                        </button>
                        <button onclick="changePassword()" class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-3 rounded-lg transition">
                            <i class="fas fa-key ml-2"></i>ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
                        </button>
                    </div>
                </div>
                
                <!-- Profile Display Card -->
                <div id="profileDisplayCard" class="bg-white rounded-lg shadow-lg p-8 mb-6">
                    <div class="flex flex-col md:flex-row gap-8">
                        <!-- Profile Picture Section -->
                        <div class="flex-shrink-0">
                            <div class="relative">
                                <img id="profilePicture" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 24 24' fill='%23e5e7eb'%3E%3Cpath d='M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z'/%3E%3C/svg%3E" 
                                     alt="Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©" class="w-32 h-32 rounded-full border-4 border-blue-100 shadow-lg object-cover">
                                <button onclick="changeProfilePicture()" class="absolute bottom-2 right-2 bg-blue-600 text-white p-2 rounded-full hover:bg-blue-700 transition shadow-lg">
                                    <i class="fas fa-camera text-sm"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Profile Info Section -->
                        <div class="flex-1">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="space-y-4">
                                    <div>
                                        <label class="text-sm font-medium text-gray-500">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                                        <div id="displayFullName" class="text-xl font-bold text-gray-800">ØºÙŠØ± Ù…Ø­Ø¯Ø¯</div>
                                    </div>
                                    <div>
                                        <label class="text-sm font-medium text-gray-500">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                                        <div id="displayEmail" class="text-lg text-gray-700">ØºÙŠØ± Ù…Ø­Ø¯Ø¯</div>
                                    </div>
                                    <div>
                                        <label class="text-sm font-medium text-gray-500">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                                        <div id="displayPhone" class="text-lg text-gray-700">ØºÙŠØ± Ù…Ø­Ø¯Ø¯</div>
                                    </div>
                                </div>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label class="text-sm font-medium text-gray-500">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
                                        <div id="displayBirthDate" class="text-lg text-gray-700">ØºÙŠØ± Ù…Ø­Ø¯Ø¯</div>
                                    </div>
                                    <div>
                                        <label class="text-sm font-medium text-gray-500">Ù…ÙƒØ§Ù† Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
                                        <div id="displayBirthPlace" class="text-lg text-gray-700">ØºÙŠØ± Ù…Ø­Ø¯Ø¯</div>
                                    </div>
                                    <div>
                                        <label class="text-sm font-medium text-gray-500">Ø§Ù„Ù…Ù‡Ù†Ø©</label>
                                        <div id="displayOccupation" class="text-lg text-gray-700">ØºÙŠØ± Ù…Ø­Ø¯Ø¯</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Bio Section -->
                            <div class="mt-6 pt-6 border-t border-gray-200">
                                <label class="text-sm font-medium text-gray-500">Ù†Ø¨Ø°Ø© Ø´Ø®ØµÙŠØ©</label>
                                <div id="displayBio" class="text-gray-700 mt-2 leading-relaxed">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ø¨Ø°Ø© Ø´Ø®ØµÙŠØ© Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯.</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Statistics Card -->
                <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø´Ø§Ø·</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div class="text-center p-4 bg-blue-50 rounded-lg">
                            <div class="text-2xl font-bold text-blue-600" id="userPostsCount">0</div>
                            <div class="text-sm text-gray-600">Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª</div>
                        </div>
                        <div class="text-center p-4 bg-green-50 rounded-lg">
                            <div class="text-2xl font-bold text-green-600" id="userEventsCount">0</div>
                            <div class="text-sm text-gray-600">Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</div>
                        </div>
                        <div class="text-center p-4 bg-purple-50 rounded-lg">
                            <div class="text-2xl font-bold text-purple-600" id="userSuggestionsCount">0</div>
                            <div class="text-sm text-gray-600">Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª</div>
                        </div>
                        <div class="text-center p-4 bg-orange-50 rounded-lg">
                            <div class="text-2xl font-bold text-orange-600" id="userJoinDate">0</div>
                            <div class="text-sm text-gray-600">Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©</div>
                        </div>
                    </div>
                </div>
                
                <!-- Recent Activity -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø£Ø®ÙŠØ±</h3>
                    <div id="userRecentActivity" class="space-y-3">
                        <div class="text-gray-500 text-center py-8">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø´Ø§Ø· Ø­Ø¯ÙŠØ« Ù„Ø¹Ø±Ø¶Ù‡.</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Admin Section -->
        <section id="admin-section" class="section">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-bold text-white">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
                <div class="flex gap-4">
                    <button onclick="refreshPendingUsers()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                        <i class="fas fa-refresh ml-2"></i>ØªØ­Ø¯ÙŠØ«
                    </button>
                </div>
            </div>
            
            <!-- Pending Users Tab -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</h3>
                <div id="pendingUsersGrid" class="space-y-4">
                    <!-- Pending users will be displayed here -->
                </div>
            </div>
            
            <!-- System Statistics -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h4 class="text-lg font-bold text-gray-800 mb-2">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù…ÙØ¹Ù„ÙˆÙ†</h4>
                    <div class="text-3xl font-bold text-green-600" id="activeUsersCount">0</div>
                </div>
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h4 class="text-lg font-bold text-gray-800 mb-2">Ø·Ù„Ø¨Ø§Øª Ù…Ø¹Ù„Ù‚Ø©</h4>
                    <div class="text-3xl font-bold text-orange-600" id="pendingUsersCount">0</div>
                </div>
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h4 class="text-lg font-bold text-gray-800 mb-2">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h4>
                    <div class="text-3xl font-bold text-blue-600" id="totalUsersCount">0</div>
                </div>
            </div>
        </section>
    </div>

    <!-- Family Member Modal -->
    <div id="familyModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden modal">
        <div class="bg-white p-6 rounded-lg max-w-4xl w-full mx-4 max-h-screen overflow-y-auto" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800" id="familyModalTitle">Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©</h3>
                <button type="button" onclick="hideFamilyModal()" class="text-gray-400 hover:text-gray-600 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="familyForm">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ø³Ù… -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-blue-800 mb-4 flex items-center">
                        <i class="fas fa-user ml-2"></i>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø³Ù…
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ *</label>
                            <input type="text" id="familyFirstName" placeholder="Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆØ³Ø·</label>
                            <input type="text" id="familyMiddleName" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø­Ù…Ø¯" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© *</label>
                            <input type="text" id="familyLastName" placeholder="Ù…Ø«Ø§Ù„: Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                    </div>
                    <div class="mt-3 p-2 bg-white rounded border">
                        <label class="block text-xs font-medium text-gray-500 mb-1">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ (Ù…Ø¹Ø§ÙŠÙ†Ø©)</label>
                        <div id="fullNamePreview" class="text-lg font-semibold text-gray-800">Ø³ÙŠØªÙ… ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø§Ø³Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹...</div>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-green-800 mb-4 flex items-center">
                        <i class="fas fa-birthday-cake ml-2"></i>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
                            <input type="date" id="familyBirthDate" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ù…ÙƒØ§Ù† Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
                            <input type="text" id="familyBirthPlace" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø¬ÙŠØ§Ù„ -->
                <div class="bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-amber-800 mb-4 flex items-center">
                        <i class="fas fa-sitemap ml-2"></i>Ø±Ø¨Ø· Ø§Ù„Ø£Ø¬ÙŠØ§Ù„
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ÙˆØ§Ù„Ø¯/Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø³Ø§Ø¨Ù‚</label>
                            <select id="familyFatherId" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">-- Ø§Ø®ØªØ± Ø§Ù„ÙˆØ§Ù„Ø¯ --</option>
                            </select>
                            <p class="text-sm text-gray-500 mt-1">Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠ</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ</label>
                            <input type="text" id="familyCurrentGeneration" placeholder="Ø³ÙŠØªÙ… Ø­Ø³Ø§Ø¨Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹" class="w-full p-3 bg-gray-100 border border-gray-300 rounded-lg" readonly>
                            <p class="text-sm text-green-600 mt-1">ÙŠÙØ­Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ§Ù„Ø¯ Ø§Ù„Ù…Ø®ØªØ§Ø±</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø²ÙˆØ¬/Ø§Ù„Ø²ÙˆØ¬Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                            <select id="familySpouseId" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø²ÙˆØ¬/Ø§Ù„Ø²ÙˆØ¬Ø© --</option>
                            </select>
                            <p class="text-sm text-gray-500 mt-1">Ø§Ø®ØªØ± Ù…Ù† Ù†ÙØ³ Ø§Ù„Ø¬ÙŠÙ„ Ø£Ùˆ Ø¬ÙŠÙ„ Ù…Ù‚Ø§Ø±Ø¨ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„Ø²ÙˆØ§Ø¬</p>
                        </div>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø´Ø®ØµÙŠØ© -->
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-purple-800 mb-4 flex items-center">
                        <i class="fas fa-id-card ml-2"></i>Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¬Ù†Ø³ *</label>
                            <select id="familyGender" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³ --</option>
                                <option value="male">Ø°ÙƒØ±</option>
                                <option value="female">Ø£Ù†Ø«Ù‰</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© *</label>
                            <select id="familyMembershipType" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                <option value="">-- Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© --</option>
                                <option value="founder">ğŸ‘‘ Ù…Ø¤Ø³Ø³</option>
                                <option value="chairman">ğŸ–ï¸ Ø±Ø¦ÙŠØ³ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</option>
                                <option value="board_member">ğŸ‘” Ø¹Ø¶Ùˆ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</option>
                                <option value="general_assembly">ğŸ‘¥ Ø¹Ø¶Ùˆ Ø§Ù„Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©</option>
                                <option value="family_member">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Ø¹Ø¶Ùˆ Ø¹Ø§Ø¦Ù„Ø©</option>
                                <option value="honorary">ğŸ… Ø¹Ø¶Ùˆ Ø´Ø±ÙÙŠ</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ù‡Ù†ÙŠØ© -->
                <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-indigo-800 mb-4 flex items-center">
                        <i class="fas fa-briefcase ml-2"></i>Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù‡Ù†ÙŠØ©
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…Ù‡Ù†Ø©</label>
                            <input type="text" id="familyProfession" placeholder="Ù…Ø«Ø§Ù„: Ù…Ù‡Ù†Ø¯Ø³ØŒ Ø·Ø¨ÙŠØ¨ØŒ Ù…Ø¹Ù„Ù…" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ø¹Ù…Ù„ÙŠ</label>
                            <input type="text" id="familySpecialization" placeholder="Ù…Ø«Ø§Ù„: Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ØŒ Ø·Ø¨ Ø§Ù„Ø£Ø·ÙØ§Ù„" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ -->
                <div class="bg-teal-50 border border-teal-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-teal-800 mb-4 flex items-center">
                        <i class="fas fa-phone ml-2"></i>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</label>
                            <input type="tel" id="familyPhone" placeholder="05xxxxxxxx" pattern="[0-9]{10}" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <p class="text-xs text-gray-500 mt-1">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ Ø¨ØµÙŠØºØ© 05xxxxxxxx</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                            <input type="email" id="familyEmail" placeholder="example@email.com" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© -->
                <div class="bg-rose-50 border border-rose-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-rose-800 mb-4 flex items-center">
                        <i class="fas fa-heart ml-2"></i>Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
                    </h4>
                    <div class="grid grid-cols-1 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù‡ÙˆØ§ÙŠØ§Øª ÙˆØ§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª</label>
                            <textarea id="familyHobbies" rows="3" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶Ø©ØŒ Ø§Ù„Ø³ÙØ±ØŒ Ø§Ù„ØªØµÙˆÙŠØ±ØŒ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©..." class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-vertical"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                <div class="flex justify-end space-x-4 rtl:space-x-reverse pt-4 border-t border-gray-200">
                    <button type="button" onclick="hideFamilyModal()" class="px-8 py-3 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300 transition font-medium">
                        <i class="fas fa-times ml-2"></i>Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="button" onclick="resetFamilyForm()" class="px-8 py-3 text-amber-600 bg-amber-100 border border-amber-300 rounded-lg hover:bg-amber-200 transition font-medium">
                        <i class="fas fa-refresh ml-2"></i>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                    </button>
                    <button type="submit" class="px-8 py-3 bg-gradient-to-r from-blue-600 to-green-600 text-white rounded-lg hover:from-blue-700 hover:to-green-700 transition font-medium shadow-lg">
                        <i class="fas fa-save ml-2"></i>Ø­ÙØ¸ Ø§Ù„Ø¹Ø¶Ùˆ
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden modal">
        <div class="bg-white p-8 rounded-lg max-w-md w-full mx-4" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
                <button type="button" onclick="hideLoginModal()" class="text-gray-400 hover:text-gray-600 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="loginForm">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *</label>
                    <input type="text" id="loginIdentifier" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± *</label>
                    <input type="password" id="loginPassword" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                
                <div class="flex justify-between items-center mb-6">
                    <label class="flex items-center">
                        <input type="checkbox" id="rememberMe" class="mr-2">
                        <span class="text-sm text-gray-600">ØªØ°ÙƒØ±Ù†ÙŠ</span>
                    </label>
                    <button type="button" class="text-sm text-blue-600 hover:text-blue-800">Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ</button>
                </div>
                
                <div class="flex justify-end space-x-4 rtl:space-x-reverse">
                    <button type="button" onclick="hideLoginModal()" class="px-6 py-2 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300 transition">
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
                        Ø¯Ø®ÙˆÙ„
                    </button>
                </div>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-gray-600">Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ 
                    <button onclick="hideLoginModal(); showRegisterModal()" class="text-blue-600 hover:text-blue-800 font-medium">Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†</button>
                </p>
            </div>
            
            <!-- ØªØ´Ø®ÙŠØµ Ø§Ù„Ù…Ø¯ÙŠØ± -->
            <div class="mt-4 p-4 bg-gray-50 rounded-lg">
                <p class="text-sm font-medium text-gray-700 mb-2">Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ:</p>
                <div class="text-xs text-gray-600 space-y-1">
                    <div>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: <code class="bg-gray-200 px-1 rounded">admin@salmansaedan.com</code></div>
                    <div>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: <code class="bg-gray-200 px-1 rounded">admin123</code></div>
                    <button onclick="resetDefaultAdmin()" class="mt-2 px-3 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700">
                        Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø¯ÙŠØ±
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden modal">
        <div class="bg-white p-6 rounded-lg max-w-4xl w-full mx-4 max-h-screen overflow-y-auto" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800">ØªØ³Ø¬ÙŠÙ„ Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯</h3>
                <button type="button" onclick="hideRegisterModal()" class="text-gray-400 hover:text-gray-600 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                <div class="flex items-center">
                    <i class="fas fa-info-circle text-blue-600 ml-2"></i>
                    <div class="text-blue-800">
                        <p class="font-medium">Ù…Ù„Ø§Ø­Ø¸Ø© Ù‡Ø§Ù…Ø©:</p>
                        <p class="text-sm mt-1">Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©. Ø³ØªØªÙ„Ù‚Ù‰ Ø¥Ø´Ø¹Ø§Ø±Ø§Ù‹ Ø¹Ù†Ø¯ ØªÙØ¹ÙŠÙ„ Ø­Ø³Ø§Ø¨Ùƒ.</p>
                    </div>
                </div>
            </div>
            
            <form id="registerForm">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ø³Ù… -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-blue-800 mb-4 flex items-center">
                        <i class="fas fa-user ml-2"></i>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø³Ù…
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ *</label>
                            <input type="text" id="registerFirstName" placeholder="Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆØ³Ø· *</label>
                            <input type="text" id="registerMiddleName" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø­Ù…Ø¯" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© *</label>
                            <input type="text" id="registerLastName" placeholder="Ù…Ø«Ø§Ù„: Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                    </div>
                    <div class="mt-3 p-2 bg-white rounded border">
                        <label class="block text-xs font-medium text-gray-500 mb-1">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ (Ù…Ø¹Ø§ÙŠÙ†Ø©)</label>
                        <div id="registerFullNamePreview" class="text-lg font-semibold text-gray-800">Ø³ÙŠØªÙ… ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø§Ø³Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹...</div>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ ÙˆØ§Ù„Ù‡ÙˆÙŠØ© -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-green-800 mb-4 flex items-center">
                        <i class="fas fa-id-card ml-2"></i>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© *</label>
                            <input type="text" id="registerNationalId" placeholder="1xxxxxxxxx" pattern="[1-2][0-9]{9}" maxlength="10" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                            <p class="text-xs text-gray-500 mt-1">Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© (10 Ø£Ø±Ù‚Ø§Ù…)</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ *</label>
                            <input type="date" id="registerBirthDate" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ù…ÙƒØ§Ù† Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ *</label>
                            <input type="text" id="registerBirthPlace" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø¬ÙŠØ§Ù„ -->
                <div class="bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-amber-800 mb-4 flex items-center">
                        <i class="fas fa-sitemap ml-2"></i>Ø±Ø¨Ø· Ø§Ù„Ø£Ø¬ÙŠØ§Ù„
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ÙˆØ§Ù„Ø¯/Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø³Ø§Ø¨Ù‚</label>
                            <select id="registerFatherId" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">-- Ø§Ø®ØªØ± Ø§Ù„ÙˆØ§Ù„Ø¯ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) --</option>
                            </select>
                            <p class="text-sm text-gray-500 mt-1">Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØ§Ø­Ø§Ù‹</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</label>
                            <input type="text" id="registerExpectedGeneration" placeholder="Ø³ÙŠØªÙ… Ø­Ø³Ø§Ø¨Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹" class="w-full p-3 bg-gray-100 border border-gray-300 rounded-lg" readonly>
                            <p class="text-sm text-green-600 mt-1">ÙŠÙØ­Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ§Ù„Ø¯ Ø§Ù„Ù…Ø®ØªØ§Ø±</p>
                        </div>
                    </div>
                </div>

                <!-- Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù‡Ù†ÙŠØ© ÙˆØ§Ù„Ø¹Ù„Ù…ÙŠØ© -->
                <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-indigo-800 mb-4 flex items-center">
                        <i class="fas fa-graduation-cap ml-2"></i>Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù‡Ù†ÙŠØ© ÙˆØ§Ù„Ø¹Ù„Ù…ÙŠØ©
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…Ù‡Ù†Ø© *</label>
                            <input type="text" id="registerProfession" placeholder="Ù…Ø«Ø§Ù„: Ù…Ù‡Ù†Ø¯Ø³ØŒ Ø·Ø¨ÙŠØ¨ØŒ Ù…Ø¹Ù„Ù…" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ø¹Ù„Ù…ÙŠ *</label>
                            <input type="text" id="registerSpecialization" placeholder="Ù…Ø«Ø§Ù„: Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ØŒ Ø·Ø¨ Ø§Ù„Ø£Ø·ÙØ§Ù„" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ -->
                <div class="bg-teal-50 border border-teal-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-teal-800 mb-4 flex items-center">
                        <i class="fas fa-phone ml-2"></i>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ *</label>
                            <input type="tel" id="registerPhone" placeholder="05xxxxxxxx" pattern="[0-9]{10}" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                            <p class="text-xs text-gray-500 mt-1">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ Ø¨ØµÙŠØºØ© 05xxxxxxxx</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *</label>
                            <input type="email" id="registerEmail" placeholder="example@email.com" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                    </div>
                </div>

                <!-- Ø§Ù„Ù‡ÙˆØ§ÙŠØ§Øª ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± -->
                <div class="bg-rose-50 border border-rose-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-rose-800 mb-4 flex items-center">
                        <i class="fas fa-key ml-2"></i>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© ÙˆØ£Ù…Ù†ÙŠØ©
                    </h4>
                    <div class="grid grid-cols-1 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù‡ÙˆØ§ÙŠØ§Øª ÙˆØ§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª *</label>
                            <textarea id="registerHobbies" rows="3" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶Ø©ØŒ Ø§Ù„Ø³ÙØ±ØŒ Ø§Ù„ØªØµÙˆÙŠØ±ØŒ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©..." class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-vertical" required></textarea>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± *</label>
                                <input type="password" id="registerPassword" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ©" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                <p class="text-xs text-gray-500 mt-1">8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± *</label>
                                <input type="password" id="registerPasswordConfirm" placeholder="Ø£Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© ÙˆØ§Ù„Ø´Ø±ÙˆØ· -->
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6">
                    <label class="flex items-start">
                        <input type="checkbox" id="registerAgree" class="mt-1 mr-2" required>
                        <div class="text-sm text-gray-700">
                            <p class="font-medium">Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…:</p>
                            <ul class="mt-2 space-y-1 text-xs text-gray-600">
                                <li>â€¢ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø© ØµØ­ÙŠØ­Ø© ÙˆÙ…Ø³Ø¤ÙˆÙ„ Ø¹Ù†Ù‡Ø§</li>
                                <li>â€¢ Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† Ù‚Ø¨Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</li>
                                <li>â€¢ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø¢Ø¯Ø§Ø¨ ÙˆÙ‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</li>
                                <li>â€¢ Ø¹Ø¯Ù… Ø¥Ø³Ø§Ø¡Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ù†ØµØ© Ø£Ùˆ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</li>
                            </ul>
                        </div>
                    </label>
                </div>

                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                <div class="flex justify-end space-x-4 rtl:space-x-reverse pt-4 border-t border-gray-200">
                    <button type="button" onclick="hideRegisterModal()" class="px-8 py-3 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300 transition font-medium">
                        <i class="fas fa-times ml-2"></i>Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="button" onclick="resetRegisterForm()" class="px-8 py-3 text-amber-600 bg-amber-100 border border-amber-300 rounded-lg hover:bg-amber-200 transition font-medium">
                        <i class="fas fa-refresh ml-2"></i>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                    </button>
                    <button type="submit" class="px-8 py-3 bg-gradient-to-r from-green-600 to-blue-600 text-white rounded-lg hover:from-green-700 hover:to-blue-700 transition font-medium shadow-lg">
                        <i class="fas fa-user-plus ml-2"></i>Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                    </button>
                </div>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-gray-600">Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ 
                    <button onclick="hideRegisterModal(); showLoginModal()" class="text-blue-600 hover:text-blue-800 font-medium">Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„</button>
                </p>
            </div>
        </div>
    </div>

    <!-- Suggestion Modal -->
    <div id="suggestionModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-2xl w-full max-w-2xl max-h-screen overflow-y-auto mx-4 shadow-2xl">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-lightbulb text-yellow-500 ml-2"></i>
                    Ø¥Ø¶Ø§ÙØ© Ø§Ù‚ØªØ±Ø§Ø­ Ø¬Ø¯ÙŠØ¯
                </h2>
                <button onclick="hideSuggestionModal()" class="text-gray-500 hover:text-gray-700 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="suggestionForm" onsubmit="handleSuggestionSubmit(event)">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-blue-800 mb-4 flex items-center">
                        <i class="fas fa-info-circle ml-2"></i>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­
                    </h4>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­ *</label>
                            <input type="text" id="suggestionTitle" placeholder="Ù…Ø«Ø§Ù„: ØªØ·ÙˆÙŠØ± ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¬ÙˆØ§Ù„" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ÙØ¦Ø© Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­ *</label>
                            <select id="suggestionCategory" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                <option value="">-- Ø§Ø®ØªØ± Ø§Ù„ÙØ¦Ø© --</option>
                                <option value="technology">ğŸ”§ ØªÙ‚Ù†ÙŠ</option>
                                <option value="events">ğŸ‰ ÙØ¹Ø§Ù„ÙŠØ§Øª</option>
                                <option value="services">ğŸ›ï¸ Ø®Ø¯Ù…Ø§Øª</option>
                                <option value="education">ğŸ“š ØªØ¹Ù„ÙŠÙ…ÙŠ</option>
                                <option value="social">ğŸ‘¥ Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ</option>
                                <option value="business">ğŸ’¼ ØªØ¬Ø§Ø±ÙŠ</option>
                                <option value="other">ğŸ“ Ø£Ø®Ø±Ù‰</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</label>
                            <select id="suggestionPriority" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="low">ğŸŸ¢ Ù…Ù†Ø®ÙØ¶Ø©</option>
                                <option value="medium" selected>ğŸŸ¡ Ù…ØªÙˆØ³Ø·Ø©</option>
                                <option value="high">ğŸ”´ Ø¹Ø§Ù„ÙŠØ©</option>
                                <option value="urgent">ğŸš¨ Ø¹Ø§Ø¬Ù„</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-green-800 mb-4 flex items-center">
                        <i class="fas fa-edit ml-2"></i>Ø§Ù„ÙˆØµÙ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ
                    </h4>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ø´Ø±Ø­ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­ *</label>
                        <textarea id="suggestionDescription" rows="4" placeholder="Ø§Ø´Ø±Ø­ Ø§Ù‚ØªØ±Ø§Ø­Ùƒ Ø¨Ø§Ù„ØªÙØµÙŠÙ„..." class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required></textarea>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©</label>
                        <textarea id="suggestionBenefits" rows="3" placeholder="Ù…Ø§ Ù‡ÙŠ Ø§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­ØŸ" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                    </div>
                </div>

                <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ†ÙÙŠØ° -->
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-purple-800 mb-4 flex items-center">
                        <i class="fas fa-cogs ml-2"></i>ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ†ÙÙŠØ°
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©</label>
                            <input type="text" id="suggestionBudget" placeholder="Ù…Ø«Ø§Ù„: 50,000 Ø±ÙŠØ§Ù„" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©</label>
                            <input type="text" id="suggestionTimeline" placeholder="Ù…Ø«Ø§Ù„: 3 Ø£Ø´Ù‡Ø±" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
                        <textarea id="suggestionResources" rows="2" placeholder="Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ ÙˆØ§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©ØŸ" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                    </div>
                </div>

                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                <div class="flex justify-end space-x-4 rtl:space-x-reverse pt-4 border-t border-gray-200">
                    <button type="button" onclick="hideSuggestionModal()" class="px-8 py-3 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300 transition font-medium">
                        <i class="fas fa-times ml-2"></i>Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="button" onclick="resetSuggestionForm()" class="px-8 py-3 text-amber-600 bg-amber-100 border border-amber-300 rounded-lg hover:bg-amber-200 transition font-medium">
                        <i class="fas fa-refresh ml-2"></i>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                    </button>
                    <button type="submit" class="px-8 py-3 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-lg hover:from-yellow-600 hover:to-orange-600 transition font-medium shadow-lg">
                        <i class="fas fa-lightbulb ml-2"></i>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Event Modal -->
    <div id="eventModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-2xl w-full max-w-2xl max-h-screen overflow-y-auto mx-4 shadow-2xl">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-calendar-alt text-blue-500 ml-2"></i>
                    Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø¬Ø¯ÙŠØ¯
                </h2>
                <button onclick="hideEventModal()" class="text-gray-500 hover:text-gray-700 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="eventForm" onsubmit="handleEventSubmit(event)">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø¯Ø« Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-blue-800 mb-4 flex items-center">
                        <i class="fas fa-info-circle ml-2"></i>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø¯Ø«
                    </h4>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø­Ø¯Ø« *</label>
                            <input type="text" id="eventTitle" placeholder="Ù…Ø«Ø§Ù„: Ø²ÙˆØ§Ø¬ Ø£Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø­Ø¯Ø« *</label>
                                <select id="eventType" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                    <option value="">-- Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø­Ø¯Ø« --</option>
                                    <option value="wedding">ğŸ’’ Ø²ÙˆØ§Ø¬</option>
                                    <option value="birth">ğŸ‘¶ Ù…ÙˆÙ„ÙˆØ¯ Ø¬Ø¯ÙŠØ¯</option>
                                    <option value="graduation">ğŸ“ ØªØ®Ø±Ø¬</option>
                                    <option value="gathering">ğŸ‘¥ Ø§Ø¬ØªÙ…Ø§Ø¹ Ø¹Ø§Ø¦Ù„ÙŠ</option>
                                    <option value="achievement">ğŸ† Ø¥Ù†Ø¬Ø§Ø²</option>
                                    <option value="memorial">ğŸ•¯ï¸ Ø°ÙƒØ±Ù‰</option>
                                    <option value="other">ğŸ“… Ø£Ø®Ø±Ù‰</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¯Ø« *</label>
                                <input type="datetime-local" id="eventDate" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÙˆØµÙ ÙˆØªÙØ§ØµÙŠÙ„ -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-green-800 mb-4 flex items-center">
                        <i class="fas fa-edit ml-2"></i>Ø§Ù„ÙˆØµÙ ÙˆØ§Ù„ØªÙØ§ØµÙŠÙ„
                    </h4>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ÙˆØµÙ Ø§Ù„Ø­Ø¯Ø«</label>
                            <textarea id="eventDescription" rows="3" placeholder="Ø§ÙƒØªØ¨ ÙˆØµÙØ§Ù‹ ØªÙØµÙŠÙ„ÙŠØ§Ù‹ Ù„Ù„Ø­Ø¯Ø«..." class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…ÙƒØ§Ù†</label>
                                <input type="text" id="eventLocation" placeholder="Ù…Ø«Ø§Ù„: Ù‚Ø§Ø¹Ø© Ø§Ù„Ø£ÙØ±Ø§Ø­ - Ø§Ù„Ø±ÙŠØ§Ø¶" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…Ù†Ø¸Ù…</label>
                                <input type="text" id="eventOrganizer" placeholder="Ø§Ø³Ù… Ù…Ù†Ø¸Ù… Ø§Ù„Ø­Ø¯Ø«" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø­Ø¶ÙˆØ±</label>
                            <input type="number" id="eventMaxAttendees" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" min="1">
                        </div>
                    </div>
                </div>

                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                <div class="flex justify-end space-x-4 rtl:space-x-reverse pt-4 border-t border-gray-200">
                    <button type="button" onclick="hideEventModal()" class="px-8 py-3 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300 transition font-medium">
                        <i class="fas fa-times ml-2"></i>Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="button" onclick="resetEventForm()" class="px-8 py-3 text-amber-600 bg-amber-100 border border-amber-300 rounded-lg hover:bg-amber-200 transition font-medium">
                        <i class="fas fa-refresh ml-2"></i>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                    </button>
                    <button type="submit" class="px-8 py-3 bg-gradient-to-r from-blue-500 to-green-500 text-white rounded-lg hover:from-blue-600 hover:to-green-600 transition font-medium shadow-lg">
                        <i class="fas fa-calendar-plus ml-2"></i>Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø¯Ø«
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Library Modal -->
    <div id="libraryModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-2xl w-full max-w-2xl max-h-screen overflow-y-auto mx-4 shadow-2xl">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-book text-blue-500 ml-2"></i>
                    Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰ Ù„Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©
                </h2>
                <button onclick="hideLibraryModal()" class="text-gray-500 hover:text-gray-700 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="libraryForm" onsubmit="handleLibrarySubmit(event)">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-blue-800 mb-4 flex items-center">
                        <i class="fas fa-info-circle ml-2"></i>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø­ØªÙˆÙ‰
                    </h4>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ØªÙˆÙ‰ *</label>
                            <input type="text" id="libraryTitle" placeholder="Ù…Ø«Ø§Ù„: ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ *</label>
                                <select id="libraryType" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                    <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹ --</option>
                                    <option value="document">ğŸ“„ ÙˆØ«ÙŠÙ‚Ø©</option>
                                    <option value="book">ğŸ“š ÙƒØªØ§Ø¨</option>
                                    <option value="article">ğŸ“ Ù…Ù‚Ø§Ù„</option>
                                    <option value="video">ğŸ¥ ÙÙŠØ¯ÙŠÙˆ</option>
                                    <option value="audio">ğŸµ ØµÙˆØªÙŠ</option>
                                    <option value="image">ğŸ–¼ï¸ ØµÙˆØ±Ø©</option>
                                    <option value="presentation">ğŸ“Š Ø¹Ø±Ø¶ ØªÙ‚Ø¯ÙŠÙ…ÙŠ</option>
                                    <option value="research">ğŸ”¬ Ø¨Ø­Ø«</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ÙØ¦Ø© *</label>
                                <select id="libraryCategory" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                    <option value="">-- Ø§Ø®ØªØ± Ø§Ù„ÙØ¦Ø© --</option>
                                    <option value="family_history">ğŸ›ï¸ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</option>
                                    <option value="genealogy">ğŸŒ³ Ø§Ù„Ø£Ù†Ø³Ø§Ø¨</option>
                                    <option value="documents">ğŸ“‹ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø±Ø³Ù…ÙŠØ©</option>
                                    <option value="photos">ğŸ“¸ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ø°ÙƒØ±ÙŠØ§Øª</option>
                                    <option value="achievements">ğŸ† Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</option>
                                    <option value="stories">ğŸ“– Ø§Ù„Ù‚ØµØµ ÙˆØ§Ù„Ø­ÙƒØ§ÙŠØ§Øª</option>
                                    <option value="education">ğŸ“ Ø§Ù„ØªØ¹Ù„ÙŠÙ… ÙˆØ§Ù„Ù…Ù‡Ø§Ø±Ø§Øª</option>
                                    <option value="business">ğŸ’¼ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ ÙˆØ§Ù„ØªØ¬Ø§Ø±Ø©</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…Ø¤Ù„Ù/Ø§Ù„Ù…Ù†Ø´Ø¦</label>
                            <input type="text" id="libraryAuthor" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¤Ù„Ù Ø£Ùˆ Ø§Ù„Ù…Ù†Ø´Ø¦" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                </div>

                <!-- Ø§Ù„ÙˆØµÙ ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-green-800 mb-4 flex items-center">
                        <i class="fas fa-edit ml-2"></i>Ø§Ù„ÙˆØµÙ ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰
                    </h4>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ÙˆØµÙ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ *</label>
                            <textarea id="libraryDescription" rows="4" placeholder="ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ Ù„Ù„Ù…Ø­ØªÙˆÙ‰..." class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©</label>
                            <input type="text" id="libraryKeywords" placeholder="ÙØµÙ„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¨ÙÙˆØ§ØµÙ„ØŒ Ù…Ø«Ø§Ù„: ØªØ§Ø±ÙŠØ®ØŒ Ø¹Ø§Ø¦Ù„Ø©ØŒ ÙˆØ«Ø§Ø¦Ù‚" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <p class="text-xs text-gray-500 mt-1">Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙÙˆØ§ØµÙ„ Ù„ÙØµÙ„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©</p>
                        </div>
                    </div>
                </div>

                <!-- ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ© -->
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-purple-800 mb-4 flex items-center">
                        <i class="fas fa-cogs ml-2"></i>ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</label>
                            <input type="date" id="libraryDate" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù„ØºØ©</label>
                            <select id="libraryLanguage" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="arabic">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                                <option value="english">Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</option>
                                <option value="other">Ø£Ø®Ø±Ù‰</option>
                            </select>
                        </div>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø­ØªÙˆÙ‰ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <input type="url" id="libraryUrl" placeholder="https://example.com/file.pdf" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <p class="text-xs text-gray-500 mt-1">Ø±Ø§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ù…Ù„Ù Ø£Ùˆ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</p>
                    </div>
                </div>

                <!-- Ø®ØµØ§Ø¦Øµ Ø§Ù„ÙˆØµÙˆÙ„ -->
                <div class="bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-amber-800 mb-4 flex items-center">
                        <i class="fas fa-lock ml-2"></i>Ø®ØµØ§Ø¦Øµ Ø§Ù„ÙˆØµÙˆÙ„
                    </h4>
                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ÙˆØµÙˆÙ„</label>
                            <select id="libraryAccess" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="public">ğŸŒ Ø¹Ø§Ù… - Ù…ØªØ§Ø­ Ù„Ù„Ø¬Ù…ÙŠØ¹</option>
                                <option value="family" selected>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Ø¹Ø§Ø¦Ù„ÙŠ - Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© ÙÙ‚Ø·</option>
                                <option value="admin">ğŸ”’ Ø¥Ø¯Ø§Ø±ÙŠ - Ø§Ù„Ù…Ø¯ÙŠØ±ÙŠÙ† ÙÙ‚Ø·</option>
                            </select>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="libraryFeatured" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                            <label for="libraryFeatured" class="mr-2 block text-sm text-gray-900">
                                Ù…Ø­ØªÙˆÙ‰ Ù…Ù…ÙŠØ² (ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©)
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                <div class="flex justify-end space-x-4 rtl:space-x-reverse pt-4 border-t border-gray-200">
                    <button type="button" onclick="hideLibraryModal()" class="px-8 py-3 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300 transition font-medium">
                        <i class="fas fa-times ml-2"></i>Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="button" onclick="resetLibraryForm()" class="px-8 py-3 text-amber-600 bg-amber-100 border border-amber-300 rounded-lg hover:bg-amber-200 transition font-medium">
                        <i class="fas fa-refresh ml-2"></i>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                    </button>
                    <button type="submit" class="px-8 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition font-medium shadow-lg">
                        <i class="fas fa-book ml-2"></i>Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙƒØªØ¨Ø©
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Video Upload Modal -->
    <div id="videoUploadModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-video text-red-600 ml-3"></i>
                    Ø±ÙØ¹ ÙÙŠØ¯ÙŠÙˆ Ø¬Ø¯ÙŠØ¯
                </h2>
                <button onclick="hideVideoUploadModal()" class="text-gray-500 hover:text-gray-700 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="videoUploadForm" onsubmit="handleVideoUpload(event)">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
                <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6 mx-6 mt-6">
                    <h4 class="text-lg font-semibold text-red-800 mb-4 flex items-center">
                        <i class="fas fa-info-circle ml-2"></i>
                        Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                    </h4>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</label>
                            <input type="text" id="videoTitle" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500" placeholder="Ù…Ø«Ø§Ù„: Ù„Ù‚Ø§Ø¡ Ø¹Ø§Ø¦Ù„ÙŠ 2024">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØµÙˆÙŠØ±</label>
                            <input type="date" id="videoDate" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500">
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">ÙˆØµÙ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</label>
                        <textarea id="videoDescription" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500" placeholder="ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„ÙÙŠØ¯ÙŠÙˆ ÙˆØ§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©..."></textarea>
                    </div>
                </div>

                <!-- Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 mx-6">
                    <h4 class="text-lg font-semibold text-blue-800 mb-4 flex items-center">
                        <i class="fas fa-upload ml-2"></i>
                        Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                    </h4>
                    
                    <div class="text-center">
                        <div class="border-2 border-dashed border-blue-300 rounded-lg p-8 mb-4">
                            <i class="fas fa-video text-blue-500 text-4xl mb-4"></i>
                            <p class="text-gray-600 mb-2">Ø§Ø³Ø­Ø¨ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±</p>
                            <p class="text-sm text-gray-500">ÙŠØ¯Ø¹Ù…: MP4, MOV, AVI (Ø­Ø¯ Ø£Ù‚ØµÙ‰: 100MB)</p>
                            <input type="file" id="videoFile" accept="video/*" class="hidden" onchange="handleVideoFileSelect(this)">
                            <button type="button" onclick="document.getElementById('videoFile').click()" class="mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                                Ø§Ø®ØªÙŠØ§Ø± ÙÙŠØ¯ÙŠÙˆ
                            </button>
                        </div>
                        <div id="videoPreview" class="hidden">
                            <video id="previewVideo" controls class="w-full max-w-md mx-auto rounded-lg">
                                <source id="videoSource" type="video/mp4">
                            </video>
                            <p id="videoFileName" class="text-sm text-gray-600 mt-2"></p>
                        </div>
                    </div>
                </div>

                <!-- ØªØµÙ†ÙŠÙ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6 mx-6">
                    <h4 class="text-lg font-semibold text-green-800 mb-4 flex items-center">
                        <i class="fas fa-tags ml-2"></i>
                        ØªØµÙ†ÙŠÙ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                    </h4>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</label>
                            <select id="videoCategory" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                                <option value="family_gathering">ØªØ¬Ù…Ø¹ Ø¹Ø§Ø¦Ù„ÙŠ</option>
                                <option value="wedding">Ø²ÙØ§Ù</option>
                                <option value="celebration">Ø§Ø­ØªÙØ§Ù„</option>
                                <option value="graduation">ØªØ®Ø±Ø¬</option>
                                <option value="birthday">Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯</option>
                                <option value="religious">Ù…Ù†Ø§Ø³Ø¨Ø© Ø¯ÙŠÙ†ÙŠØ©</option>
                                <option value="travel">Ø³ÙØ± ÙˆØ±Ø­Ù„Ø§Øª</option>
                                <option value="other">Ø£Ø®Ø±Ù‰</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®ØµÙˆØµÙŠØ©</label>
                            <select id="videoPrivacy" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                                <option value="family">Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© ÙÙ‚Ø·</option>
                                <option value="close_family">Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ù…Ù‚Ø±Ø¨Ø©</option>
                                <option value="public">Ø¹Ø§Ù… Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©</label>
                        <input type="text" id="videoTags" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Ù…Ø«Ø§Ù„: Ø¹Ø§Ø¦Ù„Ø©ØŒ Ø§Ø­ØªÙØ§Ù„ØŒ 2024 (Ø§ÙØµÙ„ Ø¨Ø§Ù„ÙÙˆØ§ØµÙ„)">
                    </div>

                    <div class="mt-4 flex items-center">
                        <input type="checkbox" id="videoFeatured" class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded">
                        <label for="videoFeatured" class="ml-2 text-sm text-gray-700">ÙÙŠØ¯ÙŠÙˆ Ù…Ù…ÙŠØ² (Ø³ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©)</label>
                    </div>
                </div>

                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                <div class="flex justify-end space-x-4 rtl:space-x-reverse pt-4 border-t border-gray-200 mx-6 mb-6">
                    <button type="button" onclick="hideVideoUploadModal()" class="px-8 py-3 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300 transition font-medium">
                        <i class="fas fa-times ml-2"></i>Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="button" onclick="resetVideoForm()" class="px-8 py-3 text-amber-600 bg-amber-100 border border-amber-300 rounded-lg hover:bg-amber-200 transition font-medium">
                        <i class="fas fa-refresh ml-2"></i>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                    </button>
                    <button type="submit" class="px-8 py-3 bg-gradient-to-r from-red-500 to-pink-600 text-white rounded-lg hover:from-red-600 hover:to-pink-700 transition font-medium shadow-lg">
                        <i class="fas fa-upload ml-2"></i>Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Event Modal -->
    <div id="eventModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-calendar-plus text-blue-600 ml-3"></i>
                    Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø¹Ø§Ø¦Ù„ÙŠ Ø¬Ø¯ÙŠØ¯
                </h2>
                <button onclick="hideEventModal()" class="text-gray-500 hover:text-gray-700 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="eventForm" onsubmit="handleEventSubmit(event)">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø¯Ø« Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 mx-6 mt-6">
                    <h4 class="text-lg font-semibold text-blue-800 mb-4 flex items-center">
                        <i class="fas fa-info-circle ml-2"></i>
                        ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¯Ø«
                    </h4>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ø­Ø¯Ø«</label>
                            <input type="text" id="eventTitle" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Ù…Ø«Ø§Ù„: Ø§Ø¬ØªÙ…Ø§Ø¹ Ø¹Ø§Ø¦Ù„ÙŠ Ø´Ù‡Ø±ÙŠ">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø­Ø¯Ø«</label>
                            <select id="eventType" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø­Ø¯Ø«</option>
                                <option value="wedding">ğŸ’’ Ø²ÙØ§Ù</option>
                                <option value="birth">ğŸ‘¶ Ù…ÙˆÙ„ÙˆØ¯ Ø¬Ø¯ÙŠØ¯</option>
                                <option value="graduation">ğŸ“ ØªØ®Ø±Ø¬</option>
                                <option value="gathering">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ØªØ¬Ù…Ø¹ Ø¹Ø§Ø¦Ù„ÙŠ</option>
                                <option value="celebration">ğŸ‰ Ø§Ø­ØªÙØ§Ù„</option>
                                <option value="religious">ğŸ•Œ Ù…Ù†Ø§Ø³Ø¨Ø© Ø¯ÙŠÙ†ÙŠØ©</option>
                                <option value="travel">âœˆï¸ Ø±Ø­Ù„Ø©/Ø³ÙØ±</option>
                                <option value="business">ğŸ’¼ Ø­Ø¯Ø« ØªØ¬Ø§Ø±ÙŠ</option>
                                <option value="other">ğŸ“ Ø£Ø®Ø±Ù‰</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¯Ø«</label>
                            <input type="date" id="eventDate" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ÙˆÙ‚Øª Ø§Ù„Ø­Ø¯Ø«</label>
                            <input type="time" id="eventTime" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø¯Ø«</label>
                        <input type="text" id="eventLocation" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Ù…Ø«Ø§Ù„: Ù‚Ø§Ø¹Ø© Ø§Ù„Ø£ÙØ±Ø§Ø­ØŒ Ø§Ù„Ù…Ù†Ø²Ù„ØŒ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø© Ø§Ù„Ø¹Ø§Ù…Ø©">
                    </div>
                    
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">ÙˆØµÙ Ø§Ù„Ø­Ø¯Ø«</label>
                        <textarea id="eventDescription" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="ÙˆØµÙ Ù…ÙØµÙ„ Ù„Ù„Ø­Ø¯Ø« ÙˆØ§Ù„ØªØ±ØªÙŠØ¨Ø§Øª..."></textarea>
                    </div>
                </div>

                <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ… -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6 mx-6">
                    <h4 class="text-lg font-semibold text-green-800 mb-4 flex items-center">
                        <i class="fas fa-users ml-2"></i>
                        ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ… ÙˆØ§Ù„Ø­Ø¶ÙˆØ±
                    </h4>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…Ù†Ø¸Ù…/Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</label>
                            <input type="text" id="eventOrganizer" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¸Ù…">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ Ù„Ù„Ø­Ø¶ÙˆØ±</label>
                            <input type="number" id="eventCapacity" min="1" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="50">
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª</label>
                        <input type="tel" id="eventContact" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="05xxxxxxxx">
                    </div>

                    <div class="mt-4 space-y-2">
                        <div class="flex items-center">
                            <input type="checkbox" id="eventRSVP" class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded">
                            <label for="eventRSVP" class="ml-2 text-sm text-gray-700">ÙŠØªØ·Ù„Ø¨ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¶ÙˆØ± (RSVP)</label>
                        </div>
                        
                        <div class="flex items-center">
                            <input type="checkbox" id="eventPublic" class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded" checked>
                            <label for="eventPublic" class="ml-2 text-sm text-gray-700">Ø­Ø¯Ø« Ø¹Ø§Ù… Ù„Ø¬Ù…ÙŠØ¹ Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</label>
                        </div>

                        <div class="flex items-center">
                            <input type="checkbox" id="eventReminder" class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded" checked>
                            <label for="eventReminder" class="ml-2 text-sm text-gray-700">Ø¥Ø±Ø³Ø§Ù„ ØªØ°ÙƒÙŠØ± Ù‚Ø¨Ù„ Ø§Ù„Ù…ÙˆØ¹Ø¯</label>
                        </div>
                    </div>
                </div>

                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                <div class="flex justify-end space-x-4 rtl:space-x-reverse pt-4 border-t border-gray-200 mx-6 mb-6">
                    <button type="button" onclick="hideEventModal()" class="px-8 py-3 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300 transition font-medium">
                        <i class="fas fa-times ml-2"></i>Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="button" onclick="resetEventForm()" class="px-8 py-3 text-amber-600 bg-amber-100 border border-amber-300 rounded-lg hover:bg-amber-200 transition font-medium">
                        <i class="fas fa-refresh ml-2"></i>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                    </button>
                    <button type="submit" class="px-8 py-3 bg-gradient-to-r from-blue-500 to-green-600 text-white rounded-lg hover:from-blue-600 hover:to-green-700 transition font-medium shadow-lg">
                        <i class="fas fa-calendar-plus ml-2"></i>Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø¯Ø«
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Admin Member Edit Modal -->
    <div id="memberEditModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-user-edit text-blue-600 ml-2"></i>
                    ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ
                </h2>
                <button type="button" onclick="hideMemberEditModal()" class="text-gray-400 hover:text-gray-600 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="memberEditForm" class="p-6">
                <input type="hidden" id="editMemberId" value="">
                
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ø³Ù… -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold text-blue-800 mb-4 flex items-center">
                        <i class="fas fa-id-card ml-2"></i>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø³Ù…
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ *</label>
                            <input type="text" id="editFirstName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆØ³Ø·</label>
                            <input type="text" id="editMiddleName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© *</label>
                            <input type="text" id="editLastName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold text-green-800 mb-4 flex items-center">
                        <i class="fas fa-address-book ml-2"></i>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *</label>
                            <input type="email" id="editEmail" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                            <input type="tel" id="editPhone" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                        </div>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold text-purple-800 mb-4 flex items-center">
                        <i class="fas fa-map-marker-alt ml-2"></i>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</label>
                            <input type="text" id="editCity" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…Ù†Ø·Ù‚Ø©/Ø§Ù„Ø­ÙŠ</label>
                            <input type="text" id="editDistrict" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¯ÙˆÙ„Ø©</label>
                            <input type="text" id="editCountry" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                        </div>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© -->
                <div class="bg-orange-50 border border-orange-200 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold text-orange-800 mb-4 flex items-center">
                        <i class="fas fa-crown ml-2"></i>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©</label>
                            <select id="editRole" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                <option value="user">Ø¹Ø¶Ùˆ Ø¹Ø§Ø¯ÙŠ</option>
                                <option value="admin">Ù…Ø¯ÙŠØ±</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©</label>
                            <select id="editStatus" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                <option value="active">Ù…ÙØ¹Ù„</option>
                                <option value="pending">Ù…Ø¹Ù„Ù‚</option>
                                <option value="suspended">Ù…ÙˆÙ‚ÙˆÙ</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© -->
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-info-circle ml-2"></i>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
                            <input type="date" id="editBirthDate" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¬Ù†Ø³</label>
                            <select id="editGender" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500">
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³</option>
                                <option value="male">Ø°ÙƒØ±</option>
                                <option value="female">Ø£Ù†Ø«Ù‰</option>
                            </select>
                        </div>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</label>
                        <textarea id="editNotes" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø£Ùˆ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø¹Ù† Ø§Ù„Ø¹Ø¶Ùˆ..."></textarea>
                    </div>
                </div>

                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                <div class="flex justify-end gap-4 pt-6 border-t border-gray-200">
                    <button type="button" onclick="hideMemberEditModal()" class="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">
                        <i class="fas fa-times ml-2"></i>Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                        <i class="fas fa-save ml-2"></i>Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Profile Edit Modal -->
    <div id="profileEditModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-user-edit text-blue-600 ml-3"></i>
                    ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©
                </h2>
                <button onclick="hideProfileEditModal()" class="text-gray-500 hover:text-gray-700 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="profileEditForm" onsubmit="saveProfileChanges(event)">
                <!-- Basic Information -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 mx-6 mt-6">
                    <h4 class="text-lg font-semibold text-blue-800 mb-4 flex items-center">
                        <i class="fas fa-user ml-2"></i>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                    </h4>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ *</label>
                            <input type="text" id="editFirstName" required placeholder="Ù…Ø«Ø§Ù„: Ø³Ù„Ù…Ø§Ù†" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆØ³Ø·</label>
                            <input type="text" id="editMiddleName" placeholder="Ù…Ø«Ø§Ù„: Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© *</label>
                            <input type="text" id="editLastName" required placeholder="Ù…Ø«Ø§Ù„: Ø³Ø¹ÙŠØ¯Ø§Ù†" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    
                    <div class="mt-3 p-2 bg-white rounded border">
                        <label class="block text-xs font-medium text-gray-500 mb-1">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ (Ù…Ø¹Ø§ÙŠÙ†Ø©)</label>
                        <div id="editFullNamePreview" class="text-lg font-semibold text-gray-800">Ø³ÙŠØªÙ… ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø§Ø³Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹...</div>
                    </div>
                </div>

                <!-- Contact Information -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6 mx-6">
                    <h4 class="text-lg font-semibold text-green-800 mb-4 flex items-center">
                        <i class="fas fa-address-book ml-2"></i>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„
                    </h4>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *</label>
                            <input type="email" id="editEmail" required placeholder="Ù…Ø«Ø§Ù„: info@salmansaedan.com" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                            <input type="tel" id="editPhone" placeholder="Ù…Ø«Ø§Ù„: 0533361154" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                        </div>
                    </div>
                </div>

                <!-- Personal Information -->
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-6 mx-6">
                    <h4 class="text-lg font-semibold text-purple-800 mb-4 flex items-center">
                        <i class="fas fa-info-circle ml-2"></i>Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©
                    </h4>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
                            <input type="date" id="editBirthDate" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ù…ÙƒØ§Ù† Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
                            <input type="text" id="editBirthPlace" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…Ù‡Ù†Ø©</label>
                            <input type="text" id="editOccupation" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø·ÙˆØ± Ø¹Ù‚Ø§Ø±ÙŠ" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¬Ù†Ø³</label>
                            <select id="editGender" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³</option>
                                <option value="male">Ø°ÙƒØ±</option>
                                <option value="female">Ø£Ù†Ø«Ù‰</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù†Ø¨Ø°Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©</label>
                        <textarea id="editBio" rows="4" placeholder="Ø£ÙƒØªØ¨ Ù†Ø¨Ø°Ø© Ù…ÙˆØ¬Ø²Ø© Ø¹Ù† Ù†ÙØ³Ùƒ..." 
                                  class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"></textarea>
                    </div>
                </div>

                <!-- Profile Picture Upload -->
                <div class="bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6 mx-6">
                    <h4 class="text-lg font-semibold text-orange-800 mb-4 flex items-center">
                        <i class="fas fa-camera ml-2"></i>Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©
                    </h4>
                    
                    <div class="flex flex-col md:flex-row items-center gap-6">
                        <div class="flex-shrink-0">
                            <img id="profilePreview" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 24 24' fill='%23e5e7eb'%3E%3Cpath d='M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z'/%3E%3C/svg%3E" 
                                 alt="Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø©" class="w-32 h-32 rounded-full border-4 border-orange-100 object-cover">
                        </div>
                        
                        <div class="flex-1">
                            <div class="text-center border-2 border-dashed border-orange-300 rounded-lg p-6">
                                <i class="fas fa-upload text-orange-500 text-3xl mb-3"></i>
                                <p class="text-gray-600 mb-2">Ø§Ø³Ø­Ø¨ Ø§Ù„ØµÙˆØ±Ø© Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±</p>
                                <p class="text-sm text-gray-500 mb-4">ÙŠØ¯Ø¹Ù…: JPG, PNG (Ø­Ø¯ Ø£Ù‚ØµÙ‰: 2MB)</p>
                                
                                <input type="file" id="profileImageFile" accept="image/*" class="hidden" onchange="handleProfileImageSelect(this)">
                                <button type="button" onclick="document.getElementById('profileImageFile').click()" 
                                        class="px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition">
                                    Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø©
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Control Buttons -->
                <div class="flex justify-end space-x-4 rtl:space-x-reverse pt-4 border-t border-gray-200 mx-6 mb-6">
                    <button type="button" onclick="hideProfileEditModal()" 
                            class="px-8 py-3 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300 transition font-medium">
                        <i class="fas fa-times ml-2"></i>Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="button" onclick="resetProfileForm()" 
                            class="px-8 py-3 text-amber-600 bg-amber-100 border border-amber-300 rounded-lg hover:bg-amber-200 transition font-medium">
                        <i class="fas fa-refresh ml-2"></i>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                    </button>
                    <button type="submit" 
                            class="px-8 py-3 bg-gradient-to-r from-blue-500 to-green-600 text-white rounded-lg hover:from-blue-600 hover:to-green-700 transition font-medium shadow-lg">
                        <i class="fas fa-save ml-2"></i>Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div id="changePasswordModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h2 class="text-xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-key text-orange-600 ml-3"></i>
                    ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
                </h2>
                <button onclick="hideChangePasswordModal()" class="text-gray-500 hover:text-gray-700 text-xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="changePasswordForm" onsubmit="changeUserPassword(event)">
                <div class="p-6 space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ© *</label>
                        <input type="password" id="currentPassword" required placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©" 
                               class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© *</label>
                        <input type="password" id="newPassword" required placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©" 
                               class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                        <div class="text-xs text-gray-500 mt-1">ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© *</label>
                        <input type="password" id="confirmNewPassword" required placeholder="Ø£Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©" 
                               class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                    </div>
                </div>
                
                <div class="flex justify-end space-x-4 rtl:space-x-reverse p-6 border-t border-gray-200">
                    <button type="button" onclick="hideChangePasswordModal()" 
                            class="px-6 py-3 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300 transition font-medium">
                        <i class="fas fa-times ml-2"></i>Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="submit" 
                            class="px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition font-medium">
                        <i class="fas fa-key ml-2"></i>ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        const SAMPLE_FAMILY_DATA = {
            familyMembers: [
                // Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¤Ø³Ø³ (Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„)
                {
                    id: 'founder_001',
                    full_name: 'Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ù…Ø­Ù…Ø¯',
                    middle_name: '',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'founder',
                    gender: 'male',
                    father_id: null,
                    generation: 1,
                    birth_date: '1950-01-01',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: 'Ø±Ø¬Ù„ Ø£Ø¹Ù…Ø§Ù„',
                    specialization: 'Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠ',
                    phone: '0533361154',
                    email: 'info@salmansaedan.com',
                    hobbies: 'Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©ØŒ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØŒ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø®ÙŠØ±ÙŠØ©',
                    created_at: '2024-01-01'
                },
                
                // Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ - Ø£Ø¨Ù†Ø§Ø¡ Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†
                {
                    id: 'gen2_001',
                    full_name: 'Ø³Ù„Ù…Ø§Ù† Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø³Ù„Ù…Ø§Ù†',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'chairman',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1975-05-15',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: 'Ù…Ø·ÙˆØ± Ø¹Ù‚Ø§Ø±ÙŠ',
                    specialization: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©',
                    phone: '0533361156',
                    email: 'salman@salmansaedan.com',
                    hobbies: 'Ø§Ù„Ø³ÙØ±ØŒ Ø§Ù„ØªØµÙˆÙŠØ±ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶Ø©ØŒ ØªØ·ÙˆÙŠØ± Ø§Ù„Ø£Ø¹Ù…Ø§Ù„',
                    created_at: '2024-01-02'
                },
                {
                    id: 'gen2_002',
                    full_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1970-03-10',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-03'
                },
                {
                    id: 'gen2_003',
                    full_name: 'ÙÙ‡Ø¯ Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'ÙÙ‡Ø¯',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1972-07-22',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-04'
                },
                {
                    id: 'gen2_004',
                    full_name: 'Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø­Ù…Ø¯',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1974-11-05',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-05'
                },
                {
                    id: 'gen2_005',
                    full_name: 'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1976-09-18',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-06'
                },
                {
                    id: 'gen2_006',
                    full_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù† Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù†',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1978-12-30',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-07'
                },
                {
                    id: 'gen2_007',
                    full_name: 'Ù†Ø§ØµØ± Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ù†Ø§ØµØ±',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1980-04-12',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-08'
                },
                {
                    id: 'gen2_008',
                    full_name: 'Ø³Ø¹Ø¯ Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø³Ø¹Ø¯',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1982-08-25',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-09'
                },
                {
                    id: 'gen2_009',
                    full_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø­Ø³Ù† Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø­Ø³Ù†',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1984-02-14',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-10'
                },
                {
                    id: 'gen2_010',
                    full_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ²',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1986-06-08',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-11'
                },
                {
                    id: 'gen2_011',
                    full_name: 'Ù…ØªØ¹Ø¨ Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ù…ØªØ¹Ø¨',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1988-10-20',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-12'
                },
                {
                    id: 'gen2_012',
                    full_name: 'Ø¨Ù†Ø¯Ø± Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø¨Ù†Ø¯Ø±',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1990-01-15',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-13'
                },
                
                // Ø¨Ù†Ø§Øª Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù† (Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ)
                {
                    id: 'gen2_013',
                    full_name: 'Ù…Ù†ÙŠØ±Ø© Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ù…Ù†ÙŠØ±Ø©',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'family_member',
                    gender: 'female',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1973-05-12',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-14'
                },
                {
                    id: 'gen2_014',
                    full_name: 'Ø³Ø§Ø±Ø© Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø³Ø§Ø±Ø©',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'family_member',
                    gender: 'female',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1977-08-03',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-15'
                },
                {
                    id: 'gen2_015',
                    full_name: 'Ù†ÙˆØ±Ø© Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ù†ÙˆØ±Ø©',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'family_member',
                    gender: 'female',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1981-11-26',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-16'
                },
                {
                    id: 'gen2_016',
                    full_name: 'Ø§Ù„Ø¹Ù†ÙˆØ¯ Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø§Ù„Ø¹Ù†ÙˆØ¯',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'family_member',
                    gender: 'female',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1985-03-17',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-17'
                },
                {
                    id: 'gen2_017',
                    full_name: 'ÙˆØ³Ù…ÙŠØ© Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'ÙˆØ³Ù…ÙŠØ©',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'family_member',
                    gender: 'female',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1987-09-09',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-18'
                }
            ],
            events: [
                {
                    id: 'event_001',
                    title: 'Ø§Ø¬ØªÙ…Ø§Ø¹ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ø³Ù†ÙˆÙŠ',
                    description: 'Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ Ø§Ù„Ø³Ù†ÙˆÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©',
                    date: '2024-12-15',
                    time: '18:00',
                    location: 'Ù‚Ø§Ø¹Ø© Ø§Ù„Ù…Ù„Ùƒ ÙÙ‡Ø¯',
                    type: 'family',
                    status: 'upcoming',
                    attendees: 45
                }
            ],
            suggestions: [
                {
                    id: 'sugg_001',
                    title: 'ØªØ·ÙˆÙŠØ± ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¬ÙˆØ§Ù„ Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©',
                    category: 'technology',
                    priority: 'high',
                    description: 'Ø¥Ù†Ø´Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚ Ø¬ÙˆØ§Ù„ Ù…ØªÙ‚Ø¯Ù… Ù„Ø¥Ø¯Ø§Ø±Ø© Ø´Ø¤ÙˆÙ† Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© ÙˆØ§Ù„ØªÙˆØ§ØµÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡',
                    benefits: 'ØªØ³Ù‡ÙŠÙ„ Ø§Ù„ØªÙˆØ§ØµÙ„ØŒ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø«ØŒ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ø°ÙƒØ±ÙŠØ§Øª',
                    budget: '75,000 Ø±ÙŠØ§Ù„',
                    timeline: '6 Ø£Ø´Ù‡Ø±',
                    resources: 'ÙØ±ÙŠÙ‚ ØªØ·ÙˆÙŠØ±ØŒ Ù…ØµÙ…Ù… ÙˆØ§Ø¬Ù‡Ø§ØªØŒ Ù…Ø·ÙˆØ± ØªØ·Ø¨ÙŠÙ‚Ø§Øª',
                    status: 'pending',
                    submitted_by: 'Ø³Ù„Ù…Ø§Ù† Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    submitted_date: '2024-01-15',
                    votes: {
                        up: 18,
                        down: 2
                    },
                    comments: []
                },
                {
                    id: 'sugg_002',
                    title: 'ØªÙ†Ø¸ÙŠÙ… Ù„Ù‚Ø§Ø¡ Ø¹Ø§Ø¦Ù„ÙŠ Ø³Ù†ÙˆÙŠ',
                    category: 'events',
                    priority: 'medium',
                    description: 'ØªÙ†Ø¸ÙŠÙ… Ù„Ù‚Ø§Ø¡ Ø¹Ø§Ø¦Ù„ÙŠ Ø³Ù†ÙˆÙŠ ÙŠØ¬Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ù„Ù„ØªÙˆØ§ØµÙ„ ÙˆØªÙ‚ÙˆÙŠØ© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·',
                    benefits: 'ØªÙ‚ÙˆÙŠØ© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ©ØŒ ØªØ¨Ø§Ø¯Ù„ Ø§Ù„Ø®Ø¨Ø±Ø§ØªØŒ Ø¥Ø­ÙŠØ§Ø¡ Ø§Ù„ØªÙ‚Ø§Ù„ÙŠØ¯',
                    budget: '25,000 Ø±ÙŠØ§Ù„',
                    timeline: '3 Ø£Ø´Ù‡Ø± Ù„Ù„ØªØ­Ø¶ÙŠØ±',
                    resources: 'Ù‚Ø§Ø¹Ø© Ù…Ù†Ø§Ø³Ø¨Ø©ØŒ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø·Ø¹Ø§Ù…ØŒ Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ±ÙÙŠÙ‡ÙŠ',
                    status: 'approved',
                    submitted_by: 'Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    submitted_date: '2024-02-01',
                    votes: {
                        up: 24,
                        down: 1
                    },
                    comments: []
                },
                {
                    id: 'sugg_003',
                    title: 'Ø¥Ù†Ø´Ø§Ø¡ ØµÙ†Ø¯ÙˆÙ‚ ØªØ¹Ø§ÙˆÙ†ÙŠ Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©',
                    category: 'business',
                    priority: 'high',
                    description: 'ØªØ£Ø³ÙŠØ³ ØµÙ†Ø¯ÙˆÙ‚ ØªØ¹Ø§ÙˆÙ†ÙŠ Ù„Ø¯Ø¹Ù… Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© ÙÙŠ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ ÙˆØ§Ù„Ø·ÙˆØ§Ø±Ø¦',
                    benefits: 'Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØŒ ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ØŒ Ø§Ù„ØªØ¶Ø§Ù…Ù† Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠ',
                    budget: '500,000 Ø±ÙŠØ§Ù„ Ø±Ø£Ø³ Ù…Ø§Ù„ Ø£ÙˆÙ„ÙŠ',
                    timeline: '4 Ø£Ø´Ù‡Ø± Ù„Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©',
                    resources: 'Ù…Ø­Ø§Ù…ÙŠ Ù…ØªØ®ØµØµØŒ Ù…Ø­Ø§Ø³Ø¨ Ù‚Ø§Ù†ÙˆÙ†ÙŠØŒ Ù…Ø¯ÙŠØ± Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚',
                    status: 'under_review',
                    submitted_by: 'Ø³Ù„Ù…Ø§Ù† Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    submitted_date: '2024-01-20',
                    votes: {
                        up: 12,
                        down: 5
                    },
                    comments: []
                }
            ],
            library: [
                {
                    id: 'lib_001',
                    title: 'ØªØ§Ø±ÙŠØ® ÙˆØ£ØµÙˆÙ„ Ø¹Ø§Ø¦Ù„Ø© Ø¢Ù„ Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    author: 'Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    type: 'document',
                    category: 'family_history',
                    description: 'ÙˆØ«ÙŠÙ‚Ø© Ø´Ø§Ù…Ù„Ø© Ø¹Ù† ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© ÙˆØ£ØµÙˆÙ„Ù‡Ø§ Ø§Ù„ØªÙŠ ØªÙ…ØªØ¯ Ù„Ù‚Ø±ÙˆÙ† Ù…Ù† Ø§Ù„Ø²Ù…Ù†',
                    keywords: ['ØªØ§Ø±ÙŠØ®', 'Ù†Ø³Ø¨', 'Ø¹Ø§Ø¦Ù„Ø©', 'Ø£ØµÙˆÙ„', 'ØªØ±Ø§Ø«'],
                    created_date: '2023-12-01',
                    language: 'arabic',
                    access_level: 'family',
                    featured: true,
                    url: '#',
                    views: 45,
                    downloads: 12
                },
                {
                    id: 'lib_002',
                    title: 'Ø´Ø¬Ø±Ø© Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©',
                    author: 'Ù†Ø³Ø§Ø¨Ø© Ù…ØªØ®ØµØµ',
                    type: 'document',
                    category: 'genealogy',
                    description: 'Ù…Ø®Ø·Ø· ØªÙØµÙŠÙ„ÙŠ Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ù†Ø³Ø¨ ÙŠÙˆØ¶Ø­ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ© Ø¹Ø¨Ø± Ø§Ù„Ø£Ø¬ÙŠØ§Ù„',
                    keywords: ['Ù†Ø³Ø¨', 'Ø´Ø¬Ø±Ø©', 'Ø£Ø¬ÙŠØ§Ù„', 'Ø¹Ù„Ø§Ù‚Ø§Øª Ø¹Ø§Ø¦Ù„ÙŠØ©'],
                    created_date: '2024-01-10',
                    language: 'arabic',
                    access_level: 'family',
                    featured: true,
                    url: '#',
                    views: 67,
                    downloads: 23
                },
                {
                    id: 'lib_003',
                    title: 'Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø±Ø³Ù…ÙŠØ© ÙˆØ§Ù„Ø³Ø¬Ù„Ø§Øª',
                    author: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠ',
                    type: 'document',
                    category: 'documents',
                    description: 'Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø±Ø³Ù…ÙŠØ© ÙˆØ§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ù‡Ù…Ø© Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©',
                    keywords: ['ÙˆØ«Ø§Ø¦Ù‚', 'Ø³Ø¬Ù„Ø§Øª', 'Ø±Ø³Ù…ÙŠ', 'Ø£Ø±Ø´ÙŠÙ'],
                    created_date: '2024-01-05',
                    language: 'arabic',
                    access_level: 'admin',
                    featured: false,
                    url: '#',
                    views: 28,
                    downloads: 8
                },
                {
                    id: 'lib_004',
                    title: 'ØµÙˆØ± ÙˆØ°ÙƒØ±ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø¹Ø¨Ø± Ø§Ù„ØªØ§Ø±ÙŠØ®',
                    author: 'Ø£Ø±Ø´ÙŠÙ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©',
                    type: 'image',
                    category: 'photos',
                    description: 'Ù…Ø¬Ù…ÙˆØ¹Ø© Ù†Ø§Ø¯Ø±Ø© Ù…Ù† Ø§Ù„ØµÙˆØ± Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ© ÙˆØ§Ù„Ø°ÙƒØ±ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ© Ø§Ù„Ø«Ù…ÙŠÙ†Ø©',
                    keywords: ['ØµÙˆØ±', 'Ø°ÙƒØ±ÙŠØ§Øª', 'ØªØ§Ø±ÙŠØ®', 'Ø¹Ø§Ø¦Ù„Ø©', 'ØªØ±Ø§Ø«'],
                    created_date: '2024-02-01',
                    language: 'arabic',
                    access_level: 'public',
                    featured: true,
                    url: '#',
                    views: 89,
                    downloads: 34
                },
                {
                    id: 'lib_005',
                    title: 'Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© ÙÙŠ Ù…Ø¬Ø§Ù„ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„',
                    author: 'Ø³Ù„Ù…Ø§Ù† Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    type: 'presentation',
                    category: 'achievements',
                    description: 'Ø¹Ø±Ø¶ ØªÙ‚Ø¯ÙŠÙ…ÙŠ ÙŠØ¨Ø±Ø² Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© ÙˆØ§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ© Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©',
                    keywords: ['Ø¥Ù†Ø¬Ø§Ø²Ø§Øª', 'Ø£Ø¹Ù…Ø§Ù„', 'Ø§Ø³ØªØ«Ù…Ø§Ø±', 'Ù†Ø¬Ø§Ø­', 'ØªØ¬Ø§Ø±Ø©'],
                    created_date: '2024-01-25',
                    language: 'arabic',
                    access_level: 'family',
                    featured: true,
                    url: '#',
                    views: 52,
                    downloads: 19
                },
                {
                    id: 'lib_006',
                    title: 'Ø­ÙƒØ§ÙŠØ§Øª ÙˆÙ‚ØµØµ Ù…Ù† Ø§Ù„ØªØ±Ø§Ø« Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠ',
                    author: 'Ø±ÙˆØ§Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©',
                    type: 'audio',
                    category: 'stories',
                    description: 'Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù† Ø§Ù„Ù‚ØµØµ ÙˆØ§Ù„Ø­ÙƒØ§ÙŠØ§Øª Ø§Ù„Ù…ØªÙˆØ§Ø±Ø«Ø© Ø§Ù„ØªÙŠ ØªØ­ÙƒÙŠ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©',
                    keywords: ['Ø­ÙƒØ§ÙŠØ§Øª', 'Ù‚ØµØµ', 'ØªØ±Ø§Ø«', 'Ù…ÙˆØ±ÙˆØ«', 'Ø´ÙÙ‡ÙŠ'],
                    created_date: '2024-02-10',
                    language: 'arabic',
                    access_level: 'family',
                    featured: false,
                    url: '#',
                    views: 31,
                    downloads: 7
                }
            ]
        };

        // Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
        class UserManager {
            constructor() {
                this.usersStorageKey = 'al_saedan_users_v1';
                this.currentUserKey = 'al_saedan_current_user';
                this.users = this.loadUsers();
                this.currentUser = this.loadCurrentUser();
                this.initializeDefaultAdmin();
            }

            loadUsers() {
                try {
                    const stored = localStorage.getItem(this.usersStorageKey);
                    return stored ? JSON.parse(stored) : [];
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†:', error);
                    return [];
                }
            }

            saveUsers() {
                try {
                    localStorage.setItem(this.usersStorageKey, JSON.stringify(this.users));
                    return true;
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†:', error);
                    return false;
                }
            }

            loadCurrentUser() {
                try {
                    const stored = localStorage.getItem(this.currentUserKey);
                    return stored ? JSON.parse(stored) : null;
                } catch (error) {
                    return null;
                }
            }

            saveCurrentUser(user) {
                try {
                    if (user) {
                        localStorage.setItem(this.currentUserKey, JSON.stringify(user));
                    } else {
                        localStorage.removeItem(this.currentUserKey);
                    }
                    this.currentUser = user;
                    return true;
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ:', error);
                    return false;
                }
            }

            initializeDefaultAdmin() {
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø§Ù„ØµØ­ÙŠØ­
                const defaultAdminEmail = 'admin@salmansaedan.com';
                let adminUser = this.users.find(u => u.email === defaultAdminEmail);
                
                if (!adminUser) {
                    // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
                    const defaultAdmin = {
                        id: 'admin_default',
                        national_id: '1000000000',
                        first_name: 'Ù…Ø¯ÙŠØ±',
                        middle_name: 'Ø§Ù„Ù†Ø¸Ø§Ù…',
                        last_name: 'Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ',
                        full_name: 'Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ',
                        email: defaultAdminEmail,
                        phone: '0533361154',
                        password: this.hashPassword('admin123'),
                        role: 'admin',
                        status: 'active',
                        birth_date: '1970-01-01',
                        birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶',
                        profession: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù…',
                        specialization: 'Ø¥Ø¯Ø§Ø±Ø© ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
                        hobbies: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù†Ø¸Ù…Ø©ØŒ Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„ØªÙ‚Ù†ÙŠ',
                        father_id: null,
                        generation: 1,
                        created_at: new Date().toISOString(),
                        approved_at: new Date().toISOString(),
                        approved_by: 'system'
                    };
                    this.users.push(defaultAdmin);
                    this.saveUsers();
                    console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ');
                } else {
                    // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØµØ­ÙŠØ­Ø© Ù„Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯
                    if (adminUser.role !== 'admin' || adminUser.status !== 'active') {
                        adminUser.role = 'admin';
                        adminUser.status = 'active';
                        adminUser.password = this.hashPassword('admin123');
                        this.saveUsers();
                        console.log('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ');
                    }
                }
                
                // Ø·Ø¨Ø§Ø¹Ø© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¯ÙŠØ± Ù„Ù„ØªØ£ÙƒÙŠØ¯
                const admin = this.users.find(u => u.email === defaultAdminEmail);
                if (admin) {
                    console.log('ğŸ” Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ:');
                    console.log('   Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:', admin.email);
                    console.log('   ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: admin123');
                    console.log('   Ø§Ù„Ø­Ø§Ù„Ø©:', admin.status);
                    console.log('   Ø§Ù„Ø¯ÙˆØ±:', admin.role);
                }
            }

            hashPassword(password) {
                // ØªØ´ÙÙŠØ± Ø¨Ø³ÙŠØ· - ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø§Ø³ØªØ®Ø¯Ù… ØªØ´ÙÙŠØ± Ø£Ù‚ÙˆÙ‰
                return btoa(password + 'salt_key_2024');
            }

            verifyPassword(inputPassword, hashedPassword) {
                return this.hashPassword(inputPassword) === hashedPassword;
            }

            generateId() {
                return 'user_' + Date.now().toString(36) + Math.random().toString(36).substr(2);
            }

            // ØªØ³Ø¬ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
            registerUser(userData) {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                const existingUser = this.users.find(u => 
                    u.national_id === userData.national_id || u.email === userData.email
                );
                
                if (existingUser) {
                    throw new Error('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„ Ø¨Ù†ÙØ³ Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ');
                }

                const newUser = {
                    id: this.generateId(),
                    ...userData,
                    password: this.hashPassword(userData.password),
                    role: 'user',
                    status: 'pending', // ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©
                    created_at: new Date().toISOString(),
                    approved_at: null,
                    approved_by: null
                };

                this.users.push(newUser);
                this.saveUsers();
                return newUser;
            }

            // ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„
            login(identifier, password) {
                console.log('ğŸ” Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„:');
                console.log('   Ø§Ù„Ù…Ø¹Ø±Ù:', identifier);
                console.log('   Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø­ÙÙˆØ¸ÙŠÙ†:', this.users.length);
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                const user = this.users.find(u => 
                    u.national_id === identifier || u.email === identifier
                );

                if (!user) {
                    console.log('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…');
                    console.log('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù…ØªØ§Ø­ÙˆÙ†:');
                    this.users.forEach(u => console.log(`   - ${u.email} (${u.national_id})`));
                    throw new Error('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                }

                console.log('âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', user.email);
                console.log('   Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', user.status);
                console.log('   Ø¯ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', user.role);

                if (user.status !== 'active') {
                    throw new Error('Ø§Ù„Ø­Ø³Ø§Ø¨ ØºÙŠØ± Ù…ÙØ¹Ù„. ÙŠØ±Ø¬Ù‰ Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.');
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
                const passwordHash = this.hashPassword(password);
                console.log('ğŸ” Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±...');
                console.log('   ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø¯Ø®Ù„Ø© (Ù…Ø´ÙØ±Ø©):', passwordHash);
                console.log('   ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:', user.password);

                if (!this.verifyPassword(password, user.password)) {
                    console.log('âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
                    throw new Error('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
                }

                console.log('âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­');
                this.saveCurrentUser(user);
                return user;
            }

            // ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬
            logout() {
                this.saveCurrentUser(null);
                return true;
            }

            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø¹Ù„Ù‚ÙŠÙ†
            getPendingUsers() {
                return this.users.filter(u => u.status === 'pending');
            }

            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ÙØ¹Ù„ÙŠÙ†
            getActiveUsers() {
                return this.users.filter(u => u.status === 'active');
            }

            // ØªÙØ¹ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… (Ù„Ù„Ø¥Ø¯Ù…Ù† ÙÙ‚Ø·)
            approveUser(userId, adminId) {
                const userIndex = this.users.findIndex(u => u.id === userId);
                const admin = this.users.find(u => u.id === adminId && u.role === 'admin');

                if (userIndex === -1) {
                    throw new Error('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                }

                if (!admin) {
                    throw new Error('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†');
                }

                this.users[userIndex].status = 'active';
                this.users[userIndex].approved_at = new Date().toISOString();
                this.users[userIndex].approved_by = adminId;

                this.saveUsers();
                return this.users[userIndex];
            }

            // Ø±ÙØ¶ Ù…Ø³ØªØ®Ø¯Ù… (Ù„Ù„Ø¥Ø¯Ù…Ù† ÙÙ‚Ø·)
            rejectUser(userId, adminId) {
                const userIndex = this.users.findIndex(u => u.id === userId);
                const admin = this.users.find(u => u.id === adminId && u.role === 'admin');

                if (userIndex === -1) {
                    throw new Error('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                }

                if (!admin) {
                    throw new Error('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ø±ÙØ¶ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†');
                }

                this.users.splice(userIndex, 1);
                this.saveUsers();
                return true;
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
            hasPermission(action) {
                if (!this.currentUser || this.currentUser.status !== 'active') {
                    return false;
                }

                const permissions = {
                    admin: ['view_all', 'edit_all', 'delete_all', 'approve_users', 'manage_system'],
                    user: ['view_own', 'edit_own', 'comment_only']
                };

                return permissions[this.currentUser.role]?.includes(action) || false;
            }

            // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            updateUser(userId, updateData) {
                const userIndex = this.users.findIndex(u => u.id === userId);
                
                if (userIndex === -1) {
                    throw new Error('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
                if (this.currentUser.id !== userId && this.currentUser.role !== 'admin') {
                    throw new Error('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…');
                }

                // Ù…Ù†Ø¹ ØªØºÙŠÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø³Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¹Ø§Ø¯ÙŠÙŠÙ†
                const restrictedFields = ['role', 'status', 'approved_at', 'approved_by'];
                if (this.currentUser.role !== 'admin') {
                    restrictedFields.forEach(field => delete updateData[field]);
                }

                this.users[userIndex] = {
                    ...this.users[userIndex],
                    ...updateData,
                    updated_at: new Date().toISOString()
                };

                this.saveUsers();
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ùˆ Ù†ÙØ³Ù‡
                if (this.currentUser.id === userId) {
                    this.saveCurrentUser(this.users[userIndex]);
                }

                return this.users[userIndex];
            }

            // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ (Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…)
            resetDefaultAdmin() {
                // Ø­Ø°Ù Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø­Ø§Ù„ÙŠ
                this.users = this.users.filter(u => u.email !== 'admin@salmansaedan.com');
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯
                const defaultAdmin = {
                    id: 'admin_default_' + Date.now(),
                    national_id: '1000000000',
                    first_name: 'Ù…Ø¯ÙŠØ±',
                    middle_name: 'Ø§Ù„Ù†Ø¸Ø§Ù…',
                    last_name: 'Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ',
                    full_name: 'Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ',
                    email: 'admin@salmansaedan.com',
                    phone: '0533361154',
                    password: this.hashPassword('admin123'),
                    role: 'admin',
                    status: 'active',
                    birth_date: '1970-01-01',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶',
                    profession: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù…',
                    specialization: 'Ø¥Ø¯Ø§Ø±Ø© ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
                    hobbies: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù†Ø¸Ù…Ø©ØŒ Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„ØªÙ‚Ù†ÙŠ',
                    father_id: null,
                    generation: 1,
                    created_at: new Date().toISOString(),
                    approved_at: new Date().toISOString(),
                    approved_by: 'system'
                };
                
                this.users.push(defaultAdmin);
                this.saveUsers();
                
                console.log('âœ… ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ:');
                console.log('   Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: admin@salmansaedan.com');
                console.log('   ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: admin123');
                
                return defaultAdmin;
            }

            // === ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ===

            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø³ØªØ®Ø¯Ù… Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù…Ø¹Ø±Ù
            getUserById(userId) {
                return this.users.find(u => u.id === userId) || null;
            }

            // Ø­Ø°Ù Ù…Ø³ØªØ®Ø¯Ù… (Ù„Ù„Ø¥Ø¯Ù…Ù† ÙÙ‚Ø·)
            deleteUser(userId) {
                const userIndex = this.users.findIndex(u => u.id === userId);
                const userToDelete = this.users[userIndex];
                
                if (userIndex === -1) {
                    throw new Error('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
                if (!this.currentUser || this.currentUser.role !== 'admin') {
                    throw new Error('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†');
                }

                // Ù…Ù†Ø¹ Ø­Ø°Ù Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„ÙˆØ­ÙŠØ¯
                const activeAdmins = this.users.filter(u => u.role === 'admin' && u.status === 'active');
                if (userToDelete.role === 'admin' && activeAdmins.length === 1) {
                    throw new Error('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„ÙˆØ­ÙŠØ¯ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…');
                }

                // Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                this.users.splice(userIndex, 1);
                this.saveUsers();
                
                console.log(`âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${userToDelete.full_name} (${userToDelete.email})`);
                return true;
            }

            // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø³ØªØ®Ø¯Ù… (Ù†Ø³Ø®Ø© Ù…Ø­Ø³Ù†Ø© Ù…Ø¹ Ø¯Ø¹Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©)
            updateUser(userId, updateData) {
                const userIndex = this.users.findIndex(u => u.id === userId);
                
                if (userIndex === -1) {
                    throw new Error('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                }

                const originalUser = this.users[userIndex];

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
                if (this.currentUser.id !== userId && this.currentUser.role !== 'admin') {
                    throw new Error('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…');
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙƒØ±Ø§Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
                if (updateData.email && updateData.email !== originalUser.email) {
                    const existingUser = this.users.find(u => u.email === updateData.email && u.id !== userId);
                    if (existingUser) {
                        throw new Error('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„');
                    }
                }

                // Ù…Ù†Ø¹ ØªØºÙŠÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø³Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¹Ø§Ø¯ÙŠÙŠÙ†
                const restrictedFields = ['id', 'created_at', 'approved_at', 'approved_by'];
                if (this.currentUser.role !== 'admin') {
                    restrictedFields.push('role', 'status');
                }
                
                restrictedFields.forEach(field => delete updateData[field]);

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const updatedUser = {
                    ...originalUser,
                    ...updateData,
                    updated_at: new Date().toISOString()
                };

                this.users[userIndex] = updatedUser;
                this.saveUsers();
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ùˆ Ù†ÙØ³Ù‡
                if (this.currentUser.id === userId) {
                    this.saveCurrentUser(updatedUser);
                    this.currentUser = updatedUser;
                }

                console.log(`âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${updatedUser.full_name}`);
                return updatedUser;
            }

            // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¥Ø¯Ø§Ø±ÙŠØ©
            getAdminStats() {
                const totalUsers = this.users.length;
                const activeUsers = this.users.filter(u => u.status === 'active').length;
                const pendingUsers = this.users.filter(u => u.status === 'pending').length;
                const adminUsers = this.users.filter(u => u.role === 'admin').length;

                return {
                    total: totalUsers,
                    active: activeUsers,
                    pending: pendingUsers,
                    admins: adminUsers,
                    suspended: this.users.filter(u => u.status === 'suspended').length
                };
            }
        }

        // Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø³Ù†
        class EnhancedDataManager {
            constructor() {
                this.storageKey = 'al_saedan_app_v2';
                this.data = this.loadData();
                this.initializeDefaultData();
                this.setupStorageSync();
            }

            loadData() {
                try {
                    const stored = localStorage.getItem(this.storageKey);
                    if (stored) {
                        const parsed = JSON.parse(stored);
                        return {
                            familyMembers: parsed.familyMembers || [],
                            events: parsed.events || [],
                            suggestions: parsed.suggestions || [],
                            library: parsed.library || [],
                            lastUpdated: parsed.lastUpdated || new Date().toISOString(),
                            version: parsed.version || 1
                        };
                    }
                    return {
                        familyMembers: [],
                        events: [],
                        suggestions: [],
                        library: [],
                        lastUpdated: new Date().toISOString(),
                        version: 1
                    };
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                    return {
                        familyMembers: [],
                        events: [],
                        suggestions: [],
                        library: [],
                        lastUpdated: new Date().toISOString(),
                        version: 1
                    };
                }
            }

            saveData() {
                try {
                    this.data.lastUpdated = new Date().toISOString();
                    this.data.version = (this.data.version || 0) + 1;
                    localStorage.setItem(this.storageKey, JSON.stringify(this.data));
                    
                    // Ø¥Ø´Ø¹Ø§Ù„ Ø­Ø¯Ø« ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    window.dispatchEvent(new CustomEvent('dataUpdated', { detail: this.data }));
                    
                    return true;
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                    return false;
                }
            }

            initializeDefaultData() {
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ÙØ§Ø±ØºØ©
                // âœ… ENHANCED 2025-10-11: Ù†Ø¸Ø§Ù… Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø³Ù†
                if (this.data.familyMembers.length === 0) {
                    console.log('ğŸ“Š Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø§Ø¦Ù„ÙŠØ© Ù…Ø­Ù„ÙŠØ§Ù‹ - Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…ØµØ§Ø¯Ø± Ø¨Ø¯ÙŠÙ„Ø©...');
                    
                    // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…ØµØ§Ø¯Ø± Ù…Ø®ØªÙ„ÙØ©
                    if (!this.tryRestoreFromBackup()) {
                        console.log('ğŸ“Š Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© - ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©');
                        this.loadSampleData();
                        this.createBackup(); // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙÙˆØ±Ø§Ù‹
                    }
                } else {
                    console.log(`âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${this.data.familyMembers.length} Ø¹Ø¶Ùˆ ÙÙŠ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©`);
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
                    this.checkDataConsistency();
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ
                    const secondGenMembers = this.data.familyMembers.filter(m => m.generation === 2);
                    console.log(`ğŸŒ³ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ: ${secondGenMembers.length} Ø£Ø¹Ø¶Ø§Ø¡`);
                    secondGenMembers.forEach(member => {
                        console.log(`   - ${member.full_name} (Ø§Ù„ÙˆØ§Ù„Ø¯: ${member.father_id || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'})`);
                    });
                    
                    // ØªØ­Ø¯ÙŠØ« Ù…Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø£Ø·ÙØ§Ù„ Ù„Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ÙŠÙ†
                    this.updateChildrenReferences();
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
                    this.updateBackupIfNeeded();
                }
            }

            // === Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ ÙˆØ§Ù„Ù…Ø²Ø§Ù…Ù†Ø© ===
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            createBackup() {
                try {
                    const backupData = {
                        data: JSON.parse(JSON.stringify(this.data)),
                        timestamp: new Date().toISOString(),
                        version: '1.0',
                        source: 'family_app_backup'
                    };
                    
                    // Ø­ÙØ¸ ÙÙŠ localStorage Ù…Ø¹ Ù…ÙØªØ§Ø­ Ù…Ø®ØªÙ„Ù
                    localStorage.setItem('family_data_backup', JSON.stringify(backupData));
                    
                    // Ø­ÙØ¸ ÙÙŠ sessionStorage ÙƒØ°Ù„Ùƒ
                    sessionStorage.setItem('family_data_backup', JSON.stringify(backupData));
                    
                    // Ù…Ø­Ø§ÙˆÙ„Ø© Ø­ÙØ¸ ÙÙŠ IndexedDB Ù„Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…ÙˆØ«ÙˆÙ‚ÙŠØ©
                    this.saveToIndexedDB(backupData);
                    
                    console.log('ğŸ’¾ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                    return true;
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©:', error);
                    return false;
                }
            }
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
            tryRestoreFromBackup() {
                const sources = [
                    () => localStorage.getItem('family_data_backup'),
                    () => sessionStorage.getItem('family_data_backup'),
                    () => this.loadFromIndexedDB()
                ];
                
                for (let i = 0; i < sources.length; i++) {
                    try {
                        const backupStr = sources[i]();
                        if (backupStr) {
                            const backup = JSON.parse(backupStr);
                            if (this.validateBackupData(backup)) {
                                console.log(`ğŸ”„ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…ØµØ¯Ø± ${i + 1}`);
                                this.data = backup.data;
                                this.saveData();
                                return true;
                            }
                        }
                    } catch (error) {
                        console.warn(`âš ï¸ ÙØ´Ù„ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…ØµØ¯Ø± ${i + 1}:`, error.message);
                    }
                }
                
                return false;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
            validateBackupData(backup) {
                return backup && 
                       backup.data && 
                       backup.timestamp && 
                       Array.isArray(backup.data.familyMembers) &&
                       backup.data.familyMembers.length > 0;
            }
            
            // ÙØ­Øµ ØªÙ†Ø§Ø³Ù‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
            checkDataConsistency() {
                try {
                    const backupStr = localStorage.getItem('family_data_backup');
                    if (backupStr) {
                        const backup = JSON.parse(backupStr);
                        const currentCount = this.data.familyMembers.length;
                        const backupCount = backup.data?.familyMembers?.length || 0;
                        
                        if (Math.abs(currentCount - backupCount) > 5) {
                            console.warn(`âš ï¸ ØªØ¨Ø§ÙŠÙ† ÙÙŠ Ø¹Ø¯Ø¯ Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©: Ø§Ù„Ø­Ø§Ù„ÙŠ ${currentCount}ØŒ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ${backupCount}`);
                            this.showDataSyncWarning(currentCount, backupCount);
                        }
                    }
                } catch (error) {
                    console.warn('âš ï¸ Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ ØªÙ†Ø§Ø³Ù‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                }
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©
            updateBackupIfNeeded() {
                try {
                    const backupStr = localStorage.getItem('family_data_backup');
                    if (backupStr) {
                        const backup = JSON.parse(backupStr);
                        const lastUpdate = new Date(backup.timestamp);
                        const hoursSinceUpdate = (Date.now() - lastUpdate.getTime()) / (1000 * 60 * 60);
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙƒÙ„ 6 Ø³Ø§Ø¹Ø§Øª Ø£Ùˆ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                        if (hoursSinceUpdate > 6 || this.hasDataChanged(backup.data)) {
                            this.createBackup();
                        }
                    } else {
                        this.createBackup();
                    }
                } catch (error) {
                    console.warn('âš ï¸ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©:', error);
                }
            }
            
            // ÙØ­Øµ Ù…Ø§ Ø¥Ø°Ø§ ØªØºÙŠØ±Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            hasDataChanged(backupData) {
                const currentHash = this.generateDataHash(this.data);
                const backupHash = this.generateDataHash(backupData);
                return currentHash !== backupHash;
            }
            
            // ØªÙˆÙ„ÙŠØ¯ hash Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
            generateDataHash(data) {
                const str = JSON.stringify({
                    familyCount: data.familyMembers?.length || 0,
                    eventsCount: data.events?.length || 0,
                    suggestionsCount: data.suggestions?.length || 0,
                    libraryCount: data.library?.length || 0
                });
                return btoa(str);
            }
            
            // Ø­ÙØ¸ ÙÙŠ IndexedDB Ù„Ù„Ù…ÙˆØ«ÙˆÙ‚ÙŠØ© Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
            saveToIndexedDB(data) {
                if (typeof indexedDB !== 'undefined') {
                    const request = indexedDB.open('FamilyAppDB', 1);
                    request.onupgradeneeded = (e) => {
                        const db = e.target.result;
                        if (!db.objectStoreNames.contains('backups')) {
                            db.createObjectStore('backups', { keyPath: 'id' });
                        }
                    };
                    request.onsuccess = (e) => {
                        const db = e.target.result;
                        const tx = db.transaction(['backups'], 'readwrite');
                        const store = tx.objectStore('backups');
                        store.put({ id: 'main_backup', ...data });
                    };
                }
            }
            
            // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ù…Ù† IndexedDB
            async loadFromIndexedDB() {
                return new Promise((resolve) => {
                    if (typeof indexedDB === 'undefined') {
                        resolve(null);
                        return;
                    }
                    
                    const request = indexedDB.open('FamilyAppDB', 1);
                    request.onsuccess = (e) => {
                        try {
                            const db = e.target.result;
                            const tx = db.transaction(['backups'], 'readonly');
                            const store = tx.objectStore('backups');
                            const getRequest = store.get('main_backup');
                            
                            getRequest.onsuccess = () => {
                                resolve(getRequest.result ? JSON.stringify(getRequest.result) : null);
                            };
                            getRequest.onerror = () => resolve(null);
                        } catch (error) {
                            resolve(null);
                        }
                    };
                    request.onerror = () => resolve(null);
                });
            }
            
            // Ø¹Ø±Ø¶ ØªØ­Ø°ÙŠØ± Ø¹Ø¯Ù… Ø§Ù„ØªØ²Ø§Ù…Ù† Ù…Ø¹ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø¥ØµÙ„Ø§Ø­
            showDataSyncWarning(currentCount, backupCount) {
                if (window.app && app.showToast) {
                    app.showToast(
                        `âš ï¸ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ø®ØªÙ„Ø§Ù ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!\nØ§Ù„Ø­Ø§Ù„ÙŠ: ${currentCount} Ø¹Ø¶Ùˆ\nØ§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©: ${backupCount} Ø¹Ø¶Ùˆ\nÙŠÙÙ†ØµØ­ Ø¨Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª`, 
                        'warning'
                    );
                }
                
                // Ø¥ØµÙ„Ø§Ø­ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                this.autoFixDataSync(currentCount, backupCount);
            }
            
            // Ø¥ØµÙ„Ø§Ø­ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            autoFixDataSync(currentCount, backupCount) {
                try {
                    console.log('ğŸ”§ Ø¨Ø¯Ø¡ Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...');
                    
                    // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù…ØµØ§Ø¯Ø± Ù…ØªØ¹Ø¯Ø¯Ø© Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    const sources = this.analyzeAllDataSources();
                    
                    // Ø§Ø®ØªÙŠØ§Ø± Ø£ÙØ¶Ù„ Ù…ØµØ¯Ø± Ø¨ÙŠØ§Ù†Ø§Øª
                    const bestSource = this.selectBestDataSource(sources);
                    
                    if (bestSource && bestSource.data) {
                        console.log(`âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ù…ØµØ¯Ø±: ${bestSource.source} (${bestSource.familyCount} Ø¹Ø¶Ùˆ)`);
                        
                        // Ù…Ø²Ø§Ù…Ù†Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØµØ§Ø¯Ø± Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙØ¶Ù„
                        this.data = bestSource.data;
                        this.saveData();
                        this.createBackup();
                        
                        // Ø¥Ø´Ø¹Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¥ØµÙ„Ø§Ø­
                        if (window.app && app.showToast) {
                            app.showToast(
                                `âœ… ØªÙ… Ø¥ØµÙ„Ø§Ø­ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹!\nØªÙ… Ø§Ø³ØªØ±Ø¬Ø§Ø¹ ${bestSource.familyCount} Ø¹Ø¶Ùˆ Ø¹Ø§Ø¦Ù„Ø©`,
                                'success'
                            );
                        }
                        
                        console.log('âœ… ØªÙ… Ø¥ØµÙ„Ø§Ø­ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
                        return true;
                    } else {
                        console.log('âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ù„Ø­Ø© Ù„Ù„Ø¥ØµÙ„Ø§Ø­');
                        return false;
                    }
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ:', error);
                    return false;
                }
            }
            
            // ØªØ­Ù„ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
            analyzeAllDataSources() {
                const sources = [];
                
                // ÙØ­Øµ localStorage
                ['saedan_family_data', 'family_data_backup', 'family_data_sync'].forEach(key => {
                    const data = this.getDataFromStorage('localStorage', key);
                    if (data) {
                        sources.push({
                            source: `localStorage:${key}`,
                            data: data,
                            familyCount: data.familyMembers ? data.familyMembers.length : 0,
                            lastUpdated: data.lastUpdated || new Date(0).toISOString()
                        });
                    }
                });
                
                // ÙØ­Øµ sessionStorage
                ['saedan_family_data', 'family_data_backup', 'family_data_sync'].forEach(key => {
                    const data = this.getDataFromStorage('sessionStorage', key);
                    if (data) {
                        sources.push({
                            source: `sessionStorage:${key}`,
                            data: data,
                            familyCount: data.familyMembers ? data.familyMembers.length : 0,
                            lastUpdated: data.lastUpdated || new Date(0).toISOString()
                        });
                    }
                });
                
                console.log(`ğŸ“Š ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${sources.length} Ù…ØµØ¯Ø± Ø¨ÙŠØ§Ù†Ø§Øª`);
                sources.forEach(source => {
                    console.log(`   - ${source.source}: ${source.familyCount} Ø¹Ø¶Ùˆ (Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${new Date(source.lastUpdated).toLocaleString('ar-SA')})`);
                });
                
                return sources;
            }
            
            // Ø§Ø®ØªÙŠØ§Ø± Ø£ÙØ¶Ù„ Ù…ØµØ¯Ø± Ø¨ÙŠØ§Ù†Ø§Øª
            selectBestDataSource(sources) {
                if (sources.length === 0) return null;
                
                // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…ØµØ§Ø¯Ø± Ø­Ø³Ø¨ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©
                sources.sort((a, b) => {
                    // Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ø¹Ø¯Ø¯ Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©
                    if (a.familyCount !== b.familyCount) {
                        return b.familyCount - a.familyCount;
                    }
                    
                    // Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«
                    return new Date(b.lastUpdated) - new Date(a.lastUpdated);
                });
                
                return sources[0];
            }
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…ØµØ¯Ø± ØªØ®Ø²ÙŠÙ† Ù…Ø­Ø¯Ø¯
            getDataFromStorage(storageType, key) {
                try {
                    const storage = storageType === 'localStorage' ? localStorage : sessionStorage;
                    const dataStr = storage.getItem(key);
                    if (dataStr) {
                        const parsed = JSON.parse(dataStr);
                        // Ø¯Ø¹Ù… Ù‡ÙŠØ§ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ©
                        return parsed.data || parsed;
                    }
                } catch (error) {
                    console.warn(`âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© ${storageType}.${key}:`, error.message);
                }
                return null;
            }

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            resetToEmpty() {
                this.data = {
                    familyMembers: [],
                    events: [],
                    suggestions: [],
                    library: [],
                    lastUpdated: new Date().toISOString(),
                    version: 1
                };
                
                // Ù…Ø³Ø­ LocalStorage
                localStorage.removeItem(this.storageKey);
                
                console.log('ğŸ”„ ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø­Ø§Ù„Ø© ÙØ§Ø±ØºØ©');
            }

            // ØªØ­Ø¯ÙŠØ« Ù…Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø£Ø·ÙØ§Ù„ Ù„ÙƒÙ„ Ø¹Ø¶Ùˆ
            updateChildrenReferences() {
                this.data.familyMembers.forEach(member => {
                    member.children = this.data.familyMembers
                        .filter(child => child.father_id === member.id)
                        .map(child => child.id);
                });
            }

            generateId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            }

            getData(category) {
                return this.data[category] || [];
            }

            addItem(category, item) {
                if (!this.data[category]) {
                    this.data[category] = [];
                }
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¬ÙŠÙ„ Ù„Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø¯
                if (category === 'familyMembers') {
                    item.generation = this.calculateGeneration(item.father_id);
                    item.id = item.id || this.generateId();
                    item.created_at = item.created_at || new Date().toISOString();
                }
                
                const newItem = {
                    ...item,
                    id: item.id || this.generateId(),
                    created_at: item.created_at || new Date().toISOString()
                };
                
                this.data[category].push(newItem);
                
                // ØªØ­Ø¯ÙŠØ« Ù…Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø£Ø·ÙØ§Ù„ Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©
                if (category === 'familyMembers') {
                    this.updateChildrenReferences();
                }
                
                this.saveData();
                return newItem;
            }

            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¬ÙŠÙ„ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ§Ù„Ø¯
            calculateGeneration(fatherId) {
                if (!fatherId) return 1; // Ø§Ù„Ù…Ø¤Ø³Ø³
                
                const father = this.data.familyMembers.find(m => m.id === fatherId);
                return father ? (father.generation + 1) : 1;
            }

            updateItem(category, id, updates) {
                const items = this.data[category];
                const index = items.findIndex(item => item.id === id);
                
                if (index !== -1) {
                    // Ø¥Ø°Ø§ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ù„Ø¯ØŒ Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¬ÙŠÙ„
                    if (category === 'familyMembers' && updates.father_id !== undefined) {
                        updates.generation = this.calculateGeneration(updates.father_id);
                    }
                    
                    items[index] = { 
                        ...items[index], 
                        ...updates,
                        updated_at: new Date().toISOString()
                    };
                    
                    // ØªØ­Ø¯ÙŠØ« Ù…Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø£Ø·ÙØ§Ù„ Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©
                    if (category === 'familyMembers') {
                        this.updateChildrenReferences();
                    }
                    
                    this.saveData();
                    return items[index];
                }
                return null;
            }

            deleteItem(category, id) {
                const items = this.data[category];
                const index = items.findIndex(item => item.id === id);
                
                if (index !== -1) {
                    // Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø£Ø·ÙØ§Ù„
                    if (category === 'familyMembers') {
                        const hasChildren = this.data.familyMembers.some(m => m.father_id === id);
                        if (hasChildren) {
                            throw new Error('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø¹Ø¶Ùˆ Ù„Ø¯ÙŠÙ‡ Ø£Ø·ÙØ§Ù„. Ø§Ø­Ø°Ù Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø£ÙˆÙ„Ø§Ù‹.');
                        }
                    }
                    
                    const deletedItem = items.splice(index, 1)[0];
                    
                    // ØªØ­Ø¯ÙŠØ« Ù…Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø£Ø·ÙØ§Ù„ Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©
                    if (category === 'familyMembers') {
                        this.updateChildrenReferences();
                    }
                    
                    this.saveData();
                    return deletedItem;
                }
                return null;
            }

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ©
            loadSampleData() {
                // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                this.data = {
                    familyMembers: [...SAMPLE_FAMILY_DATA.familyMembers],
                    events: [...SAMPLE_FAMILY_DATA.events],
                    suggestions: [...SAMPLE_FAMILY_DATA.suggestions],
                    library: [...SAMPLE_FAMILY_DATA.library]
                };
                
                this.updateChildrenReferences();
                this.saveData();
                
                // ØªØ£ÙƒÙŠØ¯ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ
                const secondGenMembers = this.data.familyMembers.filter(m => m.generation === 2);
                console.log('ğŸ“Š ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ© Ù…ÙƒØªÙ…Ù„:');
                console.log(`   - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: ${this.data.familyMembers.length}`);
                console.log(`   - Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„: ${this.data.familyMembers.filter(m => m.generation === 1).length} Ø£Ø¹Ø¶Ø§Ø¡`);
                console.log(`   - Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ: ${secondGenMembers.length} Ø£Ø¹Ø¶Ø§Ø¡`);
                console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­ Ù…Ø¹ Ø±Ø¨Ø· Ø§Ù„Ø£Ø¬ÙŠØ§Ù„');
                
                // Ø¹Ø±Ø¶ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ Ù„Ù„ØªØ£ÙƒÙŠØ¯
                console.log('ğŸ‘¥ Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ:');
                secondGenMembers.forEach((member, index) => {
                    console.log(`   ${index + 1}. ${member.full_name}`);
                });
                
                // Ø¥Ø´Ø¹Ø§Ù„ Ø­Ø¯Ø« ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                window.dispatchEvent(new CustomEvent('sampleDataLoaded', { 
                    detail: { 
                        totalMembers: this.data.familyMembers.length,
                        secondGeneration: secondGenMembers.length
                    } 
                }));
            }

            // Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ø£Ø®Ø±Ù‰
            setupStorageSync() {
                window.addEventListener('storage', (e) => {
                    if (e.key === this.storageKey) {
                        this.data = this.loadData();
                        window.dispatchEvent(new CustomEvent('dataUpdated', { detail: this.data }));
                    }
                });
            }

            // Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ÙÙ„ØªØ±Ø©
            searchItems(category, query, filters = {}) {
                let items = this.getData(category);

                // Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù†ØµÙŠ
                if (query) {
                    const searchTerms = query.toLowerCase().split(' ');
                    items = items.filter(item => 
                        searchTerms.every(term =>
                            Object.values(item).some(value =>
                                value && value.toString().toLowerCase().includes(term)
                            )
                        )
                    );
                }

                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±
                Object.keys(filters).forEach(key => {
                    if (filters[key]) {
                        items = items.filter(item => item[key] === filters[key]);
                    }
                });

                return items;
            }
        }

        // Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø§Ù„Ù…Ø­Ø³Ù†
        class EnhancedAlSaedanApp {
            constructor() {
                this.dataManager = new EnhancedDataManager();
                this.userManager = new UserManager();
                this.charts = {};
                this.init();
            }

            init() {
                this.updateAuthUI();
                this.createModals();
                this.displayHomeStatistics();
                this.displayFamilyTree();
                this.displayEvents();
                this.displaySuggestions();
                this.displayLibrary();
                this.displayProfile();
                this.displayAdminPanel();
                this.initializeCharts();
                this.setupEventListeners();
                console.log('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ Ø§Ù„Ù…Ø­Ø³Ù† Ø¨Ù†Ø¬Ø§Ø­');
            }

            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
            updateAuthUI() {
                const isLoggedIn = this.userManager.currentUser !== null;
                const isAdmin = this.userManager.currentUser?.role === 'admin';

                // Ø¹Ù†Ø§ØµØ± Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨
                const mainNavigation = document.getElementById('mainNavigation');
                const userProfileMenu = document.getElementById('userProfileMenuDesktop');
                const authButtons = document.getElementById('authButtonsDesktop');
                const adminButton = document.getElementById('nav-admin-desktop');
                const currentUserName = document.getElementById('currentUserNameDesktop');

                // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¬ÙˆØ§Ù„
                const mainNavigationMobile = document.getElementById('mainNavigationMobile');
                const userMenuMobile = document.getElementById('userMenuMobile');
                const authButtonsMobile = document.getElementById('authButtonsMobile');
                const adminButtonMobile = document.getElementById('nav-admin-mobile');
                const currentUserNameMobile = document.getElementById('currentUserNameMobile');

                if (isLoggedIn) {
                    // Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨
                    if (mainNavigation) mainNavigation.classList.remove('hidden');
                    if (userProfileMenu) userProfileMenu.classList.remove('hidden');
                    if (authButtons) authButtons.classList.add('hidden');
                    
                    // Ø§Ù„Ø¬ÙˆØ§Ù„
                    if (mainNavigationMobile) mainNavigationMobile.classList.remove('hidden');
                    if (userMenuMobile) userMenuMobile.classList.remove('hidden');
                    if (authButtonsMobile) authButtonsMobile.classList.add('hidden');
                    
                    // ØªØ­Ø¯ÙŠØ« Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                    const userName = this.userManager.currentUser.first_name || this.userManager.currentUser.full_name || 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…';
                    if (currentUserName) {
                        currentUserName.textContent = userName;
                    }
                    if (currentUserNameMobile) {
                        currentUserNameMobile.textContent = `${userName} - Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ`;
                    }
                    
                    // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
                    if (typeof updateProfileDisplay === 'function') {
                        setTimeout(updateProfileDisplay, 100);
                    }
                    
                    // Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù„Ù…Ø¯ÙŠØ±ÙŠÙ†
                    if (isAdmin) {
                        if (adminButton) adminButton.classList.remove('hidden');
                        if (adminButtonMobile) adminButtonMobile.classList.remove('hidden');
                        
                        // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
                        this.updatePendingBadges();
                    } else {
                        if (adminButton) adminButton.classList.add('hidden');
                        if (adminButtonMobile) adminButtonMobile.classList.add('hidden');
                    }
                } else {
                    // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ - Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¹Ø§Ù…Ø© ÙˆØ¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø­Ù…ÙŠØ© ÙÙ‚Ø·
                    // Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨
                    if (mainNavigation) mainNavigation.classList.remove('hidden'); // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¹Ø§Ù…Ø©
                    if (userProfileMenu) userProfileMenu.classList.add('hidden');
                    if (authButtons) authButtons.classList.remove('hidden');
                    if (adminButton) adminButton.classList.add('hidden');
                    
                    // Ø§Ù„Ø¬ÙˆØ§Ù„
                    if (mainNavigationMobile) mainNavigationMobile.classList.remove('hidden'); // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¹Ø§Ù…Ø©
                    if (userMenuMobile) userMenuMobile.classList.add('hidden');
                    if (authButtonsMobile) authButtonsMobile.classList.remove('hidden');
                    if (adminButtonMobile) adminButtonMobile.classList.add('hidden');
                }
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
            displayProfile() {
                const container = document.getElementById('profileContent');
                if (!container) return;

                const user = this.userManager.currentUser;
                if (!user) {
                    container.innerHTML = `
                        <div class="text-center py-12">
                            <div class="text-6xl text-white mb-4 opacity-50">
                                <i class="fas fa-user-slash"></i>
                            </div>
                            <p class="text-white text-xl mb-4">ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹</p>
                        </div>
                    `;
                    return;
                }

                const statusBadge = user.status === 'active' ? 
                    '<span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">Ù…ÙØ¹Ù„</span>' :
                    '<span class="px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm font-medium">ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªÙØ¹ÙŠÙ„</span>';

                const roleBadge = user.role === 'admin' ?
                    '<span class="px-3 py-1 bg-red-100 text-red-800 rounded-full text-sm font-medium">ğŸ‘‘ Ù…Ø¯ÙŠØ±</span>' :
                    '<span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">ğŸ‘¤ Ø¹Ø¶Ùˆ</span>';

                container.innerHTML = `
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center space-x-4 rtl:space-x-reverse">
                                <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-2xl font-bold">
                                    ${user.first_name.charAt(0)}${user.last_name.charAt(0)}
                                </div>
                                <div>
                                    <h3 class="text-2xl font-bold text-gray-800">${user.full_name}</h3>
                                    <div class="flex items-center space-x-2 rtl:space-x-reverse mt-2">
                                        ${statusBadge}
                                        ${roleBadge}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© -->
                            <div class="space-y-4">
                                <h4 class="text-lg font-semibold text-gray-800 border-b border-gray-200 pb-2">
                                    <i class="fas fa-user ml-2 text-blue-600"></i>Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©
                                </h4>
                                <div class="space-y-3 text-sm">
                                    <div class="flex justify-between">
                                        <span class="font-medium text-gray-600">Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©:</span>
                                        <span class="text-gray-800">${user.national_id}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="font-medium text-gray-600">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯:</span>
                                        <span class="text-gray-800">${user.birth_date ? new Date(user.birth_date).toLocaleDateString('ar-SA') : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="font-medium text-gray-600">Ù…ÙƒØ§Ù† Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯:</span>
                                        <span class="text-gray-800">${user.birth_place || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                    </div>
                                    ${user.generation ? `
                                        <div class="flex justify-between">
                                            <span class="font-medium text-gray-600">Ø§Ù„Ø¬ÙŠÙ„:</span>
                                            <span class="text-gray-800">Ø§Ù„Ø¬ÙŠÙ„ ${user.generation}</span>
                                        </div>
                                    ` : ''}
                                </div>
                            </div>

                            <!-- Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù‡Ù†ÙŠØ© -->
                            <div class="space-y-4">
                                <h4 class="text-lg font-semibold text-gray-800 border-b border-gray-200 pb-2">
                                    <i class="fas fa-briefcase ml-2 text-green-600"></i>Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù‡Ù†ÙŠØ©
                                </h4>
                                <div class="space-y-3 text-sm">
                                    <div class="flex justify-between">
                                        <span class="font-medium text-gray-600">Ø§Ù„Ù…Ù‡Ù†Ø©:</span>
                                        <span class="text-gray-800">${user.profession || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="font-medium text-gray-600">Ø§Ù„ØªØ®ØµØµ:</span>
                                        <span class="text-gray-800">${user.specialization || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ -->
                            <div class="space-y-4">
                                <h4 class="text-lg font-semibold text-gray-800 border-b border-gray-200 pb-2">
                                    <i class="fas fa-phone ml-2 text-teal-600"></i>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„
                                </h4>
                                <div class="space-y-3 text-sm">
                                    <div class="flex justify-between">
                                        <span class="font-medium text-gray-600">Ø§Ù„Ø¬ÙˆØ§Ù„:</span>
                                        <span class="text-gray-800">${user.phone || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="font-medium text-gray-600">Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„:</span>
                                        <span class="text-gray-800">${user.email || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Ø§Ù„Ù‡ÙˆØ§ÙŠØ§Øª -->
                            <div class="space-y-4">
                                <h4 class="text-lg font-semibold text-gray-800 border-b border-gray-200 pb-2">
                                    <i class="fas fa-heart ml-2 text-rose-600"></i>Ø§Ù„Ù‡ÙˆØ§ÙŠØ§Øª ÙˆØ§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª
                                </h4>
                                <p class="text-sm text-gray-700">${user.hobbies || 'Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ù‡ÙˆØ§ÙŠØ§Øª'}</p>
                            </div>
                        </div>

                        <!-- ØªÙˆØ§Ø±ÙŠØ® Ù…Ù‡Ù…Ø© -->
                        <div class="mt-6 pt-6 border-t border-gray-200">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-xs text-gray-500">
                                <div>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„: ${new Date(user.created_at).toLocaleDateString('ar-SA')}</div>
                                ${user.approved_at ? `<div>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙØ¹ÙŠÙ„: ${new Date(user.approved_at).toLocaleDateString('ar-SA')}</div>` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }

            // Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
            displayAdminPanel() {
                if (!this.userManager.currentUser || this.userManager.currentUser.role !== 'admin') {
                    return;
                }

                const pendingContainer = document.getElementById('pendingUsersGrid');
                const activeUsersCount = document.getElementById('activeUsersCount');
                const pendingUsersCount = document.getElementById('pendingUsersCount');
                const totalUsersCount = document.getElementById('totalUsersCount');

                if (!pendingContainer) return;

                const pendingUsers = this.userManager.getPendingUsers();
                const activeUsers = this.userManager.getActiveUsers();
                const totalUsers = this.userManager.users.length;

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                if (activeUsersCount) activeUsersCount.textContent = activeUsers.length;
                if (pendingUsersCount) pendingUsersCount.textContent = pendingUsers.length;
                if (totalUsersCount) totalUsersCount.textContent = totalUsers;

                // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø¹Ù„Ù‚ÙŠÙ†
                if (pendingUsers.length === 0) {
                    pendingContainer.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-check-circle text-4xl mb-2"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ù…Ø¹Ù„Ù‚Ø©</p>
                        </div>
                    `;
                    return;
                }

                pendingContainer.innerHTML = pendingUsers.map(user => `
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800">${user.full_name}</h4>
                                <div class="mt-2 space-y-1 text-sm text-gray-600">
                                    <div>ğŸ“§ ${user.email}</div>
                                    <div>ğŸ“± ${user.phone}</div>
                                    <div>ğŸ†” ${user.national_id}</div>
                                    <div>ğŸ’¼ ${user.profession} - ${user.specialization}</div>
                                    <div>ğŸ“… ${new Date(user.created_at).toLocaleDateString('ar-SA')}</div>
                                </div>
                                ${user.hobbies ? `
                                    <div class="mt-2 p-2 bg-blue-50 rounded text-xs">
                                        <strong>Ø§Ù„Ù‡ÙˆØ§ÙŠØ§Øª:</strong> ${user.hobbies}
                                    </div>
                                ` : ''}
                            </div>
                            <div class="flex flex-col space-y-2 mr-4">
                                <button onclick="approveUser('${user.id}')" class="px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700">
                                    <i class="fas fa-check ml-1"></i>Ù…ÙˆØ§ÙÙ‚Ø©
                                </button>
                                <button onclick="rejectUser('${user.id}')" class="px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700">
                                    <i class="fas fa-times ml-1"></i>Ø±ÙØ¶
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            setupEventListeners() {
                // Ù…Ø³ØªÙ…Ø¹ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                window.addEventListener('dataUpdated', () => {
                    this.refreshAllSections();
                });

                // Ù…Ø³ØªÙ…Ø¹ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ©
                window.addEventListener('sampleDataLoaded', (event) => {
                    const { totalMembers, secondGeneration } = event.detail;
                    console.log(`ğŸ‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ© Ù…Ø­Ù…Ù„Ø©: ${totalMembers} Ø£Ø¹Ø¶Ø§Ø¡ØŒ ${secondGeneration} ÙÙŠ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ`);
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ
                    const members = this.dataManager.getData('familyMembers');
                    const secondGenData = members.filter(m => m.generation === 2);
                    console.log('ğŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ù…Ø³ØªØ±Ø¬Ø¹:');
                    secondGenData.forEach(member => {
                        console.log(`   âœ“ ${member.full_name} - Ø¬ÙŠÙ„ ${member.generation} - ÙˆØ§Ù„Ø¯: ${member.father_id}`);
                    });
                });

                // Ù…Ø³ØªÙ…Ø¹ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©
                const familyForm = document.getElementById('familyForm');
                if (familyForm) {
                    familyForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        this.saveFamilyMember();
                    });
                }

                // Ù…Ø³ØªÙ…Ø¹ Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                const loginForm = document.getElementById('loginForm');
                if (loginForm) {
                    loginForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        this.handleLogin();
                    });
                }

                // Ù…Ø³ØªÙ…Ø¹ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                const registerForm = document.getElementById('registerForm');
                if (registerForm) {
                    registerForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        this.handleRegister();
                    });
                }

                // Ù…Ø³ØªÙ…Ø¹ Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ø¶Ùˆ (Ù„Ù„Ø£Ø¯Ù…Ù†)
                const memberEditForm = document.getElementById('memberEditForm');
                if (memberEditForm) {
                    memberEditForm.addEventListener('submit', saveMemberChanges);
                }

                // Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ø­Ø³Ù†
                this.setupFormFieldListeners();
                this.setupRegisterFormListeners();
            }

            setupFormFieldListeners() {
                // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„
                const nameFields = ['familyFirstName', 'familyMiddleName', 'familyLastName'];
                nameFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if (field) {
                        field.addEventListener('input', this.updateFullNamePreview.bind(this));
                    }
                });

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬ÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙˆØ§Ù„Ø¯
                const fatherSelect = document.getElementById('familyFatherId');
                if (fatherSelect) {
                    fatherSelect.addEventListener('change', this.updateGenerationDisplay.bind(this));
                }
            }

            updateFullNamePreview() {
                const firstName = document.getElementById('familyFirstName')?.value.trim() || '';
                const middleName = document.getElementById('familyMiddleName')?.value.trim() || '';
                const lastName = document.getElementById('familyLastName')?.value.trim() || '';
                
                let fullName = firstName;
                if (middleName) fullName += ` ${middleName}`;
                if (lastName) fullName += ` ${lastName}`;
                
                const preview = document.getElementById('fullNamePreview');
                if (preview) {
                    preview.textContent = fullName || 'Ø³ÙŠØªÙ… ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø§Ø³Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹...';
                }
            }

            updateGenerationDisplay() {
                const fatherSelect = document.getElementById('familyFatherId');
                const generationDisplay = document.getElementById('familyCurrentGeneration');
                
                if (!fatherSelect || !generationDisplay) return;

                const fatherId = fatherSelect.value;
                let generation = 1; // Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ù…Ø¤Ø³Ø³

                if (fatherId) {
                    const father = this.dataManager.getData('familyMembers').find(m => m.id === fatherId);
                    generation = father ? (father.generation + 1) : 1;
                }

                generationDisplay.value = `Ø§Ù„Ø¬ÙŠÙ„ ${generation} ${generation === 1 ? '(Ù…Ø¤Ø³Ø³)' : generation === 2 ? '(Ø£Ø·ÙØ§Ù„ Ø§Ù„Ù…Ø¤Ø³Ø³)' : '(Ø£Ø­ÙØ§Ø¯)'}`;
            }

            // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹Ø§Øª Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
            setupRegisterFormListeners() {
                // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„
                const nameFields = ['registerFirstName', 'registerMiddleName', 'registerLastName'];
                nameFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if (field) {
                        field.addEventListener('input', updateRegisterFullNamePreview);
                    }
                });

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙˆØ§Ù„Ø¯
                const fatherSelect = document.getElementById('registerFatherId');
                if (fatherSelect) {
                    fatherSelect.addEventListener('change', this.updateRegisterGeneration.bind(this));
                }
            }

            updateRegisterGeneration() {
                const fatherSelect = document.getElementById('registerFatherId');
                const generationDisplay = document.getElementById('registerExpectedGeneration');
                
                if (!fatherSelect || !generationDisplay) return;

                const fatherId = fatherSelect.value;
                let generation = 1; // Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ù…Ø¤Ø³Ø³

                if (fatherId) {
                    const father = this.dataManager.getData('familyMembers').find(m => m.id === fatherId);
                    generation = father ? (father.generation + 1) : 1;
                }

                generationDisplay.value = `Ø§Ù„Ø¬ÙŠÙ„ ${generation} ${generation === 1 ? '(Ù…Ø¤Ø³Ø³)' : generation === 2 ? '(Ø£Ø·ÙØ§Ù„ Ø§Ù„Ù…Ø¤Ø³Ø³)' : '(Ø£Ø­ÙØ§Ø¯)'}`;
            }

            populateRegisterParentSelect() {
                const select = document.getElementById('registerFatherId');
                if (!select) return;

                select.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„ÙˆØ§Ù„Ø¯ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) --</option>';
                
                const maleMembers = this.dataManager.getData('familyMembers').filter(m => m.gender === 'male');
                
                // ØªØ¬Ù…ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„
                const generations = {};
                maleMembers.forEach(member => {
                    const gen = member.generation || 1;
                    if (!generations[gen]) generations[gen] = [];
                    generations[gen].push(member);
                });
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù…Ø¬Ù…ÙˆØ¹Ø© Ø­Ø³Ø¨ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„
                Object.keys(generations).sort((a, b) => parseInt(a) - parseInt(b)).forEach(genNum => {
                    const genGroup = document.createElement('optgroup');
                    genGroup.label = `${genNum == '1' ? 'Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¤Ø³Ø³' : 'Ø§Ù„Ø¬ÙŠÙ„ ' + genNum}`;
                    
                    generations[genNum].forEach(member => {
                        const option = document.createElement('option');
                        option.value = member.id;
                        option.textContent = member.full_name;
                        genGroup.appendChild(option);
                    });
                    
                    select.appendChild(genGroup);
                });
            }

            // Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            handleLogin() {
                const identifier = document.getElementById('loginIdentifier').value.trim();
                const password = document.getElementById('loginPassword').value.trim();

                if (!identifier || !password) {
                    this.showToast('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', 'error');
                    return;
                }

                try {
                    const user = this.userManager.login(identifier, password);
                    this.showToast(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${user.first_name}! ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­`, 'success');
                    
                    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ø­Ø³Ù†Ø©
                    hideLoginModal(); // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ø®ØµØµØ© Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙƒØ§Ù…Ù„
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    this.updateAuthUI();
                    this.refreshAllSections(); // Ø¥Ø¶Ø§ÙØ© ØªØ­Ø¯ÙŠØ« Ø´Ø§Ù…Ù„
                    showSection('home');
                } catch (error) {
                    this.showToast('Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: ' + error.message, 'error');
                }
            }

            // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯
            handleRegister() {
                // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const firstName = document.getElementById('registerFirstName').value.trim();
                const middleName = document.getElementById('registerMiddleName').value.trim();
                const lastName = document.getElementById('registerLastName').value.trim();
                const nationalId = document.getElementById('registerNationalId').value.trim();
                const birthDate = document.getElementById('registerBirthDate').value;
                const birthPlace = document.getElementById('registerBirthPlace').value.trim();
                const fatherId = document.getElementById('registerFatherId').value || null;
                const profession = document.getElementById('registerProfession').value.trim();
                const specialization = document.getElementById('registerSpecialization').value.trim();
                const phone = document.getElementById('registerPhone').value.trim();
                const email = document.getElementById('registerEmail').value.trim();
                const hobbies = document.getElementById('registerHobbies').value.trim();
                const password = document.getElementById('registerPassword').value.trim();
                const passwordConfirm = document.getElementById('registerPasswordConfirm').value.trim();
                const agree = document.getElementById('registerAgree').checked;

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                if (!firstName || !middleName || !lastName || !nationalId || !birthDate || !birthPlace || 
                    !profession || !specialization || !phone || !email || !hobbies || !password || !passwordConfirm) {
                    this.showToast('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                    return;
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ·Ø§Ø¨Ù‚ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±
                if (password !== passwordConfirm) {
                    this.showToast('ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©', 'error');
                    return;
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø·ÙˆÙ„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
                if (password.length < 8) {
                    this.showToast('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
                    return;
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©
                if (!/^[1-2][0-9]{9}$/.test(nationalId)) {
                    this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡ÙˆÙŠØ© ØµØ­ÙŠØ­ (10 Ø£Ø±Ù‚Ø§Ù…)', 'error');
                    return;
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„
                if (!/^05\d{8}$/.test(phone)) {
                    this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø¬ÙˆØ§Ù„ ØµØ­ÙŠØ­ Ø¨ØµÙŠØºØ© 05xxxxxxxx', 'error');
                    return;
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
                if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                    this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØµØ­ÙŠØ­', 'error');
                    return;
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ·
                if (!agree) {
                    this.showToast('ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…', 'error');
                    return;
                }

                // Ø¥Ù†Ø´Ø§Ø¡ ÙƒØ§Ø¦Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const userData = {
                    first_name: firstName,
                    middle_name: middleName,
                    last_name: lastName,
                    full_name: `${firstName} ${middleName} ${lastName}`,
                    national_id: nationalId,
                    birth_date: birthDate,
                    birth_place: birthPlace,
                    father_id: fatherId,
                    generation: fatherId ? this.dataManager.calculateGeneration(fatherId) : 1,
                    profession: profession,
                    specialization: specialization,
                    phone: phone,
                    email: email,
                    hobbies: hobbies,
                    password: password
                };

                try {
                    const newUser = this.userManager.registerUser(userData);
                    this.showToast(`ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨Ùƒ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.`, 'success');
                    
                    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ø­Ø³Ù†Ø©
                    hideRegisterModal(); // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ø®ØµØµØ© Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙƒØ§Ù…Ù„
                    
                    // ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ Ø£Ø¯Ù…Ù†
                    if (this.userManager.currentUser && this.userManager.currentUser.role === 'admin') {
                        this.displayAdminPanel(); // ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
                        this.refreshAllSections();
                    }
                    
                } catch (error) {
                    this.showToast('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„: ' + error.message, 'error');
                }
            }

            refreshAllSections() {
                this.displayHomeStatistics();
                this.displayFamilyTree();
                this.displayEvents();
                this.displaySuggestions();
                this.displayLibrary();
                this.updateCharts();
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            displayHomeStatistics() {
                const stats = {
                    members: this.dataManager.getData('familyMembers').length,
                    events: this.dataManager.getData('events').length,
                    suggestions: this.dataManager.getData('suggestions').length,
                    library: this.dataManager.getData('library').length
                };

                // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¥Ø¶Ø§ÙÙŠØ©
                const familyMembers = this.dataManager.getData('familyMembers');
                const generations = new Set(familyMembers.map(m => m.generation || 1)).size;
                const boardMembers = familyMembers.filter(m => 
                    ['founder', 'chairman', 'board_member'].includes(m.membership_type)
                ).length;
                
                const events = this.dataManager.getData('events');
                const activeEvents = events.filter(e => e.status === 'upcoming').length;
                
                const suggestions = this.dataManager.getData('suggestions');
                const approvedSuggestions = suggestions.filter(s => s.status === 'approved').length;

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª
                this.updateCounter('total-members', stats.members);
                this.updateCounter('total-events', stats.events);
                this.updateCounter('total-suggestions', stats.suggestions);
                this.updateCounter('total-library', stats.library);
                this.updateCounter('total-generations', generations);
                this.updateCounter('board-members', boardMembers);
                this.updateCounter('active-events', activeEvents);
                this.updateCounter('approved-suggestions', approvedSuggestions);
            }

            updateCounter(id, value) {
                const element = document.getElementById(id);
                if (element) {
                    // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªØµØ§Ø¹Ø¯ÙŠ
                    const current = parseInt(element.textContent) || 0;
                    const increment = Math.ceil((value - current) / 10);
                    let counter = current;
                    
                    const timer = setInterval(() => {
                        counter += increment;
                        if (counter >= value) {
                            counter = value;
                            clearInterval(timer);
                        }
                        element.textContent = counter;
                    }, 50);
                }
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ© Ø§Ù„Ù…Ø­Ø³Ù†Ø©
            displayFamilyTree() {
                const familyMembers = this.dataManager.getData('familyMembers');
                const container = document.getElementById('family-tree');
                if (!container) return;

                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                this.updateDataStatus(familyMembers);

                if (familyMembers.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-12">
                            <div class="text-6xl text-white mb-4 opacity-50">
                                <i class="fas fa-sitemap"></i>
                            </div>
                            <p class="text-white text-xl mb-6">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø´Ø¬Ø±Ø© Ø¹Ø§Ø¦Ù„ÙŠØ©</p>
                            <button onclick="loadSampleData()" class="bg-amber-600 text-white px-8 py-4 rounded-lg hover:bg-amber-700 text-lg">
                                <i class="fas fa-database ml-2"></i>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                            </button>
                        </div>
                    `;
                    return;
                }

                // ØªØ¬Ù…ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„
                const generations = {};
                familyMembers.forEach(member => {
                    const gen = member.generation || 1;
                    if (!generations[gen]) generations[gen] = [];
                    generations[gen].push(member);
                });

                // Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„
                container.innerHTML = Object.keys(generations)
                    .sort((a, b) => parseInt(a) - parseInt(b))
                    .map(gen => {
                        const genMembers = generations[gen];
                        const isFounderGen = gen == '1';
                        
                        return `
                            <div class="generation">
                                <div class="generation-header">
                                    <i class="fas ${isFounderGen ? 'fa-crown' : 'fa-users'} ml-2"></i>
                                    ${isFounderGen ? 'Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¤Ø³Ø³' : `Ø§Ù„Ø¬ÙŠÙ„ ${this.getGenerationName(gen)}`}
                                    <span class="bg-white text-blue-600 px-3 py-1 rounded-full mr-3 font-bold">
                                        ${genMembers.length} ${genMembers.length === 1 ? 'ÙØ±Ø¯' : 'Ø£ÙØ±Ø§Ø¯'}
                                    </span>
                                </div>
                                
                                ${genMembers.map(member => this.renderMemberCard(member, !isFounderGen)).join('')}
                            </div>
                        `;
                    }).join('');
            }

            renderMemberCard(member, showConnection = false) {
                const father = member.father_id ? 
                    this.dataManager.getData('familyMembers').find(m => m.id === member.father_id) : null;
                const spouse = member.spouse_id ? 
                    this.dataManager.getData('familyMembers').find(m => m.id === member.spouse_id) : null;
                const childrenCount = member.children ? member.children.length : 0;
                
                return `
                    <div class="member-card ${member.membership_type === 'founder' ? 'founder-card' : ''} ${showConnection ? 'connection-line' : ''}">
                        <div class="card p-6 relative group">
                            <div class="member-actions">
                                <button onclick="editFamilyMember('${member.id}')" class="edit-btn" title="ØªØ¹Ø¯ÙŠÙ„">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="deleteFamilyMember('${member.id}')" class="delete-btn" title="Ø­Ø°Ù">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="w-16 h-16 bg-gradient-to-br ${member.membership_type === 'founder' ? 'from-amber-400 to-orange-500' : 'from-blue-400 to-blue-600'} rounded-full flex items-center justify-center text-white text-xl font-bold mr-4 shadow-lg">
                                    ${member.full_name.charAt(0)}
                                </div>
                                <div class="flex-1">
                                    <h4 class="text-lg font-bold text-gray-800 mb-2">
                                        ${member.full_name}
                                        <span class="text-sm ${member.gender === 'male' ? 'text-blue-500' : 'text-pink-500'} mr-2">
                                            <i class="fas ${member.gender === 'male' ? 'fa-mars' : 'fa-venus'}"></i>
                                        </span>
                                    </h4>
                                    
                                    ${father ? `
                                        <p class="text-gray-600 text-sm mb-2">
                                            <i class="fas fa-arrow-up ml-2 text-blue-500"></i>
                                            ${member.gender === 'male' ? 'Ø§Ø¨Ù†' : 'Ø§Ø¨Ù†Ø©'} ${father.full_name}
                                        </p>
                                    ` : ''}
                                    
                                    ${spouse ? `
                                        <p class="text-purple-600 text-sm mb-2">
                                            <i class="fas fa-ring ml-2 text-purple-500"></i>
                                            ${member.gender === 'male' ? 'Ù…ØªØ²ÙˆØ¬ Ù…Ù†' : 'Ù…ØªØ²ÙˆØ¬Ø© Ù…Ù†'} ${spouse.full_name}
                                        </p>
                                    ` : ''}
                                    
                                    <span class="inline-block px-3 py-1 text-xs rounded-full ${this.getMembershipTypeColor(member.membership_type)} mb-2">
                                        ${this.getMembershipTypeText(member.membership_type)}
                                    </span>
                                    
                                    ${childrenCount > 0 ? `
                                        <p class="text-green-600 text-sm mb-2">
                                            <i class="fas fa-arrow-down ml-2"></i>
                                            ${childrenCount} ${childrenCount === 1 ? 'Ø·ÙÙ„' : 'Ø£Ø·ÙØ§Ù„'}
                                        </p>
                                    ` : ''}
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2 text-xs text-gray-500 mt-3">
                                        ${member.birth_date ? `<div><i class="fas fa-birthday-cake ml-2 text-pink-500"></i>${new Date(member.birth_date).toLocaleDateString('ar-SA')}</div>` : ''}
                                        ${member.birth_place ? `<div><i class="fas fa-map-marker-alt ml-2 text-red-500"></i>${member.birth_place}</div>` : ''}
                                        ${member.profession ? `<div><i class="fas fa-briefcase ml-2 text-blue-500"></i>${member.profession}</div>` : ''}
                                        ${member.specialization ? `<div><i class="fas fa-graduation-cap ml-2 text-green-500"></i>${member.specialization}</div>` : ''}
                                        ${member.phone ? `<div><i class="fas fa-phone ml-2 text-indigo-500"></i>${member.phone}</div>` : ''}
                                        ${member.email ? `<div><i class="fas fa-envelope ml-2 text-purple-500"></i>${member.email}</div>` : ''}
                                    </div>
                                    ${member.hobbies ? `
                                        <div class="mt-3 p-2 bg-gradient-to-r from-amber-50 to-orange-50 rounded-lg border border-amber-200">
                                            <div class="text-xs text-amber-700">
                                                <i class="fas fa-heart ml-2"></i>
                                                <strong>Ø§Ù„Ù‡ÙˆØ§ÙŠØ§Øª:</strong> ${member.hobbies}
                                            </div>
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            getGenerationName(genNum) {
                const names = {
                    '2': 'Ø§Ù„Ø«Ø§Ù†ÙŠ (Ø§Ù„Ø£Ø·ÙØ§Ù„)',
                    '3': 'Ø§Ù„Ø«Ø§Ù„Ø« (Ø§Ù„Ø£Ø­ÙØ§Ø¯)', 
                    '4': 'Ø§Ù„Ø±Ø§Ø¨Ø¹ (Ø£Ø·ÙØ§Ù„ Ø§Ù„Ø£Ø­ÙØ§Ø¯)',
                    '5': 'Ø§Ù„Ø®Ø§Ù…Ø³'
                };
                return names[genNum] || `Ø±Ù‚Ù… ${genNum}`;
            }

            // Ù…Ø³Ø§Ø¹Ø¯ Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©
            getMembershipTypeColor(type) {
                const colors = {
                    'founder': 'bg-amber-100 text-amber-700 border border-amber-200',
                    'chairman': 'bg-red-100 text-red-700 border border-red-200',
                    'board_member': 'bg-blue-100 text-blue-700 border border-blue-200',
                    'general_assembly': 'bg-green-100 text-green-700 border border-green-200',
                    'family_member': 'bg-gray-100 text-gray-700 border border-gray-200',
                    'honorary': 'bg-purple-100 text-purple-700 border border-purple-200'
                };
                return colors[type] || 'bg-gray-100 text-gray-700';
            }

            getMembershipTypeText(type) {
                const texts = {
                    'founder': 'ğŸ‘‘ Ø§Ù„Ù…Ø¤Ø³Ø³',
                    'chairman': 'ğŸ–ï¸ Ø±Ø¦ÙŠØ³ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©',
                    'board_member': 'ğŸ‘” Ø¹Ø¶Ùˆ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©',
                    'general_assembly': 'ğŸ‘¥ Ø¹Ø¶Ùˆ Ø§Ù„Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©',
                    'family_member': 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Ø¹Ø¶Ùˆ Ø¹Ø§Ø¦Ù„Ø©',
                    'honorary': 'ğŸ… Ø¹Ø¶Ùˆ Ø´Ø±ÙÙŠ'
                };
                return texts[type] || type;
            }

            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            updateDataStatus(familyMembers) {
                const memberCountDisplay = document.getElementById('member-count-display');
                const generationCountDisplay = document.getElementById('generation-count-display');
                
                if (memberCountDisplay && generationCountDisplay) {
                    const totalMembers = familyMembers.length;
                    const generations = new Set(familyMembers.map(m => m.generation || 1));
                    const secondGenCount = familyMembers.filter(m => m.generation === 2).length;
                    
                    memberCountDisplay.textContent = `ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: ${totalMembers}`;
                    generationCountDisplay.innerHTML = `ğŸŒ³ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„: ${generations.size} <span class="text-green-600 mr-2">| Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ: ${secondGenCount} Ø£Ø¹Ø¶Ø§Ø¡</span>`;
                    
                    // ØªØ³Ø¬ÙŠÙ„ ØªÙØµÙŠÙ„ÙŠ ÙÙŠ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„
                    if (secondGenCount > 0) {
                        console.log(`âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ: ${secondGenCount} Ø£Ø¹Ø¶Ø§Ø¡ Ù…Ù† Ø£ØµÙ„ ${totalMembers}`);
                    }
                }
            }

            // Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©
            showFamilyModal(memberId = null) {
                const modal = document.getElementById('familyModal');
                const title = document.getElementById('familyModalTitle');
                const form = document.getElementById('familyForm');
                
                if (memberId) {
                    // ØªØ¹Ø¯ÙŠÙ„ Ø¹Ø¶Ùˆ Ù…ÙˆØ¬ÙˆØ¯
                    const member = this.dataManager.getData('familyMembers').find(m => m.id === memberId);
                    if (member) {
                        title.textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ';
                        this.fillFamilyForm(member);
                    }
                } else {
                    // Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯
                    title.textContent = 'Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©';
                    form.reset();
                }
                
                this.populateParentSelect();
                modal.classList.remove('hidden');
                
                // Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø£ÙˆÙ„ Ø­Ù‚Ù„
                setTimeout(() => {
                    document.getElementById('familyFullName').focus();
                }, 100);
            }

            populateParentSelect() {
                // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ† (Ø§Ù„Ø°ÙƒÙˆØ± ÙÙ‚Ø·)
                const fatherSelect = document.getElementById('familyFatherId');
                fatherSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„ÙˆØ§Ù„Ø¯ --</option>';
                
                const maleMembers = this.dataManager.getData('familyMembers').filter(m => m.gender === 'male');
                
                // ØªØ¬Ù…ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„
                const generations = {};
                maleMembers.forEach(member => {
                    const gen = member.generation || 1;
                    if (!generations[gen]) generations[gen] = [];
                    generations[gen].push(member);
                });
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù…Ø¬Ù…ÙˆØ¹Ø© Ø­Ø³Ø¨ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„
                Object.keys(generations).sort((a, b) => parseInt(a) - parseInt(b)).forEach(genNum => {
                    const genGroup = document.createElement('optgroup');
                    genGroup.label = `${genNum == '1' ? 'Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¤Ø³Ø³' : 'Ø§Ù„Ø¬ÙŠÙ„ ' + genNum}`;
                    
                    generations[genNum].forEach(member => {
                        const option = document.createElement('option');
                        option.value = member.id;
                        option.textContent = `${member.full_name} (${this.getMembershipTypeText(member.membership_type).replace(/[ğŸ–ï¸ğŸ‘”ğŸ‘¥ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ğŸ…ğŸ‘‘]/g, '').trim()})`;
                        genGroup.appendChild(option);
                    });
                    
                    fatherSelect.appendChild(genGroup);
                });

                // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø²ÙˆØ§Ø¬ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡)
                this.populateSpouseSelect();
            }

            populateSpouseSelect() {
                const spouseSelect = document.getElementById('familySpouseId');
                if (!spouseSelect) return;
                
                spouseSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø²ÙˆØ¬/Ø§Ù„Ø²ÙˆØ¬Ø© --</option>';
                
                const allMembers = this.dataManager.getData('familyMembers');
                
                // ØªØ¬Ù…ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„
                const generations = {};
                allMembers.forEach(member => {
                    const gen = member.generation || 1;
                    if (!generations[gen]) generations[gen] = [];
                    generations[gen].push(member);
                });
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù…Ø¬Ù…ÙˆØ¹Ø© Ø­Ø³Ø¨ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„
                Object.keys(generations).sort((a, b) => parseInt(a) - parseInt(b)).forEach(genNum => {
                    const genGroup = document.createElement('optgroup');
                    genGroup.label = `${genNum == '1' ? 'Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¤Ø³Ø³' : 'Ø§Ù„Ø¬ÙŠÙ„ ' + genNum}`;
                    
                    generations[genNum].forEach(member => {
                        const option = document.createElement('option');
                        option.value = member.id;
                        const genderIcon = member.gender === 'male' ? 'â™‚ï¸' : 'â™€ï¸';
                        option.textContent = `${genderIcon} ${member.full_name}`;
                        genGroup.appendChild(option);
                    });
                    
                    spouseSelect.appendChild(genGroup);
                });
            }

            fillFamilyForm(member) {
                // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„
                const nameParts = (member.full_name || '').split(' ');
                document.getElementById('familyFirstName').value = nameParts[0] || '';
                document.getElementById('familyMiddleName').value = nameParts[1] || '';
                document.getElementById('familyLastName').value = nameParts.slice(2).join(' ') || '';
                
                // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                document.getElementById('familyFatherId').value = member.father_id || '';
                document.getElementById('familySpouseId').value = member.spouse_id || '';
                document.getElementById('familyMembershipType').value = member.membership_type || '';
                document.getElementById('familyGender').value = member.gender || '';
                document.getElementById('familyBirthDate').value = member.birth_date || '';
                document.getElementById('familyBirthPlace').value = member.birth_place || '';
                document.getElementById('familyProfession').value = member.profession || '';
                document.getElementById('familySpecialization').value = member.specialization || '';
                document.getElementById('familyPhone').value = member.phone || '';
                document.getElementById('familyEmail').value = member.email || '';
                document.getElementById('familyHobbies').value = member.hobbies || '';
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© ÙˆØ§Ù„Ø¬ÙŠÙ„
                this.updateFullNamePreview();
                this.updateGenerationDisplay();
                
                // Ø­ÙØ¸ ID Ù„Ù„ØªØ¹Ø¯ÙŠÙ„
                document.getElementById('familyForm').dataset.editId = member.id;
            }

            saveFamilyMember() {
                const form = document.getElementById('familyForm');
                const editId = form.dataset.editId;
                
                // ØªØ¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø³Ù…
                const firstName = document.getElementById('familyFirstName').value.trim();
                const middleName = document.getElementById('familyMiddleName').value.trim();
                const lastName = document.getElementById('familyLastName').value.trim();
                
                let fullName = firstName;
                if (middleName) fullName += ` ${middleName}`;
                if (lastName) fullName += ` ${lastName}`;
                
                const memberData = {
                    full_name: fullName,
                    first_name: firstName,
                    middle_name: middleName,
                    last_name: lastName,
                    father_id: document.getElementById('familyFatherId').value || null,
                    spouse_id: document.getElementById('familySpouseId').value || null,
                    membership_type: document.getElementById('familyMembershipType').value,
                    gender: document.getElementById('familyGender').value,
                    birth_date: document.getElementById('familyBirthDate').value || null,
                    birth_place: document.getElementById('familyBirthPlace').value.trim(),
                    profession: document.getElementById('familyProfession').value.trim(),
                    specialization: document.getElementById('familySpecialization').value.trim(),
                    phone: document.getElementById('familyPhone').value.trim(),
                    email: document.getElementById('familyEmail').value.trim(),
                    hobbies: document.getElementById('familyHobbies').value.trim()
                };
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                if (!firstName || !lastName || !memberData.membership_type || !memberData.gender) {
                    this.showToast('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ØŒ Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©ØŒ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©ØŒ ÙˆØ§Ù„Ø¬Ù†Ø³', 'error');
                    return;
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ (Ø¥Ø°Ø§ ØªÙ… Ø¥Ø¯Ø®Ø§Ù„Ù‡)
                if (memberData.phone && !/^05\d{8}$/.test(memberData.phone)) {
                    this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø¬ÙˆØ§Ù„ ØµØ­ÙŠØ­ Ø¨ØµÙŠØºØ© 05xxxxxxxx', 'error');
                    return;
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Ø¥Ø°Ø§ ØªÙ… Ø¥Ø¯Ø®Ø§Ù„Ù‡)
                if (memberData.email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(memberData.email)) {
                    this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØµØ­ÙŠØ­', 'error');
                    return;
                }
                
                try {
                    if (editId) {
                        // ØªØ¹Ø¯ÙŠÙ„ Ø¹Ø¶Ùˆ Ù…ÙˆØ¬ÙˆØ¯
                        this.dataManager.updateItem('familyMembers', editId, memberData);
                        this.showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ Ø¨Ù†Ø¬Ø§Ø­', 'success');
                    } else {
                        // Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯
                        const newMember = this.dataManager.addItem('familyMembers', memberData);
                        this.showToast(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${memberData.full_name} Ù„Ù„Ø¬ÙŠÙ„ ${newMember.generation} Ø¨Ù†Ø¬Ø§Ø­!`, 'success');
                    }
                    
                    this.hideFamilyModal();
                    delete form.dataset.editId;
                    
                } catch (error) {
                    this.showToast('Ø­Ø¯Ø« Ø®Ø·Ø£: ' + error.message, 'error');
                }
            }

            hideFamilyModal() {
                document.getElementById('familyModal').classList.add('hidden');
                document.getElementById('familyForm').reset();
                this.updateFullNamePreview();
                this.updateGenerationDisplay();
            }

            resetFamilyForm() {
                if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) {
                    document.getElementById('familyForm').reset();
                    delete document.getElementById('familyForm').dataset.editId;
                    this.updateFullNamePreview();
                    this.updateGenerationDisplay();
                    this.showToast('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬', 'warning');
                }
            }

            // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ÙˆØ§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£Ø®Ø±Ù‰ (Ù…Ø·ÙˆØ±Ø©)
            displayEvents() {
                this.renderEvents();
            }

            renderEvents(filterType = 'all') {
                const events = this.dataManager.getData('events');
                const container = document.getElementById('events-grid');
                if (!container) return;

                // ÙÙ„ØªØ±Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
                let filteredEvents = events;
                if (filterType !== 'all') {
                    filteredEvents = events.filter(event => event.type === filterType);
                }

                // ÙØ±Ø² Ø§Ù„Ø£Ø­Ø¯Ø§Ø«: Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© Ø£ÙˆÙ„Ø§Ù‹ØŒ Ø«Ù… Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®
                const sortedEvents = filteredEvents.sort((a, b) => {
                    const dateA = new Date(a.date);
                    const dateB = new Date(b.date);
                    return dateB - dateA; // Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹
                });

                if (sortedEvents.length === 0) {
                    const emptyMessages = {
                        'all': 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø­Ø¯Ø§Ø« Ù…Ø³Ø¬Ù„Ø©',
                        'family_gathering': 'Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¬Ù…Ø¹Ø§Øª Ø¹Ø§Ø¦Ù„ÙŠØ© Ù…Ø³Ø¬Ù„Ø©',
                        'wedding': 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ÙØ±Ø§Ø­ Ù…Ø³Ø¬Ù„Ø©',
                        'graduation': 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­ÙÙ„Ø§Øª ØªØ®Ø±Ø¬ Ù…Ø³Ø¬Ù„Ø©',
                        'birthday': 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø¹ÙŠØ§Ø¯ Ù…ÙŠÙ„Ø§Ø¯ Ù…Ø³Ø¬Ù„Ø©',
                        'religious': 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†Ø§Ø³Ø¨Ø§Øª Ø¯ÙŠÙ†ÙŠØ© Ù…Ø³Ø¬Ù„Ø©',
                        'celebration': 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ø­ØªÙØ§Ù„Ø§Øª Ù…Ø³Ø¬Ù„Ø©',
                        'travel': 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø­Ù„Ø§Øª Ù…Ø³Ø¬Ù„Ø©'
                    };

                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <div class="text-6xl text-white mb-4 opacity-50">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <p class="text-white text-xl mb-4">${emptyMessages[filterType] || emptyMessages['all']}</p>
                            ${filterType === 'all' ? `
                                <button onclick="loadSampleData()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 ml-2">
                                    ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ù…ÙˆØ°Ø¬ÙŠØ©
                                </button>
                            ` : ''}
                            <button onclick="showEventModal()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700">
                                Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø¬Ø¯ÙŠØ¯
                            </button>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = sortedEvents.map(event => this.renderEventCard(event)).join('');
                this.updateEventsStats();
            }

            renderEventCard(event) {
                const typeIcons = {
                    'family_gathering': 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦',
                    'wedding': 'ğŸ’',
                    'graduation': 'ğŸ“', 
                    'birthday': 'ğŸ‚',
                    'religious': 'ğŸ•Œ',
                    'celebration': 'ğŸ‰',
                    'travel': 'âœˆï¸',
                    'other': 'ğŸ“…'
                };

                const typeTexts = {
                    'family_gathering': 'ØªØ¬Ù…Ø¹ Ø¹Ø§Ø¦Ù„ÙŠ',
                    'wedding': 'Ø²ÙØ§Ù',
                    'graduation': 'ØªØ®Ø±Ø¬',
                    'birthday': 'Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯',
                    'religious': 'Ù…Ù†Ø§Ø³Ø¨Ø© Ø¯ÙŠÙ†ÙŠØ©',
                    'celebration': 'Ø§Ø­ØªÙØ§Ù„',
                    'travel': 'Ø±Ø­Ù„Ø©',
                    'other': 'Ù…Ù†Ø§Ø³Ø¨Ø© Ø£Ø®Ø±Ù‰'
                };

                const statusBadges = {
                    'upcoming': '<span class="px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-full">ğŸ“… Ù‚Ø§Ø¯Ù…</span>',
                    'active': '<span class="px-2 py-1 text-xs bg-green-100 text-green-700 rounded-full">ğŸ”´ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¢Ù†</span>',
                    'completed': '<span class="px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded-full">âœ… Ù…ÙƒØªÙ…Ù„</span>',
                    'cancelled': '<span class="px-2 py-1 text-xs bg-red-100 text-red-700 rounded-full">âŒ Ù…Ù„ØºÙŠ</span>'
                };

                // ØªØ­Ø¯ÙŠØ¯ Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø¯Ø« Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªØ§Ø±ÙŠØ®
                const eventDate = new Date(event.date);
                const now = new Date();
                let status = event.status;
                
                if (!status) {
                    if (eventDate > now) {
                        status = 'upcoming';
                    } else if (eventDate.toDateString() === now.toDateString()) {
                        status = 'active';
                    } else {
                        status = 'completed';
                    }
                }

                const isAdmin = this.userManager.currentUser && this.userManager.currentUser.role === 'admin';
                const canEdit = isAdmin || (this.userManager.currentUser && event.created_by === (this.userManager.currentUser.first_name + ' ' + this.userManager.currentUser.last_name));

                return `
                    <div class="card p-6 hover:shadow-lg transition-shadow ${status === 'active' ? 'ring-2 ring-green-400' : ''}">
                        <!-- Header -->
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex items-center gap-3">
                                <div class="text-3xl">${typeIcons[event.type] || 'ğŸ“…'}</div>
                                <div>
                                    <h3 class="text-xl font-bold text-gray-800 mb-1">${event.title}</h3>
                                    <p class="text-sm text-gray-600">${typeTexts[event.type] || event.type}</p>
                                </div>
                            </div>
                            ${statusBadges[status] || ''}
                        </div>

                        <!-- Event Details -->
                        <div class="space-y-3 mb-4">
                            <div class="flex items-center text-gray-700">
                                <i class="fas fa-calendar-alt w-5 ml-2 text-blue-600"></i>
                                <span>${new Date(event.date).toLocaleDateString('ar-SA')}</span>
                            </div>
                            
                            ${event.time ? `
                                <div class="flex items-center text-gray-700">
                                    <i class="fas fa-clock w-5 ml-2 text-green-600"></i>
                                    <span>${event.time}</span>
                                </div>
                            ` : ''}
                            
                            ${event.location ? `
                                <div class="flex items-center text-gray-700">
                                    <i class="fas fa-map-marker-alt w-5 ml-2 text-red-600"></i>
                                    <span>${event.location}</span>
                                </div>
                            ` : ''}
                            
                            ${event.organizer ? `
                                <div class="flex items-center text-gray-700">
                                    <i class="fas fa-user-tie w-5 ml-2 text-purple-600"></i>
                                    <span>Ù…Ù†Ø¸Ù… Ø§Ù„Ø­Ø¯Ø«: ${event.organizer}</span>
                                </div>
                            ` : ''}
                        </div>

                        <!-- Description -->
                        ${event.description ? `
                            <p class="text-gray-700 mb-4 line-clamp-2">${event.description}</p>
                        ` : ''}

                        <!-- Attendees and Capacity -->
                        <div class="flex items-center justify-between mb-4 p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center space-x-4 rtl:space-x-reverse text-sm">
                                <span class="flex items-center text-blue-600">
                                    <i class="fas fa-users ml-1"></i>
                                    ${(event.attendees || []).length} Ù…Ø´Ø§Ø±Ùƒ
                                </span>
                                ${event.capacity ? `
                                    <span class="text-gray-500">Ù…Ù† Ø£ØµÙ„ ${event.capacity}</span>
                                ` : ''}
                                <span class="flex items-center text-gray-500">
                                    <i class="fas fa-eye ml-1"></i>
                                    ${event.views || 0}
                                </span>
                            </div>
                            
                            ${event.rsvp_required ? `
                                <span class="px-2 py-1 text-xs bg-yellow-100 text-yellow-700 rounded-full">
                                    ğŸ“ ÙŠØªØ·Ù„Ø¨ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¶ÙˆØ±
                                </span>
                            ` : ''}
                        </div>

                        <!-- Actions -->
                        <div class="flex justify-between items-center pt-4 border-t border-gray-200">
                            <div class="flex gap-2">
                                ${this.userManager.currentUser ? `
                                    ${status === 'upcoming' && event.rsvp_required ? `
                                        <button onclick="rsvpEvent('${event.id}', true)" class="px-4 py-2 text-sm bg-green-100 text-green-700 rounded hover:bg-green-200">
                                            <i class="fas fa-check ml-1"></i>Ø³Ø£Ø­Ø¶Ø±
                                        </button>
                                        <button onclick="rsvpEvent('${event.id}', false)" class="px-4 py-2 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200">
                                            <i class="fas fa-times ml-1"></i>Ù„Ù† Ø£Ø­Ø¶Ø±
                                        </button>
                                    ` : ''}
                                    <button onclick="shareEvent('${event.id}')" class="px-4 py-2 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200">
                                        <i class="fas fa-share ml-1"></i>Ù…Ø´Ø§Ø±ÙƒØ©
                                    </button>
                                ` : ''}
                            </div>

                            <!-- Admin/Creator Actions -->
                            ${canEdit ? `
                                <div class="flex gap-2">
                                    <button onclick="editEvent('${event.id}')" class="px-3 py-1 text-xs bg-yellow-100 text-yellow-700 rounded hover:bg-yellow-200">
                                        <i class="fas fa-edit ml-1"></i>ØªØ¹Ø¯ÙŠÙ„
                                    </button>
                                    ${isAdmin ? `
                                        <button onclick="deleteEvent('${event.id}')" class="px-3 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200">
                                            <i class="fas fa-trash ml-1"></i>Ø­Ø°Ù
                                        </button>
                                    ` : ''}
                                </div>
                            ` : ''}
                        </div>

                        <!-- Event Creator Info -->
                        <div class="mt-2 pt-2 border-t border-gray-100 text-xs text-gray-500">
                            Ø£Ø¶ÙŠÙ Ø¨ÙˆØ§Ø³Ø·Ø© ${event.created_by || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'} â€¢ ${event.created_at || ''}
                        </div>
                    </div>
                `;
            }

            updateEventsStats() {
                const events = this.dataManager.getData('events');
                const now = new Date();
                
                const stats = {
                    total: events.length,
                    upcoming: events.filter(e => new Date(e.date) > now).length,
                    thisMonth: events.filter(e => {
                        const eventDate = new Date(e.date);
                        return eventDate.getMonth() === now.getMonth() && eventDate.getFullYear() === now.getFullYear();
                    }).length
                };

                // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙÙŠ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø¹Ù†ØµØ± Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                const statsContainer = document.getElementById('events-stats');
                if (statsContainer) {
                    statsContainer.innerHTML = `
                        <div class="grid grid-cols-3 gap-4 mb-6">
                            <div class="text-center p-4 bg-white bg-opacity-20 rounded-lg">
                                <div class="text-2xl font-bold text-white">${stats.total}</div>
                                <div class="text-sm text-white opacity-80">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</div>
                            </div>
                            <div class="text-center p-4 bg-white bg-opacity-20 rounded-lg">
                                <div class="text-2xl font-bold text-white">${stats.upcoming}</div>
                                <div class="text-sm text-white opacity-80">Ø£Ø­Ø¯Ø§Ø« Ù‚Ø§Ø¯Ù…Ø©</div>
                            </div>
                            <div class="text-center p-4 bg-white bg-opacity-20 rounded-lg">
                                <div class="text-2xl font-bold text-white">${stats.thisMonth}</div>
                                <div class="text-sm text-white opacity-80">Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</div>
                            </div>
                        </div>
                    `;
                }
            }

            renderSuggestions() {
                const suggestions = this.dataManager.getData('suggestions');
                const container = document.getElementById('suggestions-grid');
                if (!container) return;

                if (suggestions.length === 0) {
                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <div class="text-6xl text-white mb-4 opacity-50">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <p class="text-white text-xl mb-4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª</p>
                            <button onclick="loadSampleData()" class="bg-yellow-600 text-white px-6 py-3 rounded-lg hover:bg-yellow-700">
                                ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ù…ÙˆØ°Ø¬ÙŠØ©
                            </button>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = suggestions.map(suggestion => this.renderSuggestionCard(suggestion)).join('');
                this.updateSuggestionsStats();
            }

            renderSuggestionCard(suggestion) {
                const statusBadges = {
                    'pending': '<span class="px-2 py-1 text-xs bg-yellow-100 text-yellow-700 rounded-full">â³ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span>',
                    'approved': '<span class="px-2 py-1 text-xs bg-green-100 text-green-700 rounded-full">âœ… Ù…Ù‚Ø¨ÙˆÙ„</span>',
                    'rejected': '<span class="px-2 py-1 text-xs bg-red-100 text-red-700 rounded-full">âŒ Ù…Ø±ÙÙˆØ¶</span>',
                    'under_review': '<span class="px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-full">ğŸ” ØªØ­Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span>'
                };

                const priorityColors = {
                    'low': 'text-green-600',
                    'medium': 'text-yellow-600', 
                    'high': 'text-red-600',
                    'urgent': 'text-red-800'
                };

                const categoryIcons = {
                    'technology': 'ğŸ”§',
                    'events': 'ğŸ‰',
                    'services': 'ğŸ›ï¸',
                    'education': 'ğŸ“š',
                    'social': 'ğŸ‘¥',
                    'business': 'ğŸ’¼',
                    'other': 'ğŸ“'
                };

                const isAdmin = this.userManager.currentUser && this.userManager.currentUser.role === 'admin';

                return `
                    <div class="card p-6 hover:shadow-lg transition-shadow">
                        <!-- Header -->
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 mb-2">${suggestion.title}</h3>
                                <div class="flex items-center gap-2 text-sm text-gray-600">
                                    <span class="${priorityColors[suggestion.priority]}">
                                        ${categoryIcons[suggestion.category]} ${this.getCategoryText(suggestion.category)}
                                    </span>
                                    â€¢ 
                                    <span>Ø¨ÙˆØ§Ø³Ø·Ø© ${suggestion.submitted_by}</span>
                                    â€¢ 
                                    <span>${suggestion.submitted_date}</span>
                                </div>
                            </div>
                            ${statusBadges[suggestion.status] || ''}
                        </div>

                        <!-- Description -->
                        <p class="text-gray-700 mb-4 line-clamp-3">${suggestion.description}</p>

                        <!-- Benefits -->
                        ${suggestion.benefits ? `
                            <div class="mb-4">
                                <h5 class="text-sm font-semibold text-gray-800 mb-2">Ø§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©:</h5>
                                <p class="text-sm text-gray-600">${suggestion.benefits}</p>
                            </div>
                        ` : ''}

                        <!-- Budget and Timeline -->
                        ${suggestion.budget || suggestion.timeline ? `
                            <div class="grid grid-cols-2 gap-4 mb-4 p-3 bg-gray-50 rounded-lg">
                                ${suggestion.budget ? `<div><span class="text-sm font-medium">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©:</span> <span class="text-sm text-gray-600">${suggestion.budget}</span></div>` : ''}
                                ${suggestion.timeline ? `<div><span class="text-sm font-medium">Ø§Ù„Ù…Ø¯Ø©:</span> <span class="text-sm text-gray-600">${suggestion.timeline}</span></div>` : ''}
                            </div>
                        ` : ''}

                        <!-- Voting and Actions -->
                        <div class="flex justify-between items-center">
                            <div class="flex items-center space-x-4 rtl:space-x-reverse">
                                <button onclick="voteSuggestion('${suggestion.id}', 'up')" class="flex items-center text-green-600 hover:text-green-700 transition">
                                    <i class="fas fa-thumbs-up ml-1"></i>
                                    <span>${suggestion.votes.up}</span>
                                </button>
                                <button onclick="voteSuggestion('${suggestion.id}', 'down')" class="flex items-center text-red-600 hover:text-red-700 transition">
                                    <i class="fas fa-thumbs-down ml-1"></i>
                                    <span>${suggestion.votes.down}</span>
                                </button>
                                <span class="text-gray-500">
                                    <i class="fas fa-comments ml-1"></i>
                                    ${suggestion.comments.length}
                                </span>
                            </div>

                            <!-- Admin Actions -->
                            ${isAdmin ? `
                                <div class="flex gap-2">
                                    ${suggestion.status === 'pending' ? `
                                        <button onclick="updateSuggestionStatus('${suggestion.id}', 'approved')" class="px-3 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200">
                                            Ù‚Ø¨ÙˆÙ„
                                        </button>
                                        <button onclick="updateSuggestionStatus('${suggestion.id}', 'rejected')" class="px-3 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200">
                                            Ø±ÙØ¶
                                        </button>
                                    ` : ''}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            }

            getCategoryText(category) {
                const categories = {
                    'technology': 'ØªÙ‚Ù†ÙŠ',
                    'events': 'ÙØ¹Ø§Ù„ÙŠØ§Øª',
                    'services': 'Ø®Ø¯Ù…Ø§Øª',
                    'education': 'ØªØ¹Ù„ÙŠÙ…ÙŠ',
                    'social': 'Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ',
                    'business': 'ØªØ¬Ø§Ø±ÙŠ',
                    'other': 'Ø£Ø®Ø±Ù‰'
                };
                return categories[category] || category;
            }

            renderLibrary(filter = 'all') {
                const library = this.dataManager.getData('library');
                const container = document.getElementById('library-grid');
                if (!container) return;

                // ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
                let filteredLibrary = library;
                if (filter === 'videos') {
                    filteredLibrary = library.filter(item => item.type === 'video');
                } else if (filter === 'photos') {
                    filteredLibrary = library.filter(item => item.category === 'photos' || item.type === 'image');
                } else if (filter === 'documents') {
                    filteredLibrary = library.filter(item => item.category === 'documents' || item.type === 'document');
                }

                if (filteredLibrary.length === 0) {
                    const emptyMessages = {
                        'all': 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙŠØ§Øª ÙÙŠ Ø§Ù„Ù…ÙƒØªØ¨Ø©',
                        'videos': 'Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù…Ø±ÙÙˆØ¹Ø©',
                        'photos': 'Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ± Ù…Ø±ÙÙˆØ¹Ø©',
                        'documents': 'Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ«Ø§Ø¦Ù‚ Ù…Ø±ÙÙˆØ¹Ø©'
                    };
                    
                    const emptyIcons = {
                        'all': 'fas fa-book',
                        'videos': 'fas fa-video',
                        'photos': 'fas fa-image',
                        'documents': 'fas fa-file-alt'
                    };

                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <div class="text-6xl text-white mb-4 opacity-50">
                                <i class="${emptyIcons[filter]}"></i>
                            </div>
                            <p class="text-white text-xl mb-4">${emptyMessages[filter]}</p>
                            ${filter === 'all' ? `
                                <button onclick="loadSampleData()" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700">
                                    ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ù…ÙˆØ°Ø¬ÙŠØ©
                                </button>
                            ` : `
                                <button onclick="showLibraryModal()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 ml-2">
                                    Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰
                                </button>
                                ${filter === 'videos' ? `
                                    <button onclick="showVideoUploadModal()" class="bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700">
                                        Ø±ÙØ¹ ÙÙŠØ¯ÙŠÙˆ
                                    </button>
                                ` : ''}
                            `}
                        </div>
                    `;
                    return;
                }

                // ÙØ±Ø² Ø§Ù„Ù…Ø­ØªÙˆÙ‰: Ø§Ù„Ù…Ù…ÙŠØ² Ø£ÙˆÙ„Ø§Ù‹ØŒ Ø«Ù… Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®
                const sortedLibrary = filteredLibrary.sort((a, b) => {
                    if (a.featured && !b.featured) return -1;
                    if (!a.featured && b.featured) return 1;
                    return new Date(b.created_date || b.uploaded_at) - new Date(a.created_date || a.uploaded_at);
                });

                container.innerHTML = sortedLibrary.map(item => this.renderLibraryCard(item)).join('');
                this.updateLibraryStats();
                
                // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                setTimeout(() => {
                    if (typeof updateVideoStats === 'function') {
                        updateVideoStats();
                    }
                }, 100);
            }

            renderLibraryCard(item) {
                const typeIcons = {
                    'document': 'ğŸ“„',
                    'book': 'ğŸ“š',
                    'article': 'ğŸ“',
                    'video': 'ğŸ¥',
                    'audio': 'ğŸµ',
                    'image': 'ğŸ–¼ï¸',
                    'presentation': 'ğŸ“Š',
                    'research': 'ğŸ”¬'
                };

                const categoryTexts = {
                    'family_history': 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©',
                    'genealogy': 'Ø§Ù„Ø£Ù†Ø³Ø§Ø¨',
                    'documents': 'Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø±Ø³Ù…ÙŠØ©',
                    'photos': 'Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ø°ÙƒØ±ÙŠØ§Øª',
                    'achievements': 'Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª',
                    'stories': 'Ø§Ù„Ù‚ØµØµ ÙˆØ§Ù„Ø­ÙƒØ§ÙŠØ§Øª',
                    'education': 'Ø§Ù„ØªØ¹Ù„ÙŠÙ… ÙˆØ§Ù„Ù…Ù‡Ø§Ø±Ø§Øª',
                    'business': 'Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ ÙˆØ§Ù„ØªØ¬Ø§Ø±Ø©',
                    'family_gathering': 'ØªØ¬Ù…Ø¹ Ø¹Ø§Ø¦Ù„ÙŠ',
                    'wedding': 'Ø²ÙØ§Ù',
                    'celebration': 'Ø§Ø­ØªÙØ§Ù„',
                    'graduation': 'ØªØ®Ø±Ø¬',
                    'birthday': 'Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯',
                    'religious': 'Ù…Ù†Ø§Ø³Ø¨Ø© Ø¯ÙŠÙ†ÙŠØ©',
                    'travel': 'Ø³ÙØ± ÙˆØ±Ø­Ù„Ø§Øª',
                    'other': 'Ø£Ø®Ø±Ù‰'
                };

                const accessBadges = {
                    'public': '<span class="px-2 py-1 text-xs bg-green-100 text-green-700 rounded-full">ğŸŒ Ø¹Ø§Ù…</span>',
                    'family': '<span class="px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-full">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Ø¹Ø§Ø¦Ù„ÙŠ</span>',
                    'close_family': '<span class="px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded-full">ğŸ‘¥ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ù…Ù‚Ø±Ø¨Ø©</span>',
                    'admin': '<span class="px-2 py-1 text-xs bg-red-100 text-red-700 rounded-full">ğŸ”’ Ø¥Ø¯Ø§Ø±ÙŠ</span>'
                };

                const canAccess = this.checkLibraryAccess(item);

                return `
                    <div class="card p-6 hover:shadow-lg transition-shadow ${item.featured ? 'ring-2 ring-yellow-400' : ''}">
                        <!-- Featured Badge -->
                        ${item.featured ? '<div class="absolute -top-2 -right-2 bg-yellow-400 text-yellow-900 px-2 py-1 rounded-full text-xs font-bold">â­ Ù…Ù…ÙŠØ²</div>' : ''}
                        
                        <!-- Header -->
                        <!-- Video Thumbnail for videos -->
                        ${item.type === 'video' ? `
                            <div class="mb-4 relative">
                                <div class="w-full h-48 bg-gray-200 rounded-lg flex items-center justify-center cursor-pointer hover:bg-gray-300 transition" onclick="playVideo('${item.id}')">
                                    <div class="text-center">
                                        <i class="fas fa-play-circle text-4xl text-blue-600 mb-2"></i>
                                        <p class="text-sm text-gray-600">Ø§Ù†Ù‚Ø± Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</p>
                                    </div>
                                </div>
                                ${item.featured ? '<div class="absolute top-2 left-2 bg-yellow-400 text-yellow-900 px-2 py-1 rounded text-xs font-bold">â­ Ù…Ù…ÙŠØ²</div>' : ''}
                                <div class="absolute bottom-2 right-2 bg-black bg-opacity-70 text-white px-2 py-1 rounded text-xs">
                                    ${item.duration ? formatDuration(item.duration) : ''}
                                </div>
                            </div>
                        ` : ''}
                        
                        <!-- Header -->
                        <div class="flex items-start gap-3 mb-4">
                            <div class="text-3xl">${typeIcons[item.type] || 'ğŸ“„'}</div>
                            <div class="flex-1">
                                <h3 class="text-xl font-bold text-gray-800 mb-1">${item.title}</h3>
                                <p class="text-sm text-gray-600">${item.type === 'video' ? `Ø±ÙØ¹ Ø¨ÙˆØ§Ø³Ø·Ø©: ${item.uploaded_by || item.author}` : `Ø¨Ù‚Ù„Ù…: ${item.author}`}</p>
                                <p class="text-xs text-gray-500">${item.date || item.created_date || item.uploaded_at}</p>
                            </div>
                        </div>

                        <!-- Description -->
                        <p class="text-gray-700 mb-4 line-clamp-3">${item.description}</p>

                        <!-- Keywords -->
                        ${item.keywords && item.keywords.length > 0 ? `
                            <div class="flex flex-wrap gap-1 mb-4">
                                ${item.keywords.map(keyword => `
                                    <span class="px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded">${keyword}</span>
                                `).join('')}
                            </div>
                        ` : ''}

                        <!-- Category and Access -->
                        <div class="flex justify-between items-center mb-4">
                            <span class="px-2 py-1 text-xs rounded-full bg-purple-100 text-purple-700">
                                ${categoryTexts[item.category] || item.category}
                            </span>
                            ${accessBadges[item.access_level] || ''}
                        </div>

                        <!-- Stats and Actions -->
                        <div class="flex justify-between items-center">
                            <div class="flex items-center gap-4 text-sm text-gray-500">
                                <span><i class="fas fa-eye ml-1"></i>${item.views || 0}</span>
                                ${item.type === 'video' ? `
                                    <span><i class="fas fa-heart ml-1"></i>${item.likes || 0}</span>
                                    ${item.file_size ? `<span><i class="fas fa-file ml-1"></i>${(item.file_size / 1024 / 1024).toFixed(1)}MB</span>` : ''}
                                ` : `
                                    <span><i class="fas fa-download ml-1"></i>${item.downloads || 0}</span>
                                    <span><i class="fas fa-globe ml-1"></i>${item.language === 'arabic' ? 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' : item.language || 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©'}</span>
                                `}
                            </div>

                            <div class="flex gap-2">
                                ${canAccess ? `
                                    ${item.type === 'video' ? `
                                        <button onclick="playVideo('${item.id}')" class="px-3 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 transition">
                                            <i class="fas fa-play ml-1"></i>ØªØ´ØºÙŠÙ„
                                        </button>
                                    ` : `
                                        ${item.url && item.url !== '#' ? `
                                            <button onclick="openLibraryItem('${item.id}')" class="px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition">
                                                <i class="fas fa-external-link-alt ml-1"></i>ÙØªØ­
                                            </button>
                                        ` : ''}
                                        <button onclick="downloadLibraryItem('${item.id}')" class="px-3 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 transition">
                                            <i class="fas fa-download ml-1"></i>ØªØ­Ù…ÙŠÙ„
                                        </button>
                                    `}
                                ` : `
                                    <span class="px-3 py-1 text-xs bg-gray-100 text-gray-500 rounded">ØºÙŠØ± Ù…ØªØ§Ø­</span>
                                `}
                            </div>
                        </div>
                    </div>
                `;
            }

            checkLibraryAccess(item) {
                if (item.access_level === 'public') return true;
                if (!this.userManager.currentUser) return false;
                if (item.access_level === 'family') return true;
                if (item.access_level === 'admin') return this.userManager.currentUser.role === 'admin';
                return false;
            }

            updateLibraryStats() {
                const library = this.dataManager.getData('library');
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                const totalItems = library.length;
                const featuredItems = library.filter(item => item.featured).length;
                const totalViews = library.reduce((sum, item) => sum + (item.views || 0), 0);
                const totalDownloads = library.reduce((sum, item) => sum + (item.downloads || 0), 0);

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                const totalElement = document.getElementById('library-total-items');
                const featuredElement = document.getElementById('library-featured-items');
                const viewsElement = document.getElementById('library-total-views');
                const downloadsElement = document.getElementById('library-total-downloads');

                if (totalElement) totalElement.textContent = totalItems;
                if (featuredElement) featuredElement.textContent = featuredItems;
                if (viewsElement) viewsElement.textContent = totalViews;
                if (downloadsElement) downloadsElement.textContent = totalDownloads;
            }

            updateSuggestionsStats() {
                const suggestions = this.dataManager.getData('suggestions');
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                const totalSuggestions = suggestions.length;
                const pendingSuggestions = suggestions.filter(item => item.status === 'pending').length;
                const approvedSuggestions = suggestions.filter(item => item.status === 'approved').length;
                const highPrioritySuggestions = suggestions.filter(item => item.priority === 'high' || item.priority === 'urgent').length;

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                const totalElement = document.getElementById('suggestions-total');
                const pendingElement = document.getElementById('suggestions-pending');
                const approvedElement = document.getElementById('suggestions-approved');
                const highPriorityElement = document.getElementById('suggestions-high-priority');

                if (totalElement) totalElement.textContent = totalSuggestions;
                if (pendingElement) pendingElement.textContent = pendingSuggestions;
                if (approvedElement) approvedElement.textContent = approvedSuggestions;
                if (highPriorityElement) highPriorityElement.textContent = highPrioritySuggestions;
            }

            // Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
            initializeCharts() {
                this.createMembershipChart();
                this.createActivityChart();
            }

            createMembershipChart() {
                const ctx = document.getElementById('membershipChart');
                if (!ctx) return;

                const familyMembers = this.dataManager.getData('familyMembers');
                const membershipData = {};
                
                familyMembers.forEach(member => {
                    const type = this.getMembershipTypeText(member.membership_type).replace(/[ğŸ–ï¸ğŸ‘”ğŸ‘¥ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ğŸ…ğŸ‘‘]/g, '').trim();
                    membershipData[type] = (membershipData[type] || 0) + 1;
                });

                if (this.charts.membership) {
                    this.charts.membership.destroy();
                }

                this.charts.membership = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: Object.keys(membershipData),
                        datasets: [{
                            data: Object.values(membershipData),
                            backgroundColor: [
                                '#fbbf24', // amber
                                '#ef4444', // red
                                '#3b82f6', // blue
                                '#10b981', // green
                                '#6b7280', // gray
                                '#8b5cf6'  // purple
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 1.2,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            createActivityChart() {
                const ctx = document.getElementById('activityChart');
                if (!ctx) return;

                // Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ù…ÙˆØ°Ø¬ÙŠØ© Ù„Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ
                const monthlyData = [12, 19, 15, 22, 28, 18, 25, 20, 16, 24, 30, 22];
                const months = ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ', 
                              'ÙŠÙˆÙ„ÙŠÙˆ', 'Ø£ØºØ³Ø·Ø³', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'];

                if (this.charts.activity) {
                    this.charts.activity.destroy();
                }

                this.charts.activity = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: months,
                        datasets: [{
                            label: 'Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ',
                            data: monthlyData,
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 1.8,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'top'
                            }
                        }
                    }
                });
            }

            updateCharts() {
                this.createMembershipChart();
                // Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø±Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø· Ù„Ø£Ù†Ù‡ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø«Ø§Ø¨ØªØ©
            }

            // ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø©
            getMembershipTypeText(type) {
                const types = {
                    'founder': 'ğŸ‘‘ Ù…Ø¤Ø³Ø³',
                    'chairman': 'ğŸ–ï¸ Ø±Ø¦ÙŠØ³ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©',
                    'board_member': 'ğŸ‘” Ø¹Ø¶Ùˆ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©',
                    'general_assembly': 'ğŸ‘¥ Ø¹Ø¶Ùˆ Ø§Ù„Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©',
                    'family_member': 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Ø¹Ø¶Ùˆ Ø¹Ø§Ø¦Ù„Ø©',
                    'honorary': 'ğŸ… Ø¹Ø¶Ùˆ Ø´Ø±ÙÙŠ'
                };
                return types[type] || type;
            }

            checkLibraryAccess(item) {
                // Ù„ÙˆØ¬ÙŠÙƒ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙƒØªØ¨Ø©
                return true; // Ù…Ø¨Ø³Ø· Ø§Ù„Ø¢Ù†
            }

            showToast(message, type = 'success') {
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.textContent = message;
                document.body.appendChild(toast);
                
                setTimeout(() => toast.classList.add('show'), 100);
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => {
                        if (document.body.contains(toast)) {
                            document.body.removeChild(toast);
                        }
                    }, 300);
                }, 4000);
            }

            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ (Ù…Ø¨Ø³Ø·)
            createModals() {
                // ØªØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ ÙÙŠ HTML
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
            displaySuggestions() {
                this.renderSuggestions();
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙƒØªØ¨Ø©
            displayLibrary() {
                this.renderLibrary();
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
            displayProfile() {
                const user = this.userManager.currentUser;
                if (!user) return;

                const profileContainer = document.getElementById('profile-info');
                if (profileContainer) {
                    profileContainer.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="card p-6">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø´Ø®ØµÙŠØ©</h3>
                                <div class="space-y-3">
                                    <div><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${user.full_name}</div>
                                    <div><strong>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</strong> ${user.email}</div>
                                    <div><strong>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„:</strong> ${user.phone}</div>
                                    <div><strong>Ø§Ù„Ù…Ù‡Ù†Ø©:</strong> ${user.profession || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                                    <div><strong>Ø§Ù„ØªØ®ØµØµ:</strong> ${user.specialization || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                                    <div><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯:</strong> ${user.birth_date || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                                </div>
                            </div>
                            <div class="card p-6">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©</h3>
                                <div class="space-y-3">
                                    <div><strong>Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©:</strong> ${this.getMembershipTypeText(user.membership_type)}</div>
                                    <div><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</strong> ${user.created_at || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                                    <div><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> <span class="text-green-600">Ù†Ø´Ø·</span></div>
                                    <div><strong>Ø§Ù„Ø¬ÙŠÙ„:</strong> ${user.generation || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                                </div>
                            </div>
                        </div>
                    `;
                }
            }

            // Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
            displayAdminPanel() {
                console.log('ğŸ“Š displayAdminPanel() - Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø±Ø¶...');
                
                if (!this.userManager.currentUser || this.userManager.currentUser.role !== 'admin') {
                    console.log('âŒ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„ÙŠØ³ Ù…Ø¯ÙŠØ±Ø§Ù‹ Ø£Ùˆ ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„');
                    return;
                }

                console.log('âœ… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¯ÙŠØ± - Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¹Ø±Ø¶');
                
                const pendingUsers = this.userManager.getPendingUsers();
                const allUsers = this.userManager.getActiveUsers();
                
                console.log(`ğŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø¹Ù„Ù‚ÙŠÙ†: ${pendingUsers.length}`);
                console.log(`ğŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ÙØ¹Ù„ÙŠÙ†: ${allUsers.length}`);
                
                if (pendingUsers.length > 0) {
                    console.log('ğŸ“‹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù…Ø¹Ù„Ù‚ÙˆÙ†:');
                    pendingUsers.forEach((user, i) => {
                        console.log(`   ${i+1}. ${user.full_name} - ${user.email} - ${user.status}`);
                    });
                }
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø­Ø§ÙˆÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Ø¹Ø¯Ø© Ù…Ø­Ø§ÙˆÙ„Ø§Øª)
                let adminContainer = document.getElementById('admin-content');
                
                if (!adminContainer) {
                    adminContainer = document.getElementById('pendingUsersGrid');
                    console.log('ğŸ“¦ Ø§Ø³ØªØ®Ø¯Ø§Ù… pendingUsersGrid ÙƒØ­Ø§ÙˆÙŠ Ø¨Ø¯ÙŠÙ„');
                }
                
                if (!adminContainer) {
                    console.log('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ admin-contentØŒ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø§ÙˆÙŠ Ø¬Ø¯ÙŠØ¯...');
                    const adminSection = document.getElementById('admin-section');
                    if (adminSection) {
                        adminContainer = document.createElement('div');
                        adminContainer.id = 'admin-content';
                        adminContainer.className = 'admin-content-container';
                        adminSection.appendChild(adminContainer);
                        console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø§ÙˆÙŠ admin-content Ø¬Ø¯ÙŠØ¯');
                    }
                }
                
                console.log('ğŸ“¦ Ø­Ø§ÙˆÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:', adminContainer ? 'Ù…ÙˆØ¬ÙˆØ¯' : 'ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                
                if (adminContainer) {
                    adminContainer.innerHTML = `
                        <div class="space-y-6">
                            <!-- Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© -->
                            <div class="card p-6">
                                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-clock text-yellow-600 ml-2"></i>
                                    Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© (${pendingUsers.length})
                                </h3>
                                ${pendingUsers.length === 0 ? 
                                    '<p class="text-gray-500">âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø¹Ù„Ù‚Ø©</p>' :
                                    '<div id="pending-users-list">' + this.renderPendingUsers() + '</div>'
                                }
                            </div>
                            
                            <!-- Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ù†Ø´Ø·ÙŠÙ† -->
                            <div class="card p-6">
                                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-users text-green-600 ml-2"></i>
                                    Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ù†Ø´Ø·ÙŠÙ† (${allUsers.length})
                                </h3>
                                ${allUsers.length === 0 ? 
                                    '<p class="text-gray-500">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ø¹Ø¶Ø§Ø¡ Ù…ÙØ¹Ù„ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹</p>' :
                                    `<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                        ${allUsers.map(user => `
                                            <div class="p-4 border border-gray-200 rounded-lg bg-white shadow-sm hover:shadow-md transition-shadow">
                                                <div class="flex justify-between items-start mb-3">
                                                    <div class="flex-grow">
                                                        <h4 class="font-semibold text-gray-800 text-lg">${user.full_name}</h4>
                                                        <p class="text-sm text-gray-600">${user.email}</p>
                                                        <p class="text-xs text-gray-500">Ø§Ù†Ø¶Ù…: ${new Date(user.created_at).toLocaleDateString('ar-SA')}</p>
                                                    </div>
                                                    <span class="inline-block px-2 py-1 text-xs bg-green-100 text-green-700 rounded-full">
                                                        ${user.role === 'admin' ? 'ğŸ‘‘ Ù…Ø¯ÙŠØ±' : 'ğŸ‘¤ Ø¹Ø¶Ùˆ'}
                                                    </span>
                                                </div>
                                                
                                                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© -->
                                                <div class="text-xs text-gray-500 mb-3 space-y-1">
                                                    ${user.phone ? `<p><i class="fas fa-phone ml-1"></i>${user.phone}</p>` : ''}
                                                    ${user.city ? `<p><i class="fas fa-map-marker-alt ml-1"></i>${user.city}</p>` : ''}
                                                    <p><i class="fas fa-id-badge ml-1"></i>ID: ${user.id}</p>
                                                </div>
                                                
                                                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                                                <div class="flex gap-2 mt-3 pt-3 border-t border-gray-100">
                                                    <button onclick="editActiveMember('${user.id}')" 
                                                            class="flex-1 bg-blue-500 text-white px-3 py-2 rounded-lg text-sm hover:bg-blue-600 transition-colors flex items-center justify-center gap-2">
                                                        <i class="fas fa-edit"></i>
                                                        ØªØ¹Ø¯ÙŠÙ„
                                                    </button>
                                                    ${user.role !== 'admin' || allUsers.filter(u => u.role === 'admin').length > 1 ? `
                                                        <button onclick="deleteActiveMember('${user.id}', '${user.full_name}')" 
                                                                class="flex-1 bg-red-500 text-white px-3 py-2 rounded-lg text-sm hover:bg-red-600 transition-colors flex items-center justify-center gap-2">
                                                            <i class="fas fa-trash"></i>
                                                            Ø­Ø°Ù
                                                        </button>
                                                    ` : `
                                                        <button disabled 
                                                                class="flex-1 bg-gray-300 text-gray-500 px-3 py-2 rounded-lg text-sm cursor-not-allowed flex items-center justify-center gap-2"
                                                                title="Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„ÙˆØ­ÙŠØ¯">
                                                            <i class="fas fa-shield-alt"></i>
                                                            Ù…Ø­Ù…ÙŠ
                                                        </button>
                                                    `}
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>`
                                }
                            </div>
                        </div>
                    `;
                    
                    // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
                    this.updatePendingBadges();
                }
            }

            // === ÙˆØ¸Ø§Ø¦Ù Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ===
            
            // Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙŠØ¯ÙˆÙŠØ§Ù‹
            syncData() {
                try {
                    console.log('ğŸ”„ Ø¨Ø¯Ø¡ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...');
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                    this.dataManager.createBackup();
                    
                    // Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©
                    const familyCount = this.dataManager.getData('familyMembers').length;
                    const eventsCount = this.dataManager.getData('events').length;
                    const suggestionsCount = this.dataManager.getData('suggestions').length;
                    const libraryCount = this.dataManager.getData('library').length;
                    
                    this.showToast(
                        `âœ… ØªÙ… Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!\nğŸ‘¥ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©: ${familyCount} Ø¹Ø¶Ùˆ\nğŸ“… Ø§Ù„Ø£Ø­Ø¯Ø§Ø«: ${eventsCount}\nğŸ’¡ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª: ${suggestionsCount}\nğŸ“š Ø§Ù„Ù…ÙƒØªØ¨Ø©: ${libraryCount}`, 
                        'success'
                    );
                    
                    // ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ø±ÙˆØ¶
                    this.refreshAllSections();
                    
                    return true;
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                    this.showToast('Ø®Ø·Ø£ ÙÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message, 'error');
                    return false;
                }
            }
            
            // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
            importBackupData() {
                try {
                    const backupStr = localStorage.getItem('family_data_backup');
                    if (!backupStr) {
                        this.showToast('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…ØªØ§Ø­Ø©', 'warning');
                        return false;
                    }
                    
                    const backup = JSON.parse(backupStr);
                    if (!this.dataManager.validateBackupData(backup)) {
                        this.showToast('Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØªØ§Ù„ÙØ© Ø£Ùˆ ØºÙŠØ± ØµØ§Ù„Ø­Ø©', 'error');
                        return false;
                    }
                    
                    // ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
                    const currentCount = this.dataManager.getData('familyMembers').length;
                    const backupCount = backup.data.familyMembers.length;
                    
                    if (confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©ØŸ\n\nØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©: ${currentCount} Ø¹Ø¶Ùˆ\nØ§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©: ${backupCount} Ø¹Ø¶Ùˆ\nØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ø³Ø®Ø©: ${new Date(backup.timestamp).toLocaleString('ar-SA')}\n\nØ³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©!`)) {
                        
                        this.dataManager.data = backup.data;
                        this.dataManager.saveData();
                        
                        this.showToast('âœ… ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                        this.refreshAllSections();
                        return true;
                    }
                    
                    return false;
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©:', error);
                    this.showToast('Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©: ' + error.message, 'error');
                    return false;
                }
            }
            
            // Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            showDataSyncStatus() {
                try {
                    const currentData = {
                        family: this.dataManager.getData('familyMembers').length,
                        events: this.dataManager.getData('events').length,
                        suggestions: this.dataManager.getData('suggestions').length,
                        library: this.dataManager.getData('library').length
                    };
                    
                    let backupData = { family: 0, events: 0, suggestions: 0, library: 0 };
                    let backupDate = 'ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©';
                    
                    const backupStr = localStorage.getItem('family_data_backup');
                    if (backupStr) {
                        const backup = JSON.parse(backupStr);
                        backupData = {
                            family: backup.data?.familyMembers?.length || 0,
                            events: backup.data?.events?.length || 0,
                            suggestions: backup.data?.suggestions?.length || 0,
                            library: backup.data?.library?.length || 0
                        };
                        backupDate = new Date(backup.timestamp).toLocaleString('ar-SA');
                    }
                    
                    const statusModal = `
                        <div id="dataSyncModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal">
                            <div class="bg-white p-6 rounded-lg max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
                                <div class="flex justify-between items-center mb-6">
                                    <h3 class="text-2xl font-bold text-gray-800">Ø­Ø§Ù„Ø© Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                                    <button type="button" onclick="document.getElementById('dataSyncModal').remove()" class="text-gray-400 hover:text-gray-600 text-2xl">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                                
                                <div class="space-y-6">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div class="card p-4">
                                            <h4 class="font-bold text-green-700 mb-3">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h4>
                                            <div class="space-y-2 text-sm">
                                                <div class="flex justify-between"><span>Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©:</span><span class="font-bold">${currentData.family}</span></div>
                                                <div class="flex justify-between"><span>Ø§Ù„Ø£Ø­Ø¯Ø§Ø«:</span><span class="font-bold">${currentData.events}</span></div>
                                                <div class="flex justify-between"><span>Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª:</span><span class="font-bold">${currentData.suggestions}</span></div>
                                                <div class="flex justify-between"><span>Ø§Ù„Ù…ÙƒØªØ¨Ø©:</span><span class="font-bold">${currentData.library}</span></div>
                                            </div>
                                        </div>
                                        
                                        <div class="card p-4">
                                            <h4 class="font-bold text-blue-700 mb-3">Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</h4>
                                            <div class="space-y-2 text-sm">
                                                <div class="flex justify-between"><span>Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©:</span><span class="font-bold">${backupData.family}</span></div>
                                                <div class="flex justify-between"><span>Ø§Ù„Ø£Ø­Ø¯Ø§Ø«:</span><span class="font-bold">${backupData.events}</span></div>
                                                <div class="flex justify-between"><span>Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª:</span><span class="font-bold">${backupData.suggestions}</span></div>
                                                <div class="flex justify-between"><span>Ø§Ù„Ù…ÙƒØªØ¨Ø©:</span><span class="font-bold">${backupData.library}</span></div>
                                                <div class="text-xs text-gray-500 mt-2">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${backupDate}</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="flex flex-wrap gap-3">
                                        <button onclick="app.syncData()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                                            <i class="fas fa-sync ml-2"></i>Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
                                        </button>
                                        <button onclick="app.importBackupData()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                                            <i class="fas fa-download ml-2"></i>Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
                                        </button>
                                        <button onclick="app.exportData()" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700">
                                            <i class="fas fa-file-export ml-2"></i>ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ù…ÙˆØ¯Ø§Ù„ Ù…ÙˆØ¬ÙˆØ¯ ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯
                    const existingModal = document.getElementById('dataSyncModal');
                    if (existingModal) existingModal.remove();
                    
                    document.body.insertAdjacentHTML('beforeend', statusModal);
                    
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©:', error);
                    this.showToast('Ø®Ø·Ø£ ÙÙŠ Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©: ' + error.message, 'error');
                }
            }
            
            // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ…Ù„Ù JSON
            exportData() {
                try {
                    const exportData = {
                        familyMembers: this.dataManager.getData('familyMembers'),
                        events: this.dataManager.getData('events'),
                        suggestions: this.dataManager.getData('suggestions'),
                        library: this.dataManager.getData('library'),
                        exportDate: new Date().toISOString(),
                        version: '1.0'
                    };
                    
                    const dataStr = JSON.stringify(exportData, null, 2);
                    const dataBlob = new Blob([dataStr], { type: 'application/json' });
                    
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(dataBlob);
                    link.download = `family_data_${new Date().toISOString().split('T')[0]}.json`;
                    link.click();
                    
                    this.showToast('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                    this.showToast('Ø®Ø·Ø£ ÙÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message, 'error');
                }
            }

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ©
            loadSampleData() {
                try {
                    this.dataManager.loadSampleData();
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù…Ù„Ø©
                    const totalMembers = this.dataManager.getData('familyMembers').length;
                    const secondGen = this.dataManager.getData('familyMembers').filter(m => m.generation === 2);
                    
                    this.showToast(
                        `âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!\nğŸŒ³ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: ${totalMembers}\nğŸ‘¥ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ: ${secondGen.length} Ø£Ø¹Ø¶Ø§Ø¡`, 
                        'success'
                    );
                    
                    this.refreshAllSections();
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙÙˆØ±Ø§Ù‹
                    setTimeout(() => {
                        this.dataManager.createBackup();
                    }, 500);
                    
                    // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ Ù‚Ø³Ù… Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ© Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                    setTimeout(() => {
                        showSection('family');
                    }, 1500);
                    
                } catch (error) {
                    this.showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message, 'error');
                }
            }

            // === Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ===

            // Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©
            renderPendingUsers() {
                try {
                    const pendingUsers = this.userManager.users.filter(u => u.status === 'pending');
                    
                    if (pendingUsers.length === 0) {
                        return `
                            <div class="text-center py-8 text-gray-500">
                                <i class="fas fa-check-circle text-4xl mb-4"></i>
                                <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø§Ù†ØªØ¸Ø§Ø± Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                            </div>
                        `;
                    }

                    return `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            ${pendingUsers.map(user => `
                                <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                                    <div class="flex justify-between items-start mb-3">
                                        <div>
                                            <h4 class="font-semibold text-gray-800">${user.full_name}</h4>
                                            <p class="text-sm text-gray-600">${user.email}</p>
                                            <p class="text-xs text-gray-500">Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©: ${user.national_id}</p>
                                            <p class="text-xs text-gray-500">Ø§Ù„Ù‡Ø§ØªÙ: ${user.phone}</p>
                                        </div>
                                        <span class="bg-amber-100 text-amber-800 px-2 py-1 text-xs rounded-full">
                                            ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
                                        </span>
                                    </div>
                                    
                                    <div class="text-xs text-gray-500 mb-3">
                                        <p>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯: ${new Date(user.birth_date).toLocaleDateString('ar-SA')}</p>
                                        <p>Ù…ÙƒØ§Ù† Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯: ${user.birth_place}</p>
                                        <p>Ø§Ù„Ù…Ù‡Ù†Ø©: ${user.profession}</p>
                                        <p>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨: ${new Date(user.created_at).toLocaleDateString('ar-SA')}</p>
                                    </div>

                                    <div class="flex gap-2">
                                        <button onclick="app.approveUser('` + user.id + `')" 
                                                class="flex-1 bg-green-600 text-white px-3 py-2 rounded-lg text-sm hover:bg-green-700 transition-colors">
                                            <i class="fas fa-check ml-1"></i>
                                            Ù…ÙˆØ§ÙÙ‚Ø©
                                        </button>
                                        <button onclick="app.rejectUser('` + user.id + `')" 
                                                class="flex-1 bg-red-600 text-white px-3 py-2 rounded-lg text-sm hover:bg-red-700 transition-colors">
                                            <i class="fas fa-times ml-1"></i>
                                            Ø±ÙØ¶
                                        </button>
                                        <button onclick="app.viewUserDetails('` + user.id + `')" 
                                                class="bg-blue-600 text-white px-3 py-2 rounded-lg text-sm hover:bg-blue-700 transition-colors">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©:', error);
                    return '<div class="text-red-600 p-4">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</div>';
                }
            }

            // Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ù…Ø³ØªØ®Ø¯Ù…
            approveUser(userId) {
                try {
                    const user = this.userManager.users.find(u => u.id === userId);
                    if (!user) {
                        this.showToast('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                        return;
                    }

                    if (user.status !== 'pending') {
                        this.showToast('Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ ØªÙ… Ø§Ù„Ø¨Øª ÙÙŠÙ‡ Ù…Ø³Ø¨Ù‚Ø§Ù‹', 'warning');
                        return;
                    }

                    // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    user.status = 'active';
                    user.approved_at = new Date().toISOString();
                    user.approved_by = this.userManager.currentUser.id;

                    // Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
                    if (this.userManager.saveUsers()) {
                        this.showToast(`âœ… ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø·Ù„Ø¨ ${user.full_name} Ø¨Ù†Ø¬Ø§Ø­!`, 'success');
                        
                        // Ø¥Ø±Ø³Ø§Ù„ Ø¥ÙŠÙ…ÙŠÙ„ Ù…ÙˆØ§ÙÙ‚Ø©
                        this.sendApprovalEmail(user, true);
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
                        this.displayAdminPanel();
                        
                        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙƒØ¹Ø¶Ùˆ ÙÙŠ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
                        this.addUserToFamily(user);
                        
                    } else {
                        this.showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
                    }
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', error);
                    this.showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨', 'error');
                }
            }

            // Ø±ÙØ¶ Ù…Ø³ØªØ®Ø¯Ù…
            rejectUser(userId) {
                try {
                    const user = this.userManager.users.find(u => u.id === userId);
                    if (!user) {
                        this.showToast('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                        return;
                    }

                    if (user.status !== 'pending') {
                        this.showToast('Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ ØªÙ… Ø§Ù„Ø¨Øª ÙÙŠÙ‡ Ù…Ø³Ø¨Ù‚Ø§Ù‹', 'warning');
                        return;
                    }

                    // ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±ÙØ¶
                    if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ÙØ¶ Ø·Ù„Ø¨ ${user.full_name}ØŸ\nØ³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹.`)) {
                        // Ø¥Ø±Ø³Ø§Ù„ Ø¥ÙŠÙ…ÙŠÙ„ Ø±ÙØ¶ Ù‚Ø¨Ù„ Ø§Ù„Ø­Ø°Ù
                        this.sendApprovalEmail(user, false);
                        
                        // Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                        const userIndex = this.userManager.users.findIndex(u => u.id === userId);
                        if (userIndex > -1) {
                            this.userManager.users.splice(userIndex, 1);
                            
                            if (this.userManager.saveUsers()) {
                                this.showToast(`âŒ ØªÙ… Ø±ÙØ¶ Ø·Ù„Ø¨ ${user.full_name}`, 'info');
                                this.displayAdminPanel();
                            } else {
                                this.showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
                            }
                        }
                    }
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¶ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', error);
                    this.showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¶ Ø§Ù„Ø·Ù„Ø¨', 'error');
                }
            }

            // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            viewUserDetails(userId) {
                try {
                    const user = this.userManager.users.find(u => u.id === userId);
                    if (!user) {
                        this.showToast('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                        return;
                    }

                    const modalHTML = `
                        <div class="modal-overlay" onclick="closeModal('userDetailsModal')">
                            <div class="modal-content max-w-2xl" onclick="event.stopPropagation()">
                                <div class="modal-header">
                                    <h2 class="text-xl font-bold">ØªÙØ§ØµÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„ØªØ³Ø¬ÙŠÙ„</h2>
                                    <button onclick="closeModal('userDetailsModal')" class="modal-close">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                                
                                <div class="modal-body max-h-96 overflow-y-auto">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="space-y-3">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                                                <p class="text-gray-800">${user.full_name}</p>
                                            </div>
                                            
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                                                <p class="text-gray-800">${user.email}</p>
                                            </div>
                                            
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600">Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©</label>
                                                <p class="text-gray-800">${user.national_id}</p>
                                            </div>
                                            
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                                                <p class="text-gray-800">${user.phone}</p>
                                            </div>
                                            
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
                                                <p class="text-gray-800">${new Date(user.birth_date).toLocaleDateString('ar-SA')}</p>
                                            </div>
                                        </div>
                                        
                                        <div class="space-y-3">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600">Ù…ÙƒØ§Ù† Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
                                                <p class="text-gray-800">${user.birth_place}</p>
                                            </div>
                                            
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600">Ø§Ù„Ù…Ù‡Ù†Ø©</label>
                                                <p class="text-gray-800">${user.profession}</p>
                                            </div>
                                            
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600">Ø§Ù„ØªØ®ØµØµ</label>
                                                <p class="text-gray-800">${user.specialization || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                                            </div>
                                            
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600">Ø§Ù„Ù‡ÙˆØ§ÙŠØ§Øª</label>
                                                <p class="text-gray-800">${user.hobbies || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                                            </div>
                                            
                                            <div>
                                                <label class="block text-sm font-medium text-gray-600">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨</label>
                                                <p class="text-gray-800">${new Date(user.created_at).toLocaleDateString('ar-SA', { 
                                                    year: 'numeric', 
                                                    month: 'long', 
                                                    day: 'numeric',
                                                    hour: '2-digit',
                                                    minute: '2-digit'
                                                })}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="modal-footer">
                                    <button onclick="app.approveUser('` + user.id + `'); closeModal('userDetailsModal')" 
                                            class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                                        <i class="fas fa-check ml-1"></i>
                                        Ù…ÙˆØ§ÙÙ‚Ø©
                                    </button>
                                    <button onclick="app.rejectUser('` + user.id + `'); closeModal('userDetailsModal')" 
                                            class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">
                                        <i class="fas fa-times ml-1"></i>
                                        Ø±ÙØ¶
                                    </button>
                                    <button onclick="closeModal('userDetailsModal')" 
                                            class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600">
                                        Ø¥ØºÙ„Ø§Ù‚
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;

                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
                    const existingModal = document.getElementById('userDetailsModal');
                    if (existingModal) {
                        existingModal.remove();
                    }

                    const modalDiv = document.createElement('div');
                    modalDiv.id = 'userDetailsModal';
                    modalDiv.innerHTML = modalHTML;
                    document.body.appendChild(modalDiv);

                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', error);
                    this.showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„', 'error');
                }
            }

            // Ø¥Ø±Ø³Ø§Ù„ Ø¥ÙŠÙ…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©/Ø§Ù„Ø±ÙØ¶ (Ù…Ø­Ø§ÙƒØ§Ø©)
            sendApprovalEmail(user, approved) {
                try {
                    const emailData = {
                        to: user.email,
                        subject: approved ? 'ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø·Ù„Ø¨ Ø§Ù†Ø¶Ù…Ø§Ù…Ùƒ Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ø³Ø¹Ø¯Ø§Ù†' : 'Ù„Ù… ÙŠØªÙ… Ù‚Ø¨ÙˆÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…',
                        body: approved 
                            ? `Ù…Ø±Ø­Ø¨Ø§Ù‹ ${user.full_name},\n\nÙ†Ø­Ù† Ø³Ø¹Ø¯Ø§Ø¡ Ù„Ø¥Ø¨Ù„Ø§ØºÙƒ Ø¨Ø£Ù†Ù‡ ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø·Ù„Ø¨ Ø§Ù†Ø¶Ù…Ø§Ù…Ùƒ Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ø³Ø¹Ø¯Ø§Ù†.\n\nÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹.\n\nØ£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©!\n\nØ¥Ø¯Ø§Ø±Ø© Ù…ÙˆÙ‚Ø¹ Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ø³Ø¹Ø¯Ø§Ù†`
                            : `Ù…Ø±Ø­Ø¨Ø§Ù‹ ${user.full_name},\n\nÙ†Ø¹ØªØ°Ø± Ù„Ø¥Ø¨Ù„Ø§ØºÙƒ Ø¨Ø£Ù†Ù‡ Ù„Ù… ÙŠØªÙ… Ù‚Ø¨ÙˆÙ„ Ø·Ù„Ø¨ Ø§Ù†Ø¶Ù…Ø§Ù…Ùƒ Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ø³Ø¹Ø¯Ø§Ù† ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ.\n\nÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø£Ùˆ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±.\n\nØ´ÙƒØ±Ø§Ù‹ Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ùƒ\n\nØ¥Ø¯Ø§Ø±Ø© Ù…ÙˆÙ‚Ø¹ Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ø³Ø¹Ø¯Ø§Ù†`,
                        timestamp: new Date().toISOString()
                    };

                    // Ø­ÙØ¸ Ø§Ù„Ø³Ø¬Ù„ Ù…Ø­Ù„ÙŠØ§Ù‹ (Ù…Ø­Ø§ÙƒØ§Ø©)
                    const emailLogs = JSON.parse(localStorage.getItem('email_logs') || '[]');
                    emailLogs.push(emailData);
                    localStorage.setItem('email_logs', JSON.stringify(emailLogs));

                    console.log('ğŸ“§ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥ÙŠÙ…ÙŠÙ„:', approved ? 'Ù…ÙˆØ§ÙÙ‚Ø©' : 'Ø±ÙØ¶', 'Ø¥Ù„Ù‰:', user.email);
                    
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„:', error);
                }
            }

            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„ ÙƒØ¹Ø¶Ùˆ ÙÙŠ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©
            addUserToFamily(user) {
                try {
                    const familyMembers = this.dataManager.getData('familyMembers');
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¹Ø¶Ùˆ Ù…Ø³Ø¨Ù‚Ø§Ù‹
                    const existingMember = familyMembers.find(m => 
                        m.national_id === user.national_id || 
                        m.email === user.email
                    );
                    
                    if (!existingMember) {
                        const newFamilyMember = {
                            id: user.id,
                            name: user.full_name,
                            email: user.email,
                            phone: user.phone,
                            national_id: user.national_id,
                            birth_date: user.birth_date,
                            birth_place: user.birth_place,
                            profession: user.profession,
                            specialization: user.specialization || '',
                            hobbies: user.hobbies || '',
                            father_id: user.father_id,
                            generation: user.generation || 3, // Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù„Ø« Ù„Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø¯
                            created_at: new Date().toISOString()
                        };
                        
                        familyMembers.push(newFamilyMember);
                        this.dataManager.saveData('familyMembers', familyMembers);
                        
                        console.log('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙƒØ¹Ø¶Ùˆ ÙÙŠ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©:', user.full_name);
                    }
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©:', error);
                }
            }

            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© Ù„Ù„Ø´Ø§Ø±Ø©
            getPendingUsersCount() {
                try {
                    return this.userManager.users.filter(u => u.status === 'pending').length;
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©:', error);
                    return 0;
                }
            }

            // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
            updatePendingBadges() {
                try {
                    const pendingCount = this.getPendingUsersCount();
                    const badgeDesktop = document.getElementById('pending-badge-desktop');
                    const badgeMobile = document.getElementById('pending-badge-mobile');

                    if (pendingCount > 0) {
                        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø´Ø§Ø±Ø§Øª Ù…Ø¹ Ø§Ù„Ø¹Ø¯Ø¯
                        if (badgeDesktop) {
                            badgeDesktop.textContent = pendingCount;
                            badgeDesktop.classList.remove('hidden');
                        }
                        if (badgeMobile) {
                            badgeMobile.textContent = pendingCount;
                            badgeMobile.classList.remove('hidden');
                        }
                    } else {
                        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø´Ø§Ø±Ø§Øª
                        if (badgeDesktop) {
                            badgeDesktop.classList.add('hidden');
                        }
                        if (badgeMobile) {
                            badgeMobile.classList.add('hidden');
                        }
                    }
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª:', error);
                }
            }
        }

        // Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
        let app;

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        document.addEventListener('DOMContentLoaded', function() {
            try {
                app = new EnhancedAlSaedanApp();
                console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ Ø§Ù„Ù…Ø­Ø³Ù† Ø¨Ù†Ø¬Ø§Ø­');
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:', error);
            }
        });

        // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªÙ†Ù‚Ù„Ø©
        function toggleMobileMenu() {
            const mobileNav = document.getElementById('mobileNavigation');
            const menuIcon = document.getElementById('mobileMenuIcon');
            const menuButton = document.getElementById('mobileMenuButton');
            
            if (mobileNav.classList.contains('hidden')) {
                // ÙØªØ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                mobileNav.classList.remove('hidden');
                // Ø§Ù†ØªØ¸Ø§Ø± Ù‚ØµÙŠØ± Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù†ØµØ± Ù‚Ø¨Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø±ÙƒØ©
                setTimeout(() => {
                    mobileNav.classList.add('show');
                }, 10);
                
                menuIcon.className = 'fas fa-times text-xl';
                menuButton.classList.add('bg-gray-200');
                
                // Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©
                document.body.style.overflow = 'hidden';
            } else {
                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                mobileNav.classList.remove('show');
                menuIcon.className = 'fas fa-bars text-xl';
                menuButton.classList.remove('bg-gray-200');
                
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø­Ø±ÙƒØ©
                setTimeout(() => {
                    mobileNav.classList.add('hidden');
                }, 300);
                
                // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                document.body.style.overflow = 'auto';
            }
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªÙ†Ù‚Ù„Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§ Ø£Ùˆ Ø¹Ù†Ø¯ Ø§Ù„Ø¥ÙŠÙ…Ø§Ø¡Ø§Øª
        document.addEventListener('click', function(event) {
            const mobileNav = document.getElementById('mobileNavigation');
            const menuButton = document.getElementById('mobileMenuButton');
            
            if (mobileNav && !mobileNav.classList.contains('hidden') && 
                !mobileNav.contains(event.target) && !menuButton.contains(event.target)) {
                closeMobileMenu();
            }
        });
        
        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªÙ†Ù‚Ù„Ø©
        function closeMobileMenu() {
            const mobileNav = document.getElementById('mobileNavigation');
            const menuIcon = document.getElementById('mobileMenuIcon');
            const menuButton = document.getElementById('mobileMenuButton');
            
            if (mobileNav && !mobileNav.classList.contains('hidden')) {
                mobileNav.classList.remove('show');
                menuIcon.className = 'fas fa-bars text-xl';
                menuButton.classList.remove('bg-gray-200');
                
                setTimeout(() => {
                    mobileNav.classList.add('hidden');
                }, 300);
                
                document.body.style.overflow = 'auto';
            }
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ø¯Ø¹Ù… Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ù„Ù…Ø³ (swipe gestures)
        let touchStartY = 0;
        let touchEndY = 0;
        
        document.addEventListener('touchstart', function(event) {
            touchStartY = event.changedTouches[0].screenY;
        });
        
        document.addEventListener('touchend', function(event) {
            const mobileNav = document.getElementById('mobileNavigation');
            if (!mobileNav || mobileNav.classList.contains('hidden')) return;
            
            touchEndY = event.changedTouches[0].screenY;
            const swipeDistance = touchStartY - touchEndY;
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø­Ø¨ Ù„Ø£Ø³ÙÙ„ (swipe down)
            if (swipeDistance < -50) {
                closeMobileMenu();
            }
        });

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªÙ†Ù‚Ù„
        function showSection(sectionName) {
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ (Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨ ÙˆØ§Ù„Ø¬ÙˆØ§Ù„)
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-item-mobile').forEach(item => {
                item.classList.remove('active');
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
            const targetSection = document.getElementById(`${sectionName}-section`);
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            // ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„ØªÙ†Ù‚Ù„ ÙÙŠ Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨
            const navButton = document.getElementById(`nav-${sectionName}`);
            if (navButton) {
                navButton.classList.add('active');
            }
            
            // ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„ØªÙ†Ù‚Ù„ ÙÙŠ Ø§Ù„Ø¬ÙˆØ§Ù„
            const mobileNavButtons = document.querySelectorAll('.nav-item-mobile');
            mobileNavButtons.forEach(btn => {
                const onclick = btn.getAttribute('onclick');
                if (onclick && onclick.includes(`showSection('${sectionName}')`)) {
                    btn.classList.add('active');
                }
            });

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø³Ù…
            if (app) {
                switch(sectionName) {
                    case 'home':
                        setTimeout(() => {
                            if (app.updateCharts) app.updateCharts();
                            if (app.displayHomeStatistics) app.displayHomeStatistics();
                        }, 100);
                        break;
                    case 'family':
                        app.displayFamilyTree();
                        break;
                    case 'events':
                        app.displayEvents();
                        break;
                    case 'suggestions':
                        app.renderSuggestions();
                        break;
                    case 'library':
                        app.renderLibrary();
                        break;
                    case 'profile':
                        app.displayUserProfile();
                        break;
                    case 'admin':
                        if (app.userManager.currentUser && app.userManager.currentUser.role === 'admin') {
                            app.displayAdminPanel();
                        }
                        break;
                }
            }
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©
        function loadFounderFamily() {
            if (app) {
                app.loadSampleData();
            }
        }

        function resetAndReloadFamily() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŸ\nØ³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©.')) {
                if (app) {
                    try {
                        console.log('ğŸ”„ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†...');
                        
                        // Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ù…ÙØ§ØªÙŠØ­ LocalStorage Ø§Ù„Ù…ØªØ¹Ù„Ù‚Ø© Ø¨Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
                        const keysToRemove = [];
                        for (let i = 0; i < localStorage.length; i++) {
                            const key = localStorage.key(i);
                            if (key && (key.includes('al_saedan') || key.includes('family') || key.includes('saedan'))) {
                                keysToRemove.push(key);
                            }
                        }
                        
                        keysToRemove.forEach(key => {
                            localStorage.removeItem(key);
                            console.log(`ğŸ—‘ï¸ ØªÙ… Ø­Ø°Ù Ù…ÙØªØ§Ø­: ${key}`);
                        });
                        
                        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
                        app.dataManager.resetToEmpty();
                        
                        console.log('ğŸ“Š Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰:');
                        console.log(`   - Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©: ${SAMPLE_FAMILY_DATA.familyMembers.length}`);
                        console.log(`   - Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ: ${SAMPLE_FAMILY_DATA.familyMembers.filter(m => m.generation === 2).length}`);
                        
                        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
                        app.dataManager.loadSampleData();
                        
                        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†ØªÙŠØ¬Ø©
                        const currentMembers = app.dataManager.getData('familyMembers');
                        const gen2Members = currentMembers.filter(m => m.generation === 2);
                        
                        console.log('âœ… Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„:');
                        console.log(`   - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: ${currentMembers.length}`);
                        console.log(`   - Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ: ${gen2Members.length}`);
                        
                        if (gen2Members.length > 0) {
                            console.log('ğŸ‘¥ Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ù…Ø­Ù…Ù„ÙŠÙ†:');
                            gen2Members.forEach((member, index) => {
                                console.log(`   ${index + 1}. ${member.full_name}`);
                            });
                        }
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
                        app.displayFamilyTree();
                        app.updateStats();
                        
                        app.showToast(`âœ… ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„! Ø§Ù„Ø¹Ø¯Ø¯: ${currentMembers.length} Ø£Ø¹Ø¶Ø§Ø¡ (Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ: ${gen2Members.length})`, 'success');
                        
                        // Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ© Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù†ØªÙŠØ¬Ø©
                        setTimeout(() => {
                            showSection('family');
                        }, 1000);
                        
                    } catch (error) {
                        console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†:', error);
                        app.showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†: ' + error.message, 'error');
                    }
                }
            }
        }

        // ÙˆØ¸ÙŠÙØ© Ù„Ø­Ù‚Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù…Ø¨Ø§Ø´Ø±Ø©
        function forceLoadRealFamily() {
            if (!app) return;
            
            console.log('ğŸš€ Ø¨Ø¯Ø¡ Ø­Ù‚Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù…Ø¨Ø§Ø´Ø±Ø©...');
            
            // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©
            const realFamilyData = [
                // Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¤Ø³Ø³
                {
                    id: 'founder_001',
                    full_name: 'Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ù…Ø­Ù…Ø¯',
                    middle_name: '',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'founder',
                    gender: 'male',
                    father_id: null,
                    generation: 1,
                    birth_date: '1950-01-01',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: 'Ø±Ø¬Ù„ Ø£Ø¹Ù…Ø§Ù„',
                    specialization: 'Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠ',
                    phone: '0533361154',
                    email: 'info@salmansaedan.com',
                    hobbies: 'Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©ØŒ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØŒ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø®ÙŠØ±ÙŠØ©',
                    created_at: '2024-01-01',
                    children: []
                },
                // Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ - Ø§Ù„Ø£Ø¨Ù†Ø§Ø¡
                {
                    id: 'gen2_001',
                    full_name: 'Ø³Ù„Ù…Ø§Ù† Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø³Ù„Ù…Ø§Ù†',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'chairman',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1975-05-15',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: 'Ù…Ø·ÙˆØ± Ø¹Ù‚Ø§Ø±ÙŠ',
                    specialization: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©',
                    phone: '0533361156',
                    email: 'salman@salmansaedan.com',
                    hobbies: 'Ø§Ù„Ø³ÙØ±ØŒ Ø§Ù„ØªØµÙˆÙŠØ±ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶Ø©ØŒ ØªØ·ÙˆÙŠØ± Ø§Ù„Ø£Ø¹Ù…Ø§Ù„',
                    created_at: '2024-01-02',
                    children: []
                },
                {
                    id: 'gen2_002',
                    full_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1970-03-10',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-03',
                    children: []
                },
                {
                    id: 'gen2_003',
                    full_name: 'ÙÙ‡Ø¯ Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'ÙÙ‡Ø¯',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1972-07-22',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-04',
                    children: []
                },
                {
                    id: 'gen2_004',
                    full_name: 'Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø­Ù…Ø¯',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1974-11-05',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-05',
                    children: []
                },
                {
                    id: 'gen2_005',
                    full_name: 'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1976-09-18',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-06',
                    children: []
                },
                {
                    id: 'gen2_006',
                    full_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù† Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù†',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1978-12-30',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-07',
                    children: []
                },
                {
                    id: 'gen2_007',
                    full_name: 'Ù†Ø§ØµØ± Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ù†Ø§ØµØ±',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1980-04-12',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-08',
                    children: []
                },
                {
                    id: 'gen2_008',
                    full_name: 'Ø³Ø¹Ø¯ Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø³Ø¹Ø¯',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1982-08-25',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-09',
                    children: []
                },
                {
                    id: 'gen2_009',
                    full_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø­Ø³Ù† Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø­Ø³Ù†',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1984-02-14',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-10',
                    children: []
                },
                {
                    id: 'gen2_010',
                    full_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ²',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1986-06-08',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-11',
                    children: []
                },
                {
                    id: 'gen2_011',
                    full_name: 'Ù…ØªØ¹Ø¨ Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ù…ØªØ¹Ø¨',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1988-10-20',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-12',
                    children: []
                },
                {
                    id: 'gen2_012',
                    full_name: 'Ø¨Ù†Ø¯Ø± Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø¨Ù†Ø¯Ø±',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'board_member',
                    gender: 'male',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1990-01-15',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-13',
                    children: []
                },
                // Ø§Ù„Ø¨Ù†Ø§Øª
                {
                    id: 'gen2_013',
                    full_name: 'Ù…Ù†ÙŠØ±Ø© Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ù…Ù†ÙŠØ±Ø©',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'family_member',
                    gender: 'female',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1973-05-12',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-14',
                    children: []
                },
                {
                    id: 'gen2_014',
                    full_name: 'Ø³Ø§Ø±Ø© Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø³Ø§Ø±Ø©',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'family_member',
                    gender: 'female',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1977-08-03',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-15',
                    children: []
                },
                {
                    id: 'gen2_015',
                    full_name: 'Ù†ÙˆØ±Ø© Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ù†ÙˆØ±Ø©',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'family_member',
                    gender: 'female',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1981-11-26',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-16',
                    children: []
                },
                {
                    id: 'gen2_016',
                    full_name: 'Ø§Ù„Ø¹Ù†ÙˆØ¯ Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'Ø§Ù„Ø¹Ù†ÙˆØ¯',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'family_member',
                    gender: 'female',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1985-03-17',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-17',
                    children: []
                },
                {
                    id: 'gen2_017',
                    full_name: 'ÙˆØ³Ù…ÙŠØ© Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    first_name: 'ÙˆØ³Ù…ÙŠØ©',
                    middle_name: 'Ù…Ø­Ù…Ø¯',
                    last_name: 'Ø¨Ù† Ø³Ø¹ÙŠØ¯Ø§Ù†',
                    membership_type: 'family_member',
                    gender: 'female',
                    father_id: 'founder_001',
                    generation: 2,
                    birth_date: '1987-09-09',
                    birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                    profession: '',
                    specialization: '',
                    phone: '',
                    email: '',
                    hobbies: '',
                    created_at: '2024-01-18',
                    children: []
                }
            ];
            
            // Ø­Ù‚Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©
            app.dataManager.data.familyMembers = realFamilyData;
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø£Ø·ÙØ§Ù„
            app.dataManager.updateChildrenReferences();
            
            // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            app.dataManager.saveData();
            
            console.log(`âœ… ØªÙ… Ø­Ù‚Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª! Ø§Ù„Ø¹Ø¯Ø¯: ${realFamilyData.length} Ø£Ø¹Ø¶Ø§Ø¡`);
            console.log(`   - Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„: ${realFamilyData.filter(m => m.generation === 1).length} Ø£Ø¹Ø¶Ø§Ø¡`);
            console.log(`   - Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ: ${realFamilyData.filter(m => m.generation === 2).length} Ø£Ø¹Ø¶Ø§Ø¡`);
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
            app.displayFamilyTree();
            app.updateStats();
            
            app.showToast(`âœ… ØªÙ… Ø­Ù‚Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­! Ø§Ù„Ø¹Ø¯Ø¯: ${realFamilyData.length} Ø£Ø¹Ø¶Ø§Ø¡`, 'success');
            
            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ©
            setTimeout(() => {
                showSection('family');
            }, 500);
        }

        // ÙˆØ¸ÙŠÙØ© Ø¯Ø®ÙˆÙ„ Ø³Ø±ÙŠØ¹ ÙƒÙ…Ø¯ÙŠØ±
        function quickLogin() {
            if (app && app.userManager) {
                try {
                    console.log('ğŸš€ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¯Ø®ÙˆÙ„ Ø³Ø±ÙŠØ¹ ÙƒÙ…Ø¯ÙŠØ±...');
                    
                    // ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ù…Ø¨Ø§Ø´Ø± Ø¨Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
                    const loginResult = app.userManager.login('admin@salmansaedan.com', 'admin123');
                    
                    if (loginResult.success) {
                        console.log('âœ… Ù†Ø¬Ø­ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¯ÙŠØ±');
                        app.showToast('âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¯ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                        app.updateUserInterface();
                        
                        // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                        showSection('home');
                        
                    } else {
                        console.error('âŒ ÙØ´Ù„ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:', loginResult.message);
                        app.showToast('âŒ ÙØ´Ù„ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: ' + loginResult.message, 'error');
                    }
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹:', error);
                    app.showToast('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: ' + error.message, 'error');
                }
            } else {
                console.error('âŒ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ØºÙŠØ± Ø¬Ø§Ù‡Ø²');
                app.showToast('âŒ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ØºÙŠØ± Ø¬Ø§Ù‡Ø²ØŒ Ø¬Ø±Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰', 'error');
            }
        }

        // ÙˆØ¸ÙŠÙØ© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ ÙÙŠ console
        function checkMemberCount() {
            if (app) {
                const familyMembers = app.dataManager.getData('familyMembers');
                const gen1 = familyMembers.filter(m => m.generation === 1);
                const gen2 = familyMembers.filter(m => m.generation === 2);
                
                console.log('ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:');
                console.log(`   - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: ${familyMembers.length}`);
                console.log(`   - Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„: ${gen1.length} Ø£Ø¹Ø¶Ø§Ø¡`);
                console.log(`   - Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ: ${gen2.length} Ø£Ø¹Ø¶Ø§Ø¡`);
                
                if (gen2.length > 0) {
                    console.log('ğŸ‘¥ Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ:');
                    gen2.forEach((member, index) => {
                        console.log(`   ${index + 1}. ${member.full_name}`);
                    });
                } else {
                    console.log('âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ø¹Ø¶Ø§Ø¡ ÙÙŠ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ');
                }
                
                // ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                console.log('ğŸ” ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©:');
                console.log(`   - Ø£Ø¹Ø¶Ø§Ø¡ ÙÙŠ SAMPLE_FAMILY_DATA: ${SAMPLE_FAMILY_DATA.familyMembers.length}`);
                console.log(`   - Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©: ${SAMPLE_FAMILY_DATA.familyMembers.filter(m => m.generation === 2).length}`);
                
                // ÙØ­Øµ LocalStorage
                const stored = localStorage.getItem('al_saedan_app_v2');
                if (stored) {
                    const parsed = JSON.parse(stored);
                    console.log(`   - Ø£Ø¹Ø¶Ø§Ø¡ ÙÙŠ LocalStorage: ${parsed.familyMembers ? parsed.familyMembers.length : 0}`);
                } else {
                    console.log('   - Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ LocalStorage');
                }
                
                app.showToast(`Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${familyMembers.length} Ø£Ø¹Ø¶Ø§Ø¡ (Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ: ${gen2.length})`, gen2.length === 17 ? 'success' : 'error');
            }
        }

        function loadSampleData() {
            if (app) {
                app.loadSampleData();
            }
        }

        function showFamilyModal(memberId = null) {
            if (app) {
                app.showFamilyModal(memberId);
            }
        }

        function hideFamilyModal() {
            if (app) {
                app.hideFamilyModal();
            }
        }

        function resetFamilyForm() {
            if (app) {
                app.resetFamilyForm();
            }
        }

        function editFamilyMember(id) {
            if (app) {
                app.showFamilyModal(id);
            }
        }

        function deleteFamilyMember(id) {
            if (!app) return;
            
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø¶ÙˆØŸ')) {
                try {
                    app.dataManager.deleteItem('familyMembers', id);
                    app.showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ø¶Ùˆ Ø¨Ù†Ø¬Ø§Ø­', 'success');
                } catch (error) {
                    app.showToast('Ø­Ø¯Ø« Ø®Ø·Ø£: ' + error.message, 'error');
                }
            }
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø£Ø®Ø±Ù‰ (Ù…Ø¨Ø³Ø·Ø©)
        // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        function showEventModal() {
            document.getElementById('eventModal').classList.remove('hidden');
            document.getElementById('eventTitle').focus();
            
            // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ ÙƒØ§ÙØªØ±Ø§Ø¶ÙŠ
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('eventDate').value = today;
        }

        function hideEventModal() {
            document.getElementById('eventModal').classList.add('hidden');
            document.getElementById('eventForm').reset();
        }

        function resetEventForm() {
            document.getElementById('eventForm').reset();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('eventDate').value = today;
            document.getElementById('eventTitle').focus();
        }



        function filterEventsByType(type) {
            app.renderEvents(type);
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        function rsvpEvent(eventId, attending) {
            if (!app.userManager.currentUser) {
                app.showToast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }

            const events = app.dataManager.getData('events');
            const eventIndex = events.findIndex(e => e.id === eventId);
            
            if (eventIndex === -1) {
                app.showToast('Ø§Ù„Ø­Ø¯Ø« ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                return;
            }

            const event = events[eventIndex];
            if (!event.attendees) event.attendees = [];

            const userId = app.userManager.currentUser.id;
            const existingRSVP = event.attendees.findIndex(a => a.userId === userId);

            if (attending) {
                if (existingRSVP === -1) {
                    event.attendees.push({
                        userId: userId,
                        name: app.userManager.currentUser.first_name + ' ' + app.userManager.currentUser.last_name,
                        status: 'attending',
                        rsvp_date: new Date().toISOString()
                    });
                    app.showToast('ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø­Ø¶ÙˆØ±Ùƒ Ù„Ù„Ø­Ø¯Ø«', 'success');
                } else {
                    event.attendees[existingRSVP].status = 'attending';
                    app.showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø¶ÙˆØ±Ùƒ Ù„Ù„Ø­Ø¯Ø«', 'success');
                }
            } else {
                if (existingRSVP !== -1) {
                    event.attendees[existingRSVP].status = 'not_attending';
                    app.showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¹Ø¯Ù… Ø­Ø¶ÙˆØ±Ùƒ Ù„Ù„Ø­Ø¯Ø«', 'warning');
                }
            }

            app.dataManager.setData('events', events);
            app.renderEvents();
        }

        function shareEvent(eventId) {
            const events = app.dataManager.getData('events');
            const event = events.find(e => e.id === eventId);
            
            if (!event) {
                app.showToast('Ø§Ù„Ø­Ø¯Ø« ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                return;
            }

            const shareText = `ğŸ‰ ${event.title}\nğŸ“… ${new Date(event.date).toLocaleDateString('ar-SA')}\nğŸ“ ${event.location || ''}\n\n${event.description || ''}`;
            
            if (navigator.share) {
                navigator.share({
                    title: event.title,
                    text: shareText,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    app.showToast('ØªÙ… Ù†Ø³Ø® ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¯Ø«', 'success');
                });
            }
        }

        function editEvent(eventId) {
            const events = app.dataManager.getData('events');
            const event = events.find(e => e.id === eventId);
            
            if (!event) {
                app.showToast('Ø§Ù„Ø­Ø¯Ø« ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                return;
            }

            // Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            document.getElementById('eventTitle').value = event.title;
            document.getElementById('eventType').value = event.type;
            document.getElementById('eventDate').value = event.date;
            document.getElementById('eventTime').value = event.time || '';
            document.getElementById('eventLocation').value = event.location || '';
            document.getElementById('eventDescription').value = event.description || '';
            document.getElementById('eventOrganizer').value = event.organizer || '';
            document.getElementById('eventCapacity').value = event.capacity || '';
            document.getElementById('eventContact').value = event.contact || '';
            document.getElementById('eventRSVP').checked = event.rsvp_required || false;
            document.getElementById('eventPublic').checked = event.is_public || false;
            document.getElementById('eventReminder').checked = event.reminder_enabled || false;

            // ØªØ¹ÙŠÙŠÙ† ID Ù„Ù„ØªØ¹Ø¯ÙŠÙ„
            document.getElementById('eventForm').dataset.editId = eventId;
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            showEventModal();
        }

        function deleteEvent(eventId) {
            if (!app.userManager.currentUser || app.userManager.currentUser.role !== 'admin') {
                app.showToast('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ø­Ø°Ù Ø§Ù„Ø£Ø­Ø¯Ø§Ø«', 'error');
                return;
            }

            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¯Ø«ØŸ')) {
                const events = app.dataManager.getData('events');
                const filteredEvents = events.filter(e => e.id !== eventId);
                app.dataManager.setData('events', filteredEvents);
                app.showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø­Ø¯Ø« Ø¨Ù†Ø¬Ø§Ø­', 'success');
                app.renderEvents();
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø§Ù„Ø¬ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø­Ø¯Ø« Ù„Ù„Ø¯Ø¹Ù… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        function handleEventSubmit(event) {
            event.preventDefault();
            
            if (!app.userManager.currentUser) {
                app.showToast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø«', 'error');
                return;
            }

            const form = document.getElementById('eventForm');
            const editId = form.dataset.editId;

            const formData = {
                title: document.getElementById('eventTitle').value,
                type: document.getElementById('eventType').value,
                date: document.getElementById('eventDate').value,
                time: document.getElementById('eventTime').value,
                location: document.getElementById('eventLocation').value,
                description: document.getElementById('eventDescription').value,
                organizer: document.getElementById('eventOrganizer').value,
                capacity: document.getElementById('eventCapacity').value,
                contact: document.getElementById('eventContact').value,
                rsvp_required: document.getElementById('eventRSVP').checked,
                is_public: document.getElementById('eventPublic').checked,
                reminder_enabled: document.getElementById('eventReminder').checked
            };

            const events = app.dataManager.getData('events');

            if (editId) {
                // ØªØ¹Ø¯ÙŠÙ„ Ø­Ø¯Ø« Ù…ÙˆØ¬ÙˆØ¯
                const eventIndex = events.findIndex(e => e.id === editId);
                if (eventIndex !== -1) {
                    events[eventIndex] = {
                        ...events[eventIndex],
                        ...formData,
                        updated_at: new Date().toISOString().split('T')[0],
                        updated_by: app.userManager.currentUser.first_name + ' ' + app.userManager.currentUser.last_name
                    };
                    app.showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø¯Ø« Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                }
                delete form.dataset.editId;
            } else {
                // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø¬Ø¯ÙŠØ¯
                const newEvent = {
                    id: 'event_' + Date.now(),
                    ...formData,
                    created_by: app.userManager.currentUser.first_name + ' ' + app.userManager.currentUser.last_name,
                    created_at: new Date().toISOString().split('T')[0],
                    status: 'upcoming',
                    attendees: [],
                    views: 0
                };
                events.push(newEvent);
                app.showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø¯Ø« Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            }

            app.dataManager.setData('events', events);
            hideEventModal();
            app.renderEvents();
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        function showVideoUploadModal() {
            if (!app.userManager.currentUser) {
                app.showToast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø±ÙØ¹ ÙÙŠØ¯ÙŠÙˆ', 'error');
                return;
            }
            document.getElementById('videoUploadModal').classList.remove('hidden');
        }

        function hideVideoUploadModal() {
            document.getElementById('videoUploadModal').classList.add('hidden');
            document.getElementById('videoUploadForm').reset();
        }

        function handleVideoUpload(event) {
            event.preventDefault();
            
            if (!app.userManager.currentUser) {
                app.showToast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø±ÙØ¹ ÙÙŠØ¯ÙŠÙˆ', 'error');
                return;
            }

            const formData = new FormData(event.target);
            const videoFile = formData.get('videoFile');
            
            if (!videoFile || videoFile.size === 0) {
                app.showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù ÙÙŠØ¯ÙŠÙˆ', 'error');
                return;
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù
            const allowedTypes = ['video/mp4', 'video/avi', 'video/mov', 'video/wmv', 'video/webm'];
            if (!allowedTypes.includes(videoFile.type)) {
                app.showToast('Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…. ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù ÙÙŠØ¯ÙŠÙˆ ØµØ§Ù„Ø­', 'error');
                return;
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù (Ø­Ø¯ Ø£Ù‚ØµÙ‰ 100MB)
            const maxSize = 100 * 1024 * 1024; // 100MB
            if (videoFile.size > maxSize) {
                app.showToast('Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 100MB', 'error');
                return;
            }

            // Ù…Ø­Ø§ÙƒØ§Ø© Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø³ÙŠØªÙ… Ø±ÙØ¹Ù‡ Ù„Ù„Ø®Ø§Ø¯Ù…)
            const videoData = {
                id: 'video_' + Date.now(),
                type: 'video',
                title: document.getElementById('videoTitle').value,
                description: document.getElementById('videoDescription').value,
                category: document.getElementById('videoCategory').value,
                access_level: document.getElementById('videoAccess').value,
                keywords: document.getElementById('videoKeywords').value.split(',').map(k => k.trim()).filter(k => k),
                file_name: videoFile.name,
                file_size: videoFile.size,
                file_type: videoFile.type,
                duration: null, // Ø³ÙŠØªÙ… Ø­Ø³Ø§Ø¨Ù‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹
                thumbnail: null, // Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹
                uploaded_by: app.userManager.currentUser.first_name + ' ' + app.userManager.currentUser.last_name,
                uploaded_at: new Date().toISOString().split('T')[0],
                views: 0,
                likes: 0,
                featured: false,
                url: URL.createObjectURL(videoFile) // Ø±Ø§Ø¨Ø· Ù…Ø¤Ù‚Øª Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
            };

            const library = app.dataManager.getData('library');
            library.push(videoData);
            app.dataManager.setData('library', library);

            app.showToast('ØªÙ… Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            hideVideoUploadModal();
            app.renderLibrary('videos');
            
            // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
            updateVideoStats();
        }

        function playVideo(videoId) {
            const library = app.dataManager.getData('library');
            const video = library.find(v => v.id === videoId);
            
            if (!video || video.type !== 'video') {
                app.showToast('Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                return;
            }

            // Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª
            video.views = (video.views || 0) + 1;
            app.dataManager.setData('library', library);

            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø´ØºÙ„ ÙÙŠØ¯ÙŠÙˆ Ù…Ù†Ø¨Ø«Ù‚
            const videoPlayer = document.createElement('div');
            videoPlayer.className = 'fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50';
            videoPlayer.innerHTML = `
                <div class="relative max-w-4xl w-full mx-4">
                    <button onclick="this.parentElement.parentElement.remove()" class="absolute -top-10 right-0 text-white text-2xl hover:text-red-400">
                        <i class="fas fa-times"></i>
                    </button>
                    <div class="bg-white rounded-lg p-4">
                        <h3 class="text-xl font-bold mb-4">${video.title}</h3>
                        ${video.url ? `
                            <video controls class="w-full max-h-96 rounded">
                                <source src="${video.url}" type="${video.file_type}">
                                Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                            </video>
                        ` : `
                            <div class="w-full h-64 bg-gray-200 flex items-center justify-center rounded">
                                <div class="text-center">
                                    <i class="fas fa-play-circle text-6xl text-gray-400 mb-4"></i>
                                    <p class="text-gray-600">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ØºÙŠØ± Ù…ØªØ§Ø­Ø©</p>
                                    <p class="text-sm text-gray-500 mt-2">Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù: ${video.file_name}</p>
                                </div>
                            </div>
                        `}
                        <div class="mt-4 flex justify-between items-center">
                            <div class="text-sm text-gray-600">
                                <span><i class="fas fa-eye ml-1"></i>${video.views}</span>
                                <span class="mr-4"><i class="fas fa-heart ml-1"></i>${video.likes || 0}</span>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="likeVideo('${video.id}')" class="px-4 py-2 bg-red-100 text-red-700 rounded hover:bg-red-200">
                                    <i class="fas fa-heart ml-1"></i>Ø¥Ø¹Ø¬Ø§Ø¨
                                </button>
                                <button onclick="shareVideo('${video.id}')" class="px-4 py-2 bg-blue-100 text-blue-700 rounded hover:bg-blue-200">
                                    <i class="fas fa-share ml-1"></i>Ù…Ø´Ø§Ø±ÙƒØ©
                                </button>
                            </div>
                        </div>
                        ${video.description ? `<p class="mt-4 text-gray-700">${video.description}</p>` : ''}
                    </div>
                </div>
            `;
            
            document.body.appendChild(videoPlayer);
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ù„ÙÙŠØ©
            videoPlayer.addEventListener('click', (e) => {
                if (e.target === videoPlayer) {
                    videoPlayer.remove();
                }
            });
        }

        function likeVideo(videoId) {
            if (!app.userManager.currentUser) {
                app.showToast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }

            const library = app.dataManager.getData('library');
            const video = library.find(v => v.id === videoId);
            
            if (video) {
                video.likes = (video.likes || 0) + 1;
                app.dataManager.setData('library', library);
                app.showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ø¬Ø§Ø¨Ùƒ!', 'success');
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
                const likeButton = document.querySelector(`[onclick="likeVideo('${videoId}')"]`);
                if (likeButton) {
                    likeButton.innerHTML = `<i class="fas fa-heart ml-1"></i>${video.likes}`;
                }
            }
        }

        function shareVideo(videoId) {
            const library = app.dataManager.getData('library');
            const video = library.find(v => v.id === videoId);
            
            if (!video) {
                app.showToast('Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                return;
            }

            const shareText = `ğŸ¥ ${video.title}\nğŸ‘¤ Ø±ÙØ¹ Ø¨ÙˆØ§Ø³Ø·Ø©: ${video.uploaded_by}\nğŸ“… ${video.uploaded_at}\n\n${video.description || ''}`;
            
            if (navigator.share) {
                navigator.share({
                    title: video.title,
                    text: shareText,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    app.showToast('ØªÙ… Ù†Ø³Ø® Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ', 'success');
                });
            }
        }

        function formatDuration(seconds) {
            if (!seconds) return '';
            
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function updateVideoStats() {
            if (!app || !app.dataManager) return; // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø£ÙˆÙ„Ø§Ù‹
            
            const library = app.dataManager.getData('library');
            const videos = library.filter(item => item.type === 'video');
            
            const stats = {
                total: videos.length,
                totalViews: videos.reduce((sum, v) => sum + (v.views || 0), 0),
                totalLikes: videos.reduce((sum, v) => sum + (v.likes || 0), 0),
                totalSize: videos.reduce((sum, v) => sum + (v.file_size || 0), 0)
            };

            // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙÙŠ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…ÙƒØªØ¨Ø©
            const videoStatsContainer = document.getElementById('video-stats');
            if (videoStatsContainer) {
                videoStatsContainer.innerHTML = `
                    <div class="grid grid-cols-4 gap-4 mb-6">
                        <div class="text-center p-4 bg-white bg-opacity-20 rounded-lg">
                            <div class="text-2xl font-bold text-white">${stats.total}</div>
                            <div class="text-sm text-white opacity-80">Ù…Ù‚Ø§Ø·Ø¹ ÙÙŠØ¯ÙŠÙˆ</div>
                        </div>
                        <div class="text-center p-4 bg-white bg-opacity-20 rounded-lg">
                            <div class="text-2xl font-bold text-white">${stats.totalViews}</div>
                            <div class="text-sm text-white opacity-80">Ù…Ø´Ø§Ù‡Ø¯Ø©</div>
                        </div>
                        <div class="text-center p-4 bg-white bg-opacity-20 rounded-lg">
                            <div class="text-2xl font-bold text-white">${stats.totalLikes}</div>
                            <div class="text-sm text-white opacity-80">Ø¥Ø¹Ø¬Ø§Ø¨</div>
                        </div>
                        <div class="text-center p-4 bg-white bg-opacity-20 rounded-lg">
                            <div class="text-2xl font-bold text-white">${(stats.totalSize / 1024 / 1024).toFixed(1)}MB</div>
                            <div class="text-sm text-white opacity-80">Ø­Ø¬Ù… Ø§Ù„Ù…Ø­ØªÙˆÙ‰</div>
                        </div>
                    </div>
                `;
            }
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
        function showSuggestionModal() {
            document.getElementById('suggestionModal').classList.remove('hidden');
            document.getElementById('suggestionTitle').focus();
        }

        function hideSuggestionModal() {
            document.getElementById('suggestionModal').classList.add('hidden');
            document.getElementById('suggestionForm').reset();
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø¹Ø§Ù…Ø©
        function showLibraryModal() {
            if (!app.userManager.currentUser) {
                app.showToast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰', 'error');
                return;
            }
            document.getElementById('libraryModal').classList.remove('hidden');
        }

        function hideLibraryModal() {
            document.getElementById('libraryModal').classList.add('hidden');
            document.getElementById('libraryForm').reset();
        }

        function filterLibraryByType(type) {
            app.renderLibrary(type);
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ø´Ø·Ø©
            document.querySelectorAll('[data-filter]').forEach(btn => {
                btn.classList.remove('bg-white', 'text-blue-600');
                btn.classList.add('bg-white', 'bg-opacity-20', 'text-white');
            });
            
            const activeBtn = document.querySelector(`[data-filter="${type}"]`);
            if (activeBtn) {
                activeBtn.classList.remove('bg-opacity-20', 'text-white');
                activeBtn.classList.add('bg-white', 'text-blue-600');
            }
        }

        function resetSuggestionForm() {
            document.getElementById('suggestionForm').reset();
            document.getElementById('suggestionTitle').focus();
        }

        function handleSuggestionSubmit(event) {
            event.preventDefault();
            
            if (!app.userManager.currentUser) {
                app.showToast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù‚ØªØ±Ø§Ø­', 'error');
                return;
            }

            const formData = {
                title: document.getElementById('suggestionTitle').value,
                category: document.getElementById('suggestionCategory').value,
                priority: document.getElementById('suggestionPriority').value,
                description: document.getElementById('suggestionDescription').value,
                benefits: document.getElementById('suggestionBenefits').value,
                budget: document.getElementById('suggestionBudget').value,
                timeline: document.getElementById('suggestionTimeline').value,
                resources: document.getElementById('suggestionResources').value
            };

            const suggestion = {
                id: 'sugg_' + Date.now(),
                ...formData,
                status: 'pending',
                submitted_by: app.userManager.currentUser.first_name + ' ' + app.userManager.currentUser.last_name,
                submitted_date: new Date().toISOString().split('T')[0],
                votes: { up: 0, down: 0 },
                comments: []
            };

            const suggestions = app.dataManager.getData('suggestions');
            suggestions.push(suggestion);
            app.dataManager.setData('suggestions', suggestions);
            
            app.showToast('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            hideSuggestionModal();
            app.renderSuggestions();
            app.updateStats();
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©
        function showLibraryModal() {
            document.getElementById('libraryModal').classList.remove('hidden');
            document.getElementById('libraryTitle').focus();
        }

        function hideLibraryModal() {
            document.getElementById('libraryModal').classList.add('hidden');
            document.getElementById('libraryForm').reset();
        }

        function resetLibraryForm() {
            document.getElementById('libraryForm').reset();
            document.getElementById('libraryTitle').focus();
        }

        function handleLibrarySubmit(event) {
            event.preventDefault();
            
            if (!app.userManager.currentUser) {
                app.showToast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰ Ù„Ù„Ù…ÙƒØªØ¨Ø©', 'error');
                return;
            }

            const formData = {
                title: document.getElementById('libraryTitle').value,
                type: document.getElementById('libraryType').value,
                category: document.getElementById('libraryCategory').value,
                author: document.getElementById('libraryAuthor').value || (app.userManager.currentUser.first_name + ' ' + app.userManager.currentUser.last_name),
                description: document.getElementById('libraryDescription').value,
                keywords: document.getElementById('libraryKeywords').value.split(',').map(k => k.trim()).filter(k => k),
                created_date: document.getElementById('libraryDate').value || new Date().toISOString().split('T')[0],
                language: document.getElementById('libraryLanguage').value,
                url: document.getElementById('libraryUrl').value,
                access_level: document.getElementById('libraryAccess').value,
                featured: document.getElementById('libraryFeatured').checked
            };

            const libraryItem = {
                id: 'lib_' + Date.now(),
                ...formData,
                views: 0,
                downloads: 0,
                added_by: app.userManager.currentUser.email,
                added_date: new Date().toISOString().split('T')[0]
            };

            const library = app.dataManager.getData('library');
            library.push(libraryItem);
            app.dataManager.setData('library', library);
            
            app.showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù„Ù…ÙƒØªØ¨Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            hideLibraryModal();
            app.renderLibrary();
            app.updateStats();
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
        function voteSuggestion(suggestionId, voteType) {
            if (!app.userManager.currentUser) {
                app.showToast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ØªØµÙˆÙŠØª', 'error');
                return;
            }

            const suggestions = app.dataManager.getData('suggestions');
            const suggestion = suggestions.find(s => s.id === suggestionId);
            
            if (suggestion) {
                if (voteType === 'up') {
                    suggestion.votes.up++;
                    app.showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ ØµÙˆØªÙƒ Ù…Ø¹ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­', 'success');
                } else {
                    suggestion.votes.down++;
                    app.showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ ØµÙˆØªÙƒ Ø¶Ø¯ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­', 'warning');
                }
                
                app.dataManager.setData('suggestions', suggestions);
                app.renderSuggestions();
            }
        }

        function updateSuggestionStatus(suggestionId, newStatus) {
            if (!app.userManager.currentUser || app.userManager.currentUser.role !== 'admin') {
                app.showToast('ØºÙŠØ± Ù…Ø®ÙˆÙ„ Ù„ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª', 'error');
                return;
            }

            const suggestions = app.dataManager.getData('suggestions');
            const suggestion = suggestions.find(s => s.id === suggestionId);
            
            if (suggestion) {
                suggestion.status = newStatus;
                app.dataManager.setData('suggestions', suggestions);
                app.renderSuggestions();
                app.showToast(`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­ Ø¥Ù„Ù‰: ${newStatus}`, 'success');
            }
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©
        function openLibraryItem(itemId) {
            const library = app.dataManager.getData('library');
            const item = library.find(i => i.id === itemId);
            
            if (!item) return;

            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©
            item.views = (item.views || 0) + 1;
            app.dataManager.setData('library', library);
            
            if (item.url && item.url !== '#') {
                window.open(item.url, '_blank');
                app.showToast(`ØªÙ… ÙØªØ­: ${item.title}`, 'success');
                app.renderLibrary();
            } else {
                app.showToast('Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…ØªÙˆÙØ± Ø­Ø§Ù„ÙŠØ§Ù‹', 'warning');
            }
        }

        function downloadLibraryItem(itemId) {
            const library = app.dataManager.getData('library');
            const item = library.find(i => i.id === itemId);
            
            if (!item) return;

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„
            if (!app.checkLibraryAccess(item)) {
                app.showToast('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­ØªÙˆÙ‰', 'error');
                return;
            }

            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ­Ù…ÙŠÙ„
            item.downloads = (item.downloads || 0) + 1;
            app.dataManager.setData('library', library);
            
            if (item.url && item.url !== '#') {
                // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
                const link = document.createElement('a');
                link.href = item.url;
                link.download = item.title;
                link.click();
                
                app.showToast(`ØªÙ… Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„: ${item.title}`, 'success');
                app.renderLibrary();
            } else {
                app.showToast('Ù…Ù„Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„ ØºÙŠØ± Ù…ØªÙˆÙØ± Ø­Ø§Ù„ÙŠØ§Ù‹', 'warning');
            }
        }

        // ÙˆØ¸Ø§Ø¦Ù Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        function showVideoUploadModal() {
            if (!app.userManager.currentUser) {
                app.showToast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª', 'error');
                return;
            }
            
            document.getElementById('videoUploadModal').classList.remove('hidden');
            document.getElementById('videoTitle').focus();
            
            // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ ÙƒØ§ÙØªØ±Ø§Ø¶ÙŠ
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('videoDate').value = today;
        }

        function hideVideoUploadModal() {
            document.getElementById('videoUploadModal').classList.add('hidden');
            document.getElementById('videoUploadForm').reset();
            
            // Ø¥Ø®ÙØ§Ø¡ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
            document.getElementById('videoPreview').classList.add('hidden');
        }

        function resetVideoForm() {
            document.getElementById('videoUploadForm').reset();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('videoDate').value = today;
            document.getElementById('videoPreview').classList.add('hidden');
            document.getElementById('videoTitle').focus();
        }

        function handleVideoFileSelect(input) {
            const file = input.files[0];
            if (!file) return;

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù
            if (!file.type.startsWith('video/')) {
                app.showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù ÙÙŠØ¯ÙŠÙˆ ØµØ­ÙŠØ­', 'error');
                return;
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù (100MB)
            const maxSize = 100 * 1024 * 1024;
            if (file.size > maxSize) {
                app.showToast('Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 100MB', 'error');
                return;
            }

            // Ø¹Ø±Ø¶ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
            const videoPreview = document.getElementById('videoPreview');
            const previewVideo = document.getElementById('previewVideo');
            const videoSource = document.getElementById('videoSource');
            const fileName = document.getElementById('videoFileName');

            const fileURL = URL.createObjectURL(file);
            videoSource.src = fileURL;
            previewVideo.load();
            fileName.textContent = `Ø§Ù„Ù…Ù„Ù: ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`;
            
            videoPreview.classList.remove('hidden');
        }

        function handleVideoUpload(event) {
            event.preventDefault();
            
            const fileInput = document.getElementById('videoFile');
            const file = fileInput.files[0];
            
            if (!file) {
                app.showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù ÙÙŠØ¯ÙŠÙˆ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }

            const formData = {
                title: document.getElementById('videoTitle').value,
                date: document.getElementById('videoDate').value,
                description: document.getElementById('videoDescription').value,
                category: document.getElementById('videoCategory').value,
                privacy: document.getElementById('videoPrivacy').value,
                tags: document.getElementById('videoTags').value,
                featured: document.getElementById('videoFeatured').checked
            };

            // Ù…Ø­Ø§ÙƒØ§Ø© Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø³ÙŠØªÙ… Ø±ÙØ¹Ù‡ Ù„Ø®Ø¯Ù…Ø© Ø³Ø­Ø§Ø¨ÙŠØ©)
            const videoItem = {
                id: 'video_' + Date.now(),
                type: 'video',
                ...formData,
                file_name: file.name,
                file_size: file.size,
                file_type: file.type,
                url: URL.createObjectURL(file), // Ù…Ø¤Ù‚Øª - ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø³ÙŠÙƒÙˆÙ† Ø±Ø§Ø¨Ø· Ø§Ù„Ø³Ø­Ø§Ø¨Ø©
                thumbnail: '', // Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
                duration: 0, // Ø³ÙŠØªÙ… Ø­Ø³Ø§Ø¨Ù‡
                views: 0,
                likes: 0,
                uploaded_by: app.userManager.currentUser.first_name + ' ' + app.userManager.currentUser.last_name,
                uploaded_at: new Date().toISOString().split('T')[0],
                status: 'active'
            };

            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù„Ù„Ù…ÙƒØªØ¨Ø©
            const library = app.dataManager.getData('library');
            library.push(videoItem);
            app.dataManager.setData('library', library);
            
            app.showToast('ØªÙ… Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            hideVideoUploadModal();
            app.renderLibrary();
            
            // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
            updateVideoStats();
        }

        function switchLibraryTab(tab) {
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ§Ø¨Ø§Øª
            document.querySelectorAll('.library-tab').forEach(btn => {
                btn.classList.remove('text-blue-600', 'border-b-2', 'border-blue-600');
                btn.classList.add('text-gray-600');
            });
            
            // ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ§Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ
            const activeTab = document.getElementById(`tab-${tab}`);
            activeTab.classList.remove('text-gray-600');
            activeTab.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
            app.renderLibrary(tab);
        }

        function updateVideoStats() {
            if (!app || !app.dataManager) return; // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø£ÙˆÙ„Ø§Ù‹
            
            const library = app.dataManager.getData('library');
            const videos = library.filter(item => item.type === 'video');
            
            const totalVideos = videos.length;
            const totalViews = videos.reduce((sum, video) => sum + (video.views || 0), 0);
            const thisMonth = new Date().toISOString().slice(0, 7); // YYYY-MM
            const recentUploads = videos.filter(video => video.uploaded_at?.startsWith(thisMonth)).length;
            const featuredVideos = videos.filter(video => video.featured).length;
            
            document.getElementById('total-videos').textContent = totalVideos;
            document.getElementById('total-views').textContent = totalViews;
            document.getElementById('recent-uploads').textContent = recentUploads;
            document.getElementById('featured-videos').textContent = featuredVideos;
        }

        function playVideo(videoId) {
            const library = app.dataManager.getData('library');
            const video = library.find(item => item.id === videoId && item.type === 'video');
            
            if (!video) return;
            
            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©
            video.views = (video.views || 0) + 1;
            app.dataManager.setData('library', library);
            
            // ÙØªØ­ Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ù…ÙˆØ¯Ø§Ù„)
            showVideoPlayer(video);
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            updateVideoStats();
        }

        function showVideoPlayer(video) {
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙˆØ¯Ø§Ù„ Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden">
                    <div class="flex justify-between items-center p-4 border-b border-gray-200">
                        <h3 class="text-xl font-bold text-gray-800">${video.title}</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-500 hover:text-gray-700 text-2xl">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="p-4">
                        <video controls class="w-full rounded-lg mb-4" autoplay>
                            <source src="${video.url}" type="${video.file_type}">
                            Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ.
                        </video>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600">
                            <div><strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ${video.date}</div>
                            <div><strong>Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª:</strong> ${video.views}</div>
                            <div><strong>Ø§Ù„ÙØ¦Ø©:</strong> ${getVideoCategoryText(video.category)}</div>
                            <div><strong>Ø±ÙØ¹ Ø¨ÙˆØ§Ø³Ø·Ø©:</strong> ${video.uploaded_by}</div>
                        </div>
                        ${video.description ? `<div class="mt-4"><strong>Ø§Ù„ÙˆØµÙ:</strong><p class="text-gray-700 mt-2">${video.description}</p></div>` : ''}
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        function getVideoCategoryText(category) {
            const categories = {
                'family_gathering': 'ØªØ¬Ù…Ø¹ Ø¹Ø§Ø¦Ù„ÙŠ',
                'wedding': 'Ø²ÙØ§Ù',
                'celebration': 'Ø§Ø­ØªÙØ§Ù„',
                'graduation': 'ØªØ®Ø±Ø¬',
                'birthday': 'Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯',
                'religious': 'Ù…Ù†Ø§Ø³Ø¨Ø© Ø¯ÙŠÙ†ÙŠØ©',
                'travel': 'Ø³ÙØ± ÙˆØ±Ø­Ù„Ø§Øª',
                'other': 'Ø£Ø®Ø±Ù‰'
            };
            return categories[category] || category;
        }

        function formatDuration(seconds) {
            if (!seconds) return '';
            
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            
            if (minutes < 60) {
                return `${minutes}:${secs.toString().padStart(2, '0')}`;
            } else {
                const hours = Math.floor(minutes / 60);
                const mins = minutes % 60;
                return `${hours}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }
        }

        function searchLibrary(query) {
            const library = app.dataManager.getData('library');
            const container = document.getElementById('library-grid');
            
            if (!query.trim()) {
                app.renderLibrary();
                return;
            }

            const filteredLibrary = library.filter(item => 
                item.title.toLowerCase().includes(query.toLowerCase()) ||
                item.description.toLowerCase().includes(query.toLowerCase()) ||
                item.author.toLowerCase().includes(query.toLowerCase()) ||
                (item.keywords && item.keywords.some(keyword => 
                    keyword.toLowerCase().includes(query.toLowerCase())
                ))
            );

            if (filteredLibrary.length === 0) {
                container.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <div class="text-6xl text-white mb-4 opacity-50">
                            <i class="fas fa-search"></i>
                        </div>
                        <p class="text-white text-xl mb-4">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬ Ù„Ù„Ø¨Ø­Ø«: "${query}"</p>
                        <button onclick="app.renderLibrary()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700">
                            Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª
                        </button>
                    </div>
                `;
            } else {
                container.innerHTML = filteredLibrary.map(item => app.renderLibraryCard(item)).join('');
            }
        }

        function filterLibraryByCategory(category) {
            const library = app.dataManager.getData('library');
            const container = document.getElementById('library-grid');
            
            if (!category || category === 'all') {
                app.renderLibrary();
                return;
            }

            const filteredLibrary = library.filter(item => item.category === category);
            container.innerHTML = filteredLibrary.map(item => app.renderLibraryCard(item)).join('');
        }

        // ÙˆØ¸Ø§Ø¦Ù ÙÙ„ØªØ±Ø© Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
        function filterSuggestionsByStatus(status) {
            const suggestions = app.dataManager.getData('suggestions');
            const container = document.getElementById('suggestions-grid');
            
            if (!status || status === 'all') {
                app.renderSuggestions();
                return;
            }

            const filteredSuggestions = suggestions.filter(item => item.status === status);
            container.innerHTML = filteredSuggestions.map(item => app.renderSuggestionCard(item)).join('');
        }

        function filterSuggestionsByCategory(category) {
            const suggestions = app.dataManager.getData('suggestions');
            const container = document.getElementById('suggestions-grid');
            
            if (!category || category === 'all') {
                app.renderSuggestions();
                return;
            }

            const filteredSuggestions = suggestions.filter(item => item.category === category);
            container.innerHTML = filteredSuggestions.map(item => app.renderSuggestionCard(item)).join('');
        }

        function filterSuggestionsByPriority(priority) {
            const suggestions = app.dataManager.getData('suggestions');
            const container = document.getElementById('suggestions-grid');
            
            if (!priority || priority === 'all') {
                app.renderSuggestions();
                return;
            }

            const filteredSuggestions = suggestions.filter(item => item.priority === priority);
            container.innerHTML = filteredSuggestions.map(item => app.renderSuggestionCard(item)).join('');
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„
        function showLoginModal() {
            console.log('ğŸ” Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¯Ø®ÙˆÙ„...');
            
            // Ù…Ù†Ø¹ Ø£ÙŠ event listeners Ù…Ù† Ø§Ù„ØªØ¯Ø®Ù„ Ù…Ø¤Ù‚ØªØ§Ù‹ (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ event)
            if (typeof event !== 'undefined' && event.stopPropagation) {
                event.stopPropagation();
            }
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø£Ø®Ø±Ù‰ Ø£ÙˆÙ„Ø§Ù‹
            hideAllModals();
            
            const modal = document.getElementById('loginModal');
            if (modal) {
                modal.classList.remove('hidden');
                modal.style.display = 'flex';
                
                setTimeout(() => {
                    document.getElementById('loginIdentifier').focus();
                }, 100);
                console.log('âœ… ØªÙ… Ø¹Ø±Ø¶ Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­');
            }
        }

        function showRegisterModal() {
            console.log('ğŸ” Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...');
            
            // Ù…Ù†Ø¹ Ø£ÙŠ event listeners Ù…Ù† Ø§Ù„ØªØ¯Ø®Ù„ Ù…Ø¤Ù‚ØªØ§Ù‹
            if (typeof event !== 'undefined' && event.stopPropagation) {
                event.stopPropagation();
            }
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø£Ø®Ø±Ù‰ Ø£ÙˆÙ„Ø§Ù‹
            hideAllModals();
            
            const modal = document.getElementById('registerModal');
            if (modal) {
                modal.classList.remove('hidden');
                modal.style.display = 'flex';
                
                setTimeout(() => {
                    document.getElementById('registerFirstName').focus();
                }, 100);
                console.log('âœ… ØªÙ… Ø¹Ø±Ø¶ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­');
            }
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
        function hideAllModals() {
            const modals = ['loginModal', 'registerModal', 'familyModal', 'eventModal', 'suggestionModal', 'videoUploadModal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (modal && !modal.classList.contains('hidden')) {
                    modal.classList.add('hidden');
                    modal.style.display = 'none';
                }
            });
        }

        function hideLoginModal() {
            console.log('ğŸšª Ø¥Ø®ÙØ§Ø¡ Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...');
            const modal = document.getElementById('loginModal');
            const form = document.getElementById('loginForm');
            
            if (modal) {
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙÙˆØ±Ø§Ù‹
                modal.classList.add('hidden');
                modal.style.display = 'none'; // Ø¥Ø¶Ø§ÙØ© Ø­Ù…Ø§ÙŠØ© Ø¥Ø¶Ø§ÙÙŠØ©
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                if (form) {
                    form.reset();
                }
                
                console.log('âœ… ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­');
            } else {
                console.error('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„');
            }
        }

        // ØªØ´Ø®ÙŠØµ Ø´Ø§Ù…Ù„ Ù„Ù„Ù…Ø´ÙƒÙ„Ø©
        function diagnoseModalProblem() {
            console.log('ğŸ” Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´Ø®ÙŠØµ Ø§Ù„Ø´Ø§Ù…Ù„...');
            
            const modal = document.getElementById('registerModal');
            if (!modal) {
                console.error('âŒ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!');
                return;
            }
            
            console.log('ğŸ“Š Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø­Ø§Ù„ÙŠØ©:');
            console.log('   - classList:', modal.classList.toString());
            console.log('   - style.display:', modal.style.display);
            console.log('   - style.visibility:', modal.style.visibility);
            console.log('   - offsetWidth:', modal.offsetWidth);
            console.log('   - offsetHeight:', modal.offsetHeight);
            
            // ØªØ³Ø¬ÙŠÙ„ Ø¬Ù…ÙŠØ¹ event listeners
            console.log('ğŸ“‹ ÙØ­Øµ Event Listeners...');
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ Ø¨Ø¯ÙˆÙ† Ø£ÙŠ event listeners
            console.log('ğŸš€ Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬...');
            
            // Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ classes
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal';
            
            // ØªØ¹ÙŠÙŠÙ† Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ù€ styles
            modal.style.cssText = `
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                right: 0 !important;
                bottom: 0 !important;
                background: rgba(0, 0, 0, 0.5) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 9999 !important;
                visibility: visible !important;
                opacity: 1 !important;
            `;
            
            // Ù…Ø±Ø§Ù‚Ø¨Ø© ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    if (mutation.type === 'attributes') {
                        console.log('ğŸ”„ ØªØºÙŠÙŠØ± Ù…ÙƒØªØ´Ù:', mutation.attributeName, 'â†’', mutation.target[mutation.attributeName]);
                        
                        // Ù…Ù†Ø¹ Ø£ÙŠ ØªØºÙŠÙŠØ± ÙŠØ®ÙÙŠ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                        if (mutation.attributeName === 'class' && modal.classList.contains('hidden')) {
                            console.warn('âš ï¸ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø®ÙØ§Ø¡ Ø¨Ù€ hidden class - Ù…Ù†Ø¹!');
                            modal.classList.remove('hidden');
                        }
                        
                        if (mutation.attributeName === 'style' && modal.style.display === 'none') {
                            console.warn('âš ï¸ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø®ÙØ§Ø¡ Ø¨Ù€ display none - Ù…Ù†Ø¹!');
                            modal.style.display = 'flex';
                        }
                    }
                });
            });
            
            observer.observe(modal, {
                attributes: true,
                attributeOldValue: true
            });
            
            // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨ Ø¨Ø¹Ø¯ 10 Ø«ÙˆØ§Ù†
            setTimeout(() => {
                observer.disconnect();
                console.log('ğŸ”š Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©');
            }, 10000);
            
            console.log('âœ… ØªÙ… ÙØªØ­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ù…Ø¹ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù†Ø´Ø·Ø©');
        }

        // Ø¯Ø§Ù„Ø© Ù‚ÙˆÙŠØ© Ø¨Ø¯ÙŠÙ„Ø© Ù„ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
        function forceShowRegisterModal() {
            // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„ØªØ´Ø®ÙŠØµ Ø§Ù„Ø´Ø§Ù…Ù„
            diagnoseModalProblem();
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø³ÙŠØ·
        function createTestModal() {
            console.log('ğŸ§ª Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø³ÙŠØ·...');
            
            // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ù†Ù…ÙˆØ°Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø§Ø¨Ù‚
            const existingTest = document.getElementById('testModal');
            if (existingTest) {
                existingTest.remove();
            }
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø¬Ø¯ÙŠØ¯
            const testModal = document.createElement('div');
            testModal.id = 'testModal';
            testModal.innerHTML = `
                <div style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0, 0, 0, 0.8);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 99999;
                ">
                    <div style="
                        background: white;
                        padding: 40px;
                        border-radius: 10px;
                        max-width: 500px;
                        width: 90%;
                        text-align: center;
                    ">
                        <h2 style="color: #333; margin-bottom: 20px;">Ù†Ù…ÙˆØ°Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø³ÙŠØ·</h2>
                        <p style="margin-bottom: 20px;">Ù‡Ø°Ø§ Ù†Ù…ÙˆØ°Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ù„Ø§ ÙŠØ³ØªØ®Ø¯Ù… Ø£ÙŠ JavaScript Ù…Ø¹Ù‚Ø¯</p>
                        <input type="text" placeholder="Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Øµ" style="
                            width: 100%;
                            padding: 10px;
                            margin: 10px 0;
                            border: 1px solid #ccc;
                            border-radius: 5px;
                        ">
                        <br>
                        <button onclick="closeTestModal()" style="
                            background: #ef4444;
                            color: white;
                            padding: 10px 20px;
                            border: none;
                            border-radius: 5px;
                            cursor: pointer;
                            margin: 10px;
                        ">Ø¥ØºÙ„Ø§Ù‚</button>
                        <button onclick="alert('Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙŠØ¹Ù…Ù„!')" style="
                            background: #10b981;
                            color: white;
                            padding: 10px 20px;
                            border: none;
                            border-radius: 5px;
                            cursor: pointer;
                            margin: 10px;
                        ">Ø§Ø®ØªØ¨Ø§Ø±</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(testModal);
            console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø³ÙŠØ·');
        }
        
        function closeTestModal() {
            const testModal = document.getElementById('testModal');
            if (testModal) {
                testModal.remove();
                console.log('âœ… ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±');
            }
        }

        function showRegisterModal() {
            console.log('ğŸ” Ø¨Ø¯Ø¡ ØªØ´Ø®ÙŠØµ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬...');
            console.trace('ğŸ“ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø¯Ø§Ù„Ø© Ù…Ù†:');
            
            try {
                // ØªØ³Ø¬ÙŠÙ„ Ø­Ø§Ù„Ø© Event
                if (typeof event !== 'undefined') {
                    console.log('ğŸ“± Event Ù…ØªÙˆÙØ±:', event.type, event.target);
                    event.stopPropagation();
                    event.preventDefault();
                } else {
                    console.log('ğŸ“± Ù„Ø§ ÙŠÙˆØ¬Ø¯ Event');
                }
                
                const modal = document.getElementById('registerModal');
                if (!modal) {
                    console.error('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ registerModal');
                    alert('Ø®Ø·Ø£: Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                    return;
                }
                
                console.log('ğŸ“Š Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ù‚Ø¨Ù„ Ø§Ù„ÙØªØ­:');
                console.log('   - classList:', modal.classList.toString());
                console.log('   - display:', modal.style.display);
                console.log('   - visibility:', modal.style.visibility);
                console.log('   - opacity:', modal.style.opacity);
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ÙØªØ­ Ù…Ø¹ ØªØ³Ø¬ÙŠÙ„ ÙƒÙ„ Ø®Ø·ÙˆØ©
                console.log('ğŸ”“ Ø¥Ø²Ø§Ù„Ø© hidden...');
                modal.classList.remove('hidden');
                console.log('   âœ“ Ø¨Ø¹Ø¯ Ø¥Ø²Ø§Ù„Ø© hidden:', modal.classList.toString());
                
                console.log('ğŸ‘ï¸ ØªØ¹ÙŠÙŠÙ† display...');
                modal.style.display = 'flex';
                console.log('   âœ“ Ø¨Ø¹Ø¯ ØªØ¹ÙŠÙŠÙ† display:', modal.style.display);
                
                console.log('ğŸ“Š Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø¹Ø¯ Ø§Ù„ÙØªØ­:');
                console.log('   - classList:', modal.classList.toString());
                console.log('   - display:', modal.style.display);
                console.log('   - offsetWidth:', modal.offsetWidth);
                console.log('   - offsetHeight:', modal.offsetHeight);
                
                // ÙØ­Øµ Ø³Ø±ÙŠØ¹ Ø¨Ø¹Ø¯ 1ms
                setTimeout(() => {
                    console.log('ğŸš¨ ÙØ­Øµ ÙÙˆØ±ÙŠ (1ms):');
                    console.log('   - classList:', modal.classList.toString());
                    console.log('   - display:', modal.style.display);
                    console.log('   - Ù…Ø±Ø¦ÙŠØŸ:', modal.offsetWidth > 0);
                }, 1);
                
                // ÙØ­Øµ Ø¨Ø¹Ø¯ 10ms
                setTimeout(() => {
                    console.log('ğŸš¨ ÙØ­Øµ Ø³Ø±ÙŠØ¹ (10ms):');
                    console.log('   - classList:', modal.classList.toString());
                    console.log('   - display:', modal.style.display);
                    console.log('   - Ù…Ø±Ø¦ÙŠØŸ:', modal.offsetWidth > 0);
                    
                    if (modal.classList.contains('hidden') || modal.style.display === 'none') {
                        console.error('âŒ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ø®ØªÙÙ‰ ÙÙŠ 10ms!');
                        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙØªØ­
                        modal.classList.remove('hidden');
                        modal.style.display = 'flex';
                    }
                }, 10);
                
                // ÙØ­Øµ Ø¨Ø¹Ø¯ 50ms
                setTimeout(() => {
                    console.log('ğŸš¨ ÙØ­Øµ Ù…ØªÙˆØ³Ø· (50ms):');
                    console.log('   - classList:', modal.classList.toString());
                    console.log('   - display:', modal.style.display);
                    console.log('   - Ù…Ø±Ø¦ÙŠØŸ:', modal.offsetWidth > 0);
                    
                    if (modal.classList.contains('hidden') || modal.style.display === 'none') {
                        console.error('âŒ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ø®ØªÙÙ‰ ÙÙŠ 50ms!');
                    }
                }, 50);
                
                console.log('âœ… Ø§Ù†ØªÙ‡Øª Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬');
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„:', error);
                console.error('Stack:', error.stack);
            }
        }

        function hideRegisterModal() {
            console.log('ğŸšª Ø¥Ø®ÙØ§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...');
            const modal = document.getElementById('registerModal');
            const form = document.getElementById('registerForm');
            
            if (modal) {
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙÙˆØ±Ø§Ù‹
                modal.classList.add('hidden');
                modal.style.display = 'none'; // Ø¥Ø¶Ø§ÙØ© Ø­Ù…Ø§ÙŠØ© Ø¥Ø¶Ø§ÙÙŠØ©
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                if (form) {
                    form.reset();
                    updateRegisterFullNamePreview();
                }
                
                console.log('âœ… ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­');
            } else {
                console.error('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„');
            }
        }

        function resetRegisterForm() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) {
                document.getElementById('registerForm').reset();
                updateRegisterFullNamePreview();
                app?.showToast('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬', 'warning');
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø§Ø³Ù… ÙÙŠ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
        function updateRegisterFullNamePreview() {
            const firstName = document.getElementById('registerFirstName')?.value.trim() || '';
            const middleName = document.getElementById('registerMiddleName')?.value.trim() || '';
            const lastName = document.getElementById('registerLastName')?.value.trim() || '';
            
            let fullName = firstName;
            if (middleName) fullName += ` ${middleName}`;
            if (lastName) fullName += ` ${lastName}`;
            
            const preview = document.getElementById('registerFullNamePreview');
            if (preview) {
                preview.textContent = fullName || 'Ø³ÙŠØªÙ… ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø§Ø³Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹...';
            }
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        function approveUser(userId) {
            if (!app || !app.userManager.currentUser || app.userManager.currentUser.role !== 'admin') {
                alert('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡');
                return;
            }

            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ')) {
                try {
                    app.userManager.approveUser(userId, app.userManager.currentUser.id);
                    app.displayAdminPanel();
                    app.showToast('ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­', 'success');
                } catch (error) {
                    app.showToast('Ø­Ø¯Ø« Ø®Ø·Ø£: ' + error.message, 'error');
                }
            }
        }

        function rejectUser(userId) {
            if (!app || !app.userManager.currentUser || app.userManager.currentUser.role !== 'admin') {
                alert('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡');
                return;
            }

            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ÙØ¶ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø·Ù„Ø¨Ù‡ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹.')) {
                try {
                    app.userManager.rejectUser(userId, app.userManager.currentUser.id);
                    app.displayAdminPanel();
                    app.showToast('ØªÙ… Ø±ÙØ¶ Ø·Ù„Ø¨ Ø§Ù„ØªØ³Ø¬ÙŠÙ„', 'warning');
                } catch (error) {
                    app.showToast('Ø­Ø¯Ø« Ø®Ø·Ø£: ' + error.message, 'error');
                }
            }
        }

        function refreshPendingUsers() {
            if (app) {
                app.displayAdminPanel();
                app.showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª', 'success');
            }
        }

        // === ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ù†Ø´Ø·ÙŠÙ† ===
        
        // Ø­Ø°Ù Ø¹Ø¶Ùˆ Ù†Ø´Ø·
        function deleteActiveMember(userId, userName) {
            if (!app || !app.userManager.currentUser || app.userManager.currentUser.role !== 'admin') {
                app.showToast('ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ù„Ùƒ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡', 'error');
                return;
            }

            // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… Ø­Ø°Ù Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„ÙˆØ­ÙŠØ¯
            const activeUsers = app.userManager.getActiveUsers();
            const admins = activeUsers.filter(user => user.role === 'admin');
            const userToDelete = activeUsers.find(user => user.id === userId);
            
            if (userToDelete && userToDelete.role === 'admin' && admins.length === 1) {
                app.showToast('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„ÙˆØ­ÙŠØ¯ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…', 'error');
                return;
            }

            // ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù Ù…Ø¹ Ø£Ù…Ø§Ù† Ø¥Ø¶Ø§ÙÙŠ
            const confirmMessage = `âš ï¸ ØªØ­Ø°ÙŠØ±: Ø¹Ù…Ù„ÙŠØ© Ø­Ø°Ù Ø§Ù„Ø¹Ø¶Ùˆ Ù†Ù‡Ø§Ø¦ÙŠØ© ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡Ø§!\n\n` +
                                 `Ø§Ù„Ø¹Ø¶Ùˆ Ø§Ù„Ù…Ø±Ø§Ø¯ Ø­Ø°ÙÙ‡: ${userName}\n` +
                                 `Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ø¶Ùˆ: ${userId}\n\n` +
                                 `Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ`;

            if (!confirm(confirmMessage)) {
                return;
            }

            // ØªØ£ÙƒÙŠØ¯ Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„Ø£Ù…Ø§Ù†
            const doubleConfirm = `Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø£Ø®ÙŠØ±!\n\n` +
                                `Ø³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ø¶Ùˆ "${userName}" Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹.\n\n` +
                                `Ø§ÙƒØªØ¨ "Ø­Ø°Ù" Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©:`;
            
            const userInput = prompt(doubleConfirm);
            if (userInput !== 'Ø­Ø°Ù') {
                app.showToast('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø­Ø°Ù', 'info');
                return;
            }

            try {
                // Ø­Ø°Ù Ø§Ù„Ø¹Ø¶Ùˆ
                const success = app.userManager.deleteUser(userId);
                
                if (success) {
                    app.showToast(`âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ø¶Ùˆ "${userName}" Ø¨Ù†Ø¬Ø§Ø­`, 'success');
                    
                    // ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                    app.displayAdminPanel();
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„ØªØºÙŠÙŠØ±
                    app.dataManager.createBackup();
                } else {
                    throw new Error('ÙØ´Ù„ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¹Ø¶Ùˆ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                }
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¹Ø¶Ùˆ:', error);
                app.showToast(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¹Ø¶Ùˆ: ${error.message}`, 'error');
            }
        }

        // ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø¶Ùˆ Ù†Ø´Ø·
        function editActiveMember(userId) {
            if (!app || !app.userManager.currentUser || app.userManager.currentUser.role !== 'admin') {
                app.showToast('ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ù„Ùƒ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡', 'error');
                return;
            }

            const user = app.userManager.getUserById(userId);
            if (!user) {
                app.showToast('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø¶Ùˆ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨', 'error');
                return;
            }

            // ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            populateMemberEditForm(user);
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            showMemberEditModal();
        }

        // ØªØ¹Ø¨Ø¦Ø© Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ø¶Ùˆ
        function populateMemberEditForm(user) {
            document.getElementById('editMemberId').value = user.id || '';
            document.getElementById('editFirstName').value = user.first_name || '';
            document.getElementById('editMiddleName').value = user.middle_name || '';
            document.getElementById('editLastName').value = user.last_name || '';
            document.getElementById('editEmail').value = user.email || '';
            document.getElementById('editPhone').value = user.phone || '';
            document.getElementById('editCity').value = user.city || '';
            document.getElementById('editDistrict').value = user.district || '';
            document.getElementById('editCountry').value = user.country || '';
            document.getElementById('editRole').value = user.role || 'user';
            document.getElementById('editStatus').value = user.status || 'active';
            document.getElementById('editBirthDate').value = user.birth_date || '';
            document.getElementById('editGender').value = user.gender || '';
            document.getElementById('editNotes').value = user.notes || '';
        }

        // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ø¶Ùˆ
        function showMemberEditModal() {
            const modal = document.getElementById('memberEditModal');
            if (modal) {
                modal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            }
        }

        // Ø¥Ø®ÙØ§Ø¡ Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ø¶Ùˆ
        function hideMemberEditModal() {
            const modal = document.getElementById('memberEditModal');
            if (modal) {
                modal.classList.add('hidden');
                document.body.style.overflow = 'auto';
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                document.getElementById('memberEditForm').reset();
            }
        }

        // Ø­ÙØ¸ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ
        function saveMemberChanges(event) {
            event.preventDefault();

            if (!app || !app.userManager.currentUser || app.userManager.currentUser.role !== 'admin') {
                app.showToast('ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ù„Ùƒ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡', 'error');
                return;
            }

            const userId = document.getElementById('editMemberId').value;
            if (!userId) {
                app.showToast('Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ø¶Ùˆ Ù…ÙÙ‚ÙˆØ¯', 'error');
                return;
            }

            try {
                // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                const updatedData = {
                    id: userId,
                    first_name: document.getElementById('editFirstName').value.trim(),
                    middle_name: document.getElementById('editMiddleName').value.trim(),
                    last_name: document.getElementById('editLastName').value.trim(),
                    email: document.getElementById('editEmail').value.trim(),
                    phone: document.getElementById('editPhone').value.trim(),
                    city: document.getElementById('editCity').value.trim(),
                    district: document.getElementById('editDistrict').value.trim(),
                    country: document.getElementById('editCountry').value.trim(),
                    role: document.getElementById('editRole').value,
                    status: document.getElementById('editStatus').value,
                    birth_date: document.getElementById('editBirthDate').value,
                    gender: document.getElementById('editGender').value,
                    notes: document.getElementById('editNotes').value.trim()
                };

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                if (!updatedData.first_name || !updatedData.last_name || !updatedData.email) {
                    app.showToast('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'warning');
                    return;
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(updatedData.email)) {
                    app.showToast('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­', 'warning');
                    return;
                }

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„
                updatedData.full_name = [updatedData.first_name, updatedData.middle_name, updatedData.last_name]
                    .filter(name => name)
                    .join(' ');

                // Ø­ÙØ¸ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª
                const success = app.userManager.updateUser(userId, updatedData);
                
                if (success) {
                    app.showToast(`âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ "${updatedData.full_name}" Ø¨Ù†Ø¬Ø§Ø­`, 'success');
                    
                    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                    hideMemberEditModal();
                    
                    // ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                    app.displayAdminPanel();
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ«
                    app.dataManager.createBackup();
                } else {
                    throw new Error('ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ');
                }

            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ:', error);
                app.showToast(`âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${error.message}`, 'error');
            }
        }

        function editProfile() {
            if (app && app.userManager.currentUser) {
                console.log('ğŸ”§ ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ...');
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                populateProfileEditForm();
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                showProfileEditModal();
            } else {
                app.showToast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ', 'warning');
            }
        }

        // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
        function showProfileEditModal() {
            const modal = document.getElementById('profileEditModal');
            if (modal) {
                modal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                console.log('âœ… ØªÙ… ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ');
            }
        }

        // Ø¥Ø®ÙØ§Ø¡ Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
        function hideProfileEditModal() {
            const modal = document.getElementById('profileEditModal');
            if (modal) {
                modal.classList.add('hidden');
                document.body.style.overflow = 'auto';
                console.log('âœ… ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ');
            }
        }

        // Ù…Ù„Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        function populateProfileEditForm() {
            if (!app || !app.userManager.currentUser) return;
            
            const user = app.userManager.currentUser;
            console.log('ğŸ“ Ù…Ù„Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©...', user);
            
            // Ø§Ù„Ø§Ø³Ù…
            document.getElementById('editFirstName').value = user.first_name || '';
            document.getElementById('editMiddleName').value = user.middle_name || '';
            document.getElementById('editLastName').value = user.last_name || '';
            
            // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„
            document.getElementById('editEmail').value = user.email || '';
            document.getElementById('editPhone').value = user.phone || '';
            
            // Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©
            document.getElementById('editBirthDate').value = user.birth_date || '';
            document.getElementById('editBirthPlace').value = user.birth_place || '';
            document.getElementById('editOccupation').value = user.occupation || '';
            document.getElementById('editGender').value = user.gender || '';
            document.getElementById('editBio').value = user.bio || '';
            
            // Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©
            if (user.profile_picture) {
                document.getElementById('profilePreview').src = user.profile_picture;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø§Ø³Ù…
            updateEditFullNamePreview();
        }

        // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ ÙÙŠ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        function updateEditFullNamePreview() {
            const firstName = document.getElementById('editFirstName').value.trim();
            const middleName = document.getElementById('editMiddleName').value.trim();
            const lastName = document.getElementById('editLastName').value.trim();
            
            const fullName = [firstName, middleName, lastName].filter(name => name).join(' ');
            document.getElementById('editFullNamePreview').textContent = fullName || 'Ø³ÙŠØªÙ… ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø§Ø³Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹...';
        }

        // Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª ÙÙŠ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
        function saveProfileChanges(event) {
            event.preventDefault();
            
            if (!app || !app.userManager.currentUser) {
                app.showToast('Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…', 'error');
                return;
            }
            
            console.log('ğŸ’¾ Ø¨Ø¯Ø¡ Ø­ÙØ¸ ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ...');
            
            try {
                // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                const updatedData = {
                    first_name: document.getElementById('editFirstName').value.trim(),
                    middle_name: document.getElementById('editMiddleName').value.trim(),
                    last_name: document.getElementById('editLastName').value.trim(),
                    email: document.getElementById('editEmail').value.trim(),
                    phone: document.getElementById('editPhone').value.trim(),
                    birth_date: document.getElementById('editBirthDate').value,
                    birth_place: document.getElementById('editBirthPlace').value.trim(),
                    occupation: document.getElementById('editOccupation').value.trim(),
                    gender: document.getElementById('editGender').value,
                    bio: document.getElementById('editBio').value.trim()
                };
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                if (!updatedData.first_name || !updatedData.last_name || !updatedData.email) {
                    app.showToast('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ØŒ Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©ØŒ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ)', 'warning');
                    return;
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(updatedData.email)) {
                    app.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØµØ­ÙŠØ­', 'warning');
                    return;
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                const currentUser = app.userManager.currentUser;
                const updatedUser = { ...currentUser, ...updatedData };
                
                // ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„
                updatedUser.full_name = [updatedData.first_name, updatedData.middle_name, updatedData.last_name]
                    .filter(name => name).join(' ');
                
                // Ø¥Ø¶Ø§ÙØ© ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«
                updatedUser.last_updated = new Date().toISOString();
                
                // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                app.userManager.currentUser = updatedUser;
                app.userManager.saveUserData();
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
                updateProfileDisplay();
                updateAuthUI();
                
                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
                hideProfileEditModal();
                app.showToast('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
                
                console.log('âœ… ØªÙ… Ø­ÙØ¸ ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ø¨Ù†Ø¬Ø§Ø­');
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ:', error);
                app.showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.', 'error');
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
        function updateProfileDisplay() {
            if (!app || !app.userManager.currentUser) return;
            
            const user = app.userManager.currentUser;
            console.log('ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ...', user);
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
            document.getElementById('displayFullName').textContent = user.full_name || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            document.getElementById('displayEmail').textContent = user.email || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            document.getElementById('displayPhone').textContent = user.phone || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            document.getElementById('displayBirthDate').textContent = user.birth_date ? 
                new Date(user.birth_date).toLocaleDateString('ar-SA') : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            document.getElementById('displayBirthPlace').textContent = user.birth_place || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            document.getElementById('displayOccupation').textContent = user.occupation || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            document.getElementById('displayBio').textContent = user.bio || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ø¨Ø°Ø© Ø´Ø®ØµÙŠØ© Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯.';
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©
            if (user.profile_picture) {
                document.getElementById('profilePicture').src = user.profile_picture;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø³Ù… ÙÙŠ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„
            const userNameDesktop = document.getElementById('currentUserNameDesktop');
            const userNameMobile = document.getElementById('currentUserNameMobile');
            if (userNameDesktop && userNameMobile) {
                const displayName = user.first_name || user.full_name || 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…';
                userNameDesktop.textContent = displayName;
                userNameMobile.textContent = displayName;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø´Ø§Ø·
            updateUserActivityStats();
        }

        // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù†Ø´Ø§Ø· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function updateUserActivityStats() {
            if (!app || !app.userManager.currentUser) return;
            
            const user = app.userManager.currentUser;
            
            // Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©
            let joinDays = 0;
            if (user.created_at) {
                const joinDate = new Date(user.created_at);
                const today = new Date();
                joinDays = Math.floor((today - joinDate) / (1000 * 60 * 60 * 24));
            }
            
            document.getElementById('userPostsCount').textContent = '0'; // Ø³ÙŠØªÙ… ØªØ·ÙˆÙŠØ±Ù‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹
            document.getElementById('userEventsCount').textContent = '0'; // Ø³ÙŠØªÙ… ØªØ·ÙˆÙŠØ±Ù‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹  
            document.getElementById('userSuggestionsCount').textContent = '0'; // Ø³ÙŠØªÙ… ØªØ·ÙˆÙŠØ±Ù‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹
            document.getElementById('userJoinDate').textContent = joinDays;
        }

        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
        function resetProfileForm() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ØŸ Ø³ÙŠØªÙ… ÙÙ‚Ø¯Ø§Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©.')) {
                populateProfileEditForm();
                app.showToast('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬', 'info');
            }
        }

        // Ù…Ø¹Ø§Ù„Ø¬ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©
        function handleProfileImageSelect(input) {
            const file = input.files[0];
            if (file) {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù
                if (!file.type.match(/^image\/(jpeg|jpg|png)$/)) {
                    app.showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ø¨ØµÙŠØºØ© JPG Ø£Ùˆ PNG', 'warning');
                    return;
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù (2MB)
                if (file.size > 2 * 1024 * 1024) {
                    app.showToast('Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£Ù‚Ù„ Ù…Ù† 2MB', 'warning');
                    return;
                }
                
                // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ØµÙˆØ±Ø© ÙˆØ¹Ø±Ø¶Ù‡Ø§
                const reader = new FileReader();
                reader.onload = function(e) {
                    const previewImg = document.getElementById('profilePreview');
                    previewImg.src = e.target.result;
                    
                    // Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø© ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¤Ù‚ØªØ§Ù‹
                    if (app && app.userManager.currentUser) {
                        app.userManager.currentUser.profile_picture = e.target.result;
                    }
                    
                    console.log('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©');
                };
                reader.readAsDataURL(file);
            }
        }

        // ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© Ù…Ù† Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
        function changeProfilePicture() {
            document.getElementById('profileImageFile').click();
        }

        // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ù…ÙˆØ°Ø¬ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        function changePassword() {
            if (app && app.userManager.currentUser) {
                showChangePasswordModal();
            } else {
                app.showToast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'warning');
            }
        }

        // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ù…ÙˆØ°Ø¬ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        function showChangePasswordModal() {
            const modal = document.getElementById('changePasswordModal');
            if (modal) {
                modal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                
                // Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„
                document.getElementById('currentPassword').value = '';
                document.getElementById('newPassword').value = '';
                document.getElementById('confirmNewPassword').value = '';
            }
        }

        // Ø¥Ø®ÙØ§Ø¡ Ù†Ù…ÙˆØ°Ø¬ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        function hideChangePasswordModal() {
            const modal = document.getElementById('changePasswordModal');
            if (modal) {
                modal.classList.add('hidden');
                document.body.style.overflow = 'auto';
            }
        }

        // ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function changeUserPassword(event) {
            event.preventDefault();
            
            if (!app || !app.userManager.currentUser) {
                app.showToast('Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…', 'error');
                return;
            }
            
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmNewPassword').value;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            if (currentPassword !== app.userManager.currentUser.password) {
                app.showToast('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'error');
                return;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø·ÙˆÙ„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            if (newPassword.length < 8) {
                app.showToast('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'warning');
                return;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ·Ø§Ø¨Ù‚ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
            if (newPassword !== confirmPassword) {
                app.showToast('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙˆØªØ£ÙƒÙŠØ¯Ù‡Ø§ ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ÙŠÙ†', 'warning');
                return;
            }
            
            try {
                // ØªØ­Ø¯ÙŠØ« ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
                app.userManager.currentUser.password = newPassword;
                app.userManager.currentUser.password_changed_at = new Date().toISOString();
                app.userManager.saveUserData();
                
                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
                hideChangePasswordModal();
                app.showToast('âœ… ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­', 'success');
                
                console.log('âœ… ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­');
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:', error);
                app.showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.', 'error');
            }
        }

        function logout() {
            if (app && confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
                app.userManager.logout();
                app.updateAuthUI();
                showSection('home');
                app.showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }
        }

        // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ (Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„)
        function resetDefaultAdmin() {
            if (app && app.userManager) {
                const admin = app.userManager.resetDefaultAdmin();
                console.log('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ');
                app.showToast('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¨Ù†Ø¬Ø§Ø­', 'success');
                return admin;
            }
        }

        // Ø¯Ø§Ù„Ø© Ù„Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (Ù„Ù„ØªØ´Ø®ÙŠØµ)
        function showAllUsers() {
            if (app && app.userManager) {
                console.log('ğŸ“‹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†:');
                app.userManager.users.forEach(u => {
                    console.log(`- ${u.full_name} (${u.email}) - ${u.role} - ${u.status}`);
                });
                return app.userManager.users;
            }
        }

        // ÙˆØ¸ÙŠÙØ© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ
        function testSecondGenerationRetrieval() {
            if (!app) {
                alert('Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ØºÙŠØ± Ù…Ù‡ÙŠØ£ Ø¨Ø¹Ø¯');
                return;
            }

            try {
                console.log('ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ...');
                
                const allMembers = app.dataManager.getData('familyMembers');
                const firstGeneration = allMembers.filter(m => m.generation === 1);
                const secondGeneration = allMembers.filter(m => m.generation === 2);
                const thirdGeneration = allMembers.filter(m => m.generation === 3);

                let testResults = `ğŸ” Ù†ØªØ§Ø¦Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:\n\n`;
                testResults += `ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: ${allMembers.length}\n`;
                testResults += `ğŸ‘‘ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ (Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠÙ†): ${firstGeneration.length}\n`;
                testResults += `ğŸ‘¥ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ: ${secondGeneration.length}\n`;
                testResults += `ğŸ‘¶ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù„Ø«: ${thirdGeneration.length}\n\n`;

                if (secondGeneration.length > 0) {
                    testResults += `âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¨Ù†Ø¬Ø§Ø­:\n`;
                    secondGeneration.forEach((member, index) => {
                        const father = allMembers.find(m => m.id === member.father_id);
                        testResults += `${index + 1}. ${member.full_name}\n`;
                        testResults += `   - Ø§Ù„Ø¬ÙŠÙ„: ${member.generation}\n`;
                        testResults += `   - Ø§Ù„ÙˆØ§Ù„Ø¯: ${father ? father.full_name : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}\n`;
                        testResults += `   - Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©: ${app.getMembershipTypeText(member.membership_type)}\n\n`;
                    });
                    
                    // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ©
                    testResults += `ğŸ”— Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ©:\n`;
                    firstGeneration.forEach(founder => {
                        const children = allMembers.filter(m => m.father_id === founder.id);
                        testResults += `- ${founder.full_name}: ${children.length} Ù…Ù† Ø§Ù„Ø£Ø·ÙØ§Ù„\n`;
                    });

                    app.showToast('âœ… Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ Ù†Ø¬Ø­! Ø±Ø§Ø¬Ø¹ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„ØªÙØ§ØµÙŠÙ„.', 'success');
                } else {
                    testResults += `âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£Ø¹Ø¶Ø§Ø¡ ÙÙŠ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ\n`;
                    testResults += `ğŸ’¡ ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹`;
                    
                    app.showToast('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ. Ø­Ù…Ù‘Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹.', 'warning');
                }

                console.log(testResults);
                alert(testResults);

            } catch (error) {
                const errorMsg = `âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${error.message}`;
                console.error(errorMsg);
                app.showToast(errorMsg, 'error');
            }
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… ØªØ¬Ø±ÙŠØ¨ÙŠ Ù…Ø¹Ù„Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù…Ø¹Ø§Ù…Ù„ ÙÙŠ URL
        function checkAndAddTestPendingUser() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('add_pending_user') === 'true' || urlParams.get('test_pending') === 'true') {
                console.log('ğŸ§ª Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… ØªØ¬Ø±ÙŠØ¨ÙŠ Ù…Ø¹Ù„Ù‚ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±...');
                
                try {
                    const testUser = {
                        id: 'test_pending_' + Date.now(),
                        national_id: '1234567890',
                        first_name: 'Ø£Ø­Ù…Ø¯',
                        middle_name: 'Ø¹Ù„ÙŠ',
                        last_name: 'Ø§Ù„Ø³Ø¹ÙŠØ¯Ø§Ù†',
                        full_name: 'Ø£Ø­Ù…Ø¯ Ø¹Ù„ÙŠ Ø§Ù„Ø³Ø¹ÙŠØ¯Ø§Ù†',
                        email: 'ahmed.test@example.com',
                        phone: '0501234567',
                        password: app.userManager.hashPassword('test123'),
                        role: 'user',
                        status: 'pending', // Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
                        birth_date: '1990-05-15',
                        birth_place: 'Ø§Ù„Ø±ÙŠØ§Ø¶',
                        profession: 'Ù…Ù‡Ù†Ø¯Ø³ Ø¨Ø±Ù…Ø¬ÙŠØ§Øª',
                        specialization: 'ØªØ·ÙˆÙŠØ± Ø§Ù„ÙˆÙŠØ¨',
                        hobbies: 'Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©ØŒ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶Ø©',
                        father_id: null,
                        generation: 3,
                        created_at: new Date().toISOString(),
                        approved_at: null,
                        approved_by: null
                    };
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¨Ù‚Ø§Ù‹
                    const existing = app.userManager.users.find(u => 
                        u.email === testUser.email || u.national_id === testUser.national_id
                    );
                    
                    if (!existing) {
                        app.userManager.users.push(testUser);
                        app.userManager.saveUsers();
                        console.log('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ Ø§Ù„Ù…Ø¹Ù„Ù‚:', testUser.full_name);
                        console.log('   Ø§Ù„Ø­Ø§Ù„Ø©:', testUser.status);
                        console.log('   Ø§Ù„Ø¨Ø±ÙŠØ¯:', testUser.email);
                        
                        app.showToast('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… ØªØ¬Ø±ÙŠØ¨ÙŠ Ù…Ø¹Ù„Ù‚ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±', 'success');
                        
                        // ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙØªÙˆØ­Ø©
                        if (app.userManager.currentUser && app.userManager.currentUser.role === 'admin') {
                            setTimeout(() => {
                                app.displayAdminPanel();
                            }, 1000);
                        }
                    } else {
                        console.log('âš ï¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„');
                    }
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ:', error);
                    app.showToast('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ: ' + error.message, 'error');
                }
            }
        }
        
        // Ø¯Ø®ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ…Ø¯ÙŠØ± Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±
        function autoLoginAdmin() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('auto_login') === 'admin') {
                console.log('ğŸ” Ø¯Ø®ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ…Ø¯ÙŠØ± Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±...');
                
                setTimeout(() => {
                    try {
                        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¯ÙŠØ±
                        const adminUser = app.userManager.login('admin@salmansaedan.com', 'admin123');
                        console.log('âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¯ÙŠØ±:', adminUser.full_name);
                        
                        // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                        app.updateAuthUI();
                        
                        // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                        if (urlParams.get('show_admin') === 'true' || window.location.hash === '#admin') {
                            setTimeout(() => {
                                console.log('ğŸ“Š Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©...');
                                showSection('admin');
                                app.displayAdminPanel();
                            }, 1000);
                        }
                        
                        app.showToast('âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¯ÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹', 'success');
                        
                    } catch (error) {
                        console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ:', error);
                        app.showToast('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ: ' + error.message, 'error');
                    }
                }, 3000); // Ø§Ù†ØªØ¸Ø§Ø± 3 Ø«ÙˆØ§Ù† Ù„Ø¶Ù…Ø§Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            }
        }

        // ØªØ´ØºÙŠÙ„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        setTimeout(() => {
            checkAndAddTestPendingUser();
        }, 2000);
        
        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        setTimeout(() => {
            autoLoginAdmin();
        }, 2500);
        
        // Ø¨Ø¯Ø¡ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        setTimeout(() => {
            startAutoSyncSystem();
        }, 3000);

        // ØªØ¹Ø·ÙŠÙ„ Ù…Ø¤Ù‚Øª Ù„Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±
        console.log('âš ï¸ ØªÙ… ØªØ¹Ø·ÙŠÙ„ event listeners Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±');
        
        // Ø±Ù…Ø² Ù…Ø¤Ù‚Øª Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± - Ø³ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠ Ù„Ø§Ø­Ù‚Ø§Ù‹
        /*
        setTimeout(() => {
            console.log('ğŸ”§ ØªÙØ¹ÙŠÙ„ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£Ø®ÙŠØ±');
            
            document.addEventListener('click', function(e) {
                console.log('ğŸ” Ù†Ù‚Ø±Ø© Ù…ÙƒØªØ´ÙØ© Ø¹Ù„Ù‰:', e.target.id, 'Ø§Ù„ÙƒÙ„Ø§Ø³Ø§Øª:', e.target.className);
                
                // ØªØ£Ø®ÙŠØ± Ø¥Ø¶Ø§ÙÙŠ Ù‚ØµÙŠØ± Ù‚Ø¨Ù„ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
                setTimeout(() => {
                    // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù†Ù‚Ø± Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ (Ø§Ù„Ø®Ù„ÙÙŠØ©) ÙˆÙ„ÙŠØ³ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
                    if (e.target.id === 'familyModal') {
                        console.log('ğŸšª Ø¥ØºÙ„Ø§Ù‚ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©');
                        hideFamilyModal();
                    }
                    if (e.target.id === 'loginModal') {
                        console.log('ğŸšª Ø¥ØºÙ„Ø§Ù‚ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¯Ø®ÙˆÙ„');
                        hideLoginModal();
                    }
                    if (e.target.id === 'registerModal') {
                        console.log('ğŸšª Ø¥ØºÙ„Ø§Ù‚ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„');
                        hideRegisterModal();
                    }
                }, 50); // ØªØ£Ø®ÙŠØ± 50ms Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… Ø§Ù„ØªØ¯Ø§Ø®Ù„
            });
        }, 1000); // ØªØ£Ø®ÙŠØ± Ø«Ø§Ù†ÙŠØ© ÙˆØ§Ø­Ø¯Ø© Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠ
        */
    </script>

    <!-- Bottom Navigation for Mobile -->
    <div class="bottom-nav" id="bottomNav">
        <div class="bottom-nav-grid">
            <button class="bottom-nav-item active" onclick="showSection('home'); updateBottomNav('home');">
                <i class="fas fa-home"></i>
                <span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
            </button>
            <button class="bottom-nav-item" onclick="showSection('family'); updateBottomNav('family');">
                <i class="fas fa-users"></i>
                <span>Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</span>
            </button>
            <button class="bottom-nav-item" onclick="showSection('events'); updateBottomNav('events');">
                <i class="fas fa-calendar"></i>
                <span>Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</span>
            </button>
            <button class="bottom-nav-item" onclick="showSection('suggestions'); updateBottomNav('suggestions');">
                <i class="fas fa-lightbulb"></i>
                <span>Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª</span>
            </button>
            <button class="bottom-nav-item" onclick="showSection('library'); updateBottomNav('library');">
                <i class="fas fa-book"></i>
                <span>Ø§Ù„Ù…ÙƒØªØ¨Ø©</span>
            </button>
        </div>
    </div>

    <script>
        // Update bottom navigation active state
        function updateBottomNav(sectionName) {
            const navItems = document.querySelectorAll('.bottom-nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            
            // Map section names to button indices
            const sectionMap = {
                'home': 0,
                'family': 1,
                'events': 2,
                'suggestions': 3,
                'library': 4
            };
            
            const index = sectionMap[sectionName];
            if (index !== undefined) {
                navItems[index].classList.add('active');
            }
        }
        
        // Show bottom nav only for logged in users on mobile
        function updateBottomNavVisibility() {
            const bottomNav = document.getElementById('bottomNav');
            const isMobile = window.innerWidth <= 768;
            
            if (app && app.userManager && app.userManager.currentUser && isMobile) {
                bottomNav.style.display = 'block';
            } else if (isMobile && (!app || !app.userManager || !app.userManager.currentUser)) {
                bottomNav.style.display = 'none';
            }
        }
        
        // Update visibility on resize and auth state changes
        window.addEventListener('resize', updateBottomNavVisibility);
        document.addEventListener('DOMContentLoaded', updateBottomNavVisibility);
        
        // Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        function startAutoSyncSystem() {
            if (!app || !app.dataManager) return;
            
            console.log('ğŸ”„ Ø¨Ø¯Ø¡ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ...');
            
            // ÙØ­Øµ Ø¯ÙˆØ±ÙŠ ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚
            setInterval(() => {
                if (app && app.dataManager) {
                    try {
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©
                        app.dataManager.updateBackupIfNeeded();
                        
                        // ÙØ­Øµ ØªÙ†Ø§Ø³Ù‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                        app.dataManager.checkDataConsistency();
                    } catch (error) {
                        console.warn('âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©:', error);
                    }
                }
            }, 5 * 60 * 1000); // ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©
            window.addEventListener('beforeunload', () => {
                if (app && app.dataManager) {
                    try {
                        app.dataManager.createBackup();
                    } catch (error) {
                        console.warn('âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚:', error);
                    }
                }
            });
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¹Ù†Ø¯ Ø¹Ø¯Ù… Ø§Ù„Ù†Ø´Ø§Ø·
            let inactivityTimer;
            const resetInactivityTimer = () => {
                clearTimeout(inactivityTimer);
                inactivityTimer = setTimeout(() => {
                    if (app && app.dataManager) {
                        app.dataManager.createBackup();
                        console.log('ğŸ’¾ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¨Ø³Ø¨Ø¨ Ø¹Ø¯Ù… Ø§Ù„Ù†Ø´Ø§Ø·');
                    }
                }, 30 * 60 * 1000); // 30 Ø¯Ù‚ÙŠÙ‚Ø© Ù…Ù† Ø¹Ø¯Ù… Ø§Ù„Ù†Ø´Ø§Ø·
            };
            
            // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù†Ø´Ø§Ø·
            ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart', 'click'].forEach(event => {
                document.addEventListener(event, resetInactivityTimer, true);
            });
            
            resetInactivityTimer(); // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª
        }
        
        // Override showSection to update bottom nav
        const originalShowSection = window.showSection;
        window.showSection = function(sectionName) {
            if (originalShowSection) {
                originalShowSection(sectionName);
            }
            updateBottomNav(sectionName);
        };
        
        // âœ… ENHANCED 2025-10-11: Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø§Ù„Ù…Ø­Ø³Ù†
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø§Ù„Ù…Ø­Ø³Ù†...');
            
            // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
            if (typeof startAutoSyncSystem === 'function') {
                startAutoSyncSystem();
            }
            
            // ÙØ­Øµ ÙˆÙ…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            setTimeout(() => {
                if (window.app && app.dataManager) {
                    console.log('ğŸ” ÙØ­Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...');
                    
                    try {
                        // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¥ØµÙ„Ø§Ø­ Ø£ÙŠ Ù…Ø´Ø§ÙƒÙ„ Ù…Ø²Ø§Ù…Ù†Ø©
                        const sources = app.dataManager.analyzeAllDataSources();
                        if (sources && sources.length > 0) {
                            const bestSource = app.dataManager.selectBestDataSource(sources);
                            
                            if (bestSource && bestSource.familyCount > 0) {
                                console.log(`âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ù…ØµØ¯Ø± Ø¨ÙŠØ§Ù†Ø§Øª: ${bestSource.familyCount} Ø¹Ø¶Ùˆ`);
                                
                                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                                const currentCount = app.dataManager.data.familyMembers ? app.dataManager.data.familyMembers.length : 0;
                                
                                if (currentCount !== bestSource.familyCount && bestSource.familyCount > currentCount) {
                                    console.log(`ğŸ”„ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: Ø§Ù„Ø­Ø§Ù„ÙŠ ${currentCount} â†’ Ø§Ù„Ø£ÙØ¶Ù„ ${bestSource.familyCount}`);
                                    app.dataManager.data = bestSource.data;
                                    app.dataManager.saveData();
                                    app.dataManager.createBackup();
                                    
                                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
                                    if (app.familySection && app.familySection.updateFamilyDisplay) {
                                        app.familySection.updateFamilyDisplay();
                                    }
                                    
                                    console.log('âœ… ØªÙ…Øª Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹');
                                    
                                    // Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                                    if (app.showToast) {
                                        app.showToast(
                                            `âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹\nØªÙ… Ø§Ø³ØªØ±Ø¬Ø§Ø¹ ${bestSource.familyCount} Ø¹Ø¶Ùˆ Ø¹Ø§Ø¦Ù„Ø©`,
                                            'success'
                                        );
                                    }
                                }
                            }
                        }
                    } catch (error) {
                        console.warn('âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©:', error);
                    }
                }
            }, 2000); // ØªØ£Ø®ÙŠØ± Ù„Ø¶Ù…Ø§Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            
            // Ù…Ø±Ø§Ù‚Ø¨Ø© ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø¹Ù†Ø¯ Ø¹Ø¯Ù… Ø§Ù„Ù†Ø´Ø§Ø·
            let dataChangeTimer;
            const originalSaveData = window.app && app.dataManager ? app.dataManager.saveData : null;
            
            if (originalSaveData) {
                app.dataManager.saveData = function() {
                    // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ø£ØµÙ„ÙŠ
                    const result = originalSaveData.call(this);
                    
                    // Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ ØªØ£Ø®ÙŠØ±
                    clearTimeout(dataChangeTimer);
                    dataChangeTimer = setTimeout(() => {
                        try {
                            this.createBackup();
                            console.log('ğŸ’¾ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¨Ø¹Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                        } catch (error) {
                            console.warn('âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©:', error);
                        }
                    }, 5000); // 5 Ø«ÙˆØ§Ù†ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„ØªØºÙŠÙŠØ±
                    
                    return result;
                };
            }
            
            // Ø¥Ø¶Ø§ÙØ© event listeners Ù„ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø§Ø³Ù… ÙÙŠ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
            const nameFields = ['editFirstName', 'editMiddleName', 'editLastName'];
            nameFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener('input', updateEditFullNamePreview);
                }
            });
            
            // Ø¥Ø¶Ø§ÙØ© event listeners Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù†Ø´Ø§Ø·
            const sectionObserver = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                        const target = mutation.target;
                        if (target.id === 'profile-section' && !target.classList.contains('hidden')) {
                            // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ø¹Ù†Ø¯ Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø³Ù…
                            setTimeout(updateProfileDisplay, 100);
                        }
                    }
                });
            });
            
            const profileSection = document.getElementById('profile-section');
            if (profileSection) {
                sectionObserver.observe(profileSection, { attributes: true });
            }
        });

        // =================== Ø¯ÙˆØ§Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ===================
        
        async function loadEvents() {
            try {
                const response = await fetch('/api/events');
                const data = await response.json();
                
                if (data.status === 'success') {
                    displayEvents(data.data);
                    updateEventsStats(data.data);
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«:', error);
                showToast('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«', 'error');
            }
        }

        function displayEvents(events) {
            const grid = document.getElementById('events-grid');
            if (!grid) return;

            if (events.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center py-12 text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø­Ø¯Ø§Ø« Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯</div>';
                return;
            }

            grid.innerHTML = events.map(event => `
                <div class="card p-6 hover:shadow-lg transition-shadow">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-bold text-gray-800">${event.title}</h3>
                        <span class="px-3 py-1 rounded-full text-sm ${getEventTypeClass(event.event_type)}">${getEventTypeLabel(event.event_type)}</span>
                    </div>
                    
                    <p class="text-gray-600 mb-4">${event.description || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ'}</p>
                    
                    <div class="space-y-2 mb-4">
                        <div class="flex items-center text-sm text-gray-500">
                            <i class="fas fa-calendar mr-2"></i>
                            ${formatDate(event.event_date)}
                        </div>
                        <div class="flex items-center text-sm text-gray-500">
                            <i class="fas fa-map-marker-alt mr-2"></i>
                            ${event.location || 'Ù„Ù… ÙŠØ­Ø¯Ø¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹'}
                        </div>
                        ${event.organizer ? `
                            <div class="flex items-center text-sm text-gray-500">
                                <i class="fas fa-user mr-2"></i>
                                ${event.organizer}
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <button onclick="attendEvent('${event.id}')" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">
                            <i class="fas fa-check mr-1"></i>Ø³Ø£Ø­Ø¶Ø±
                        </button>
                        <div class="flex gap-2">
                            <button onclick="editEvent('${event.id}')" class="text-blue-600 hover:text-blue-800">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteEvent('${event.id}')" class="text-red-600 hover:text-red-800">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getEventTypeClass(type) {
            const classes = {
                'wedding': 'bg-pink-100 text-pink-700',
                'birth': 'bg-blue-100 text-blue-700',
                'graduation': 'bg-green-100 text-green-700',
                'gathering': 'bg-yellow-100 text-yellow-700'
            };
            return classes[type] || 'bg-gray-100 text-gray-700';
        }

        function getEventTypeLabel(type) {
            const labels = {
                'wedding': 'ğŸ’’ Ø²ÙˆØ§Ø¬',
                'birth': 'ğŸ‘¶ Ù…ÙˆÙ„ÙˆØ¯',
                'graduation': 'ğŸ“ ØªØ®Ø±Ø¬',
                'gathering': 'ğŸ‘¥ Ø§Ø¬ØªÙ…Ø§Ø¹'
            };
            return labels[type] || 'ÙØ¹Ø§Ù„ÙŠØ©';
        }

        function updateEventsStats(events) {
            document.getElementById('total-events').textContent = events.length;
            document.getElementById('events-count').textContent = events.length;
            
            const activeEvents = events.filter(event => new Date(event.event_date) > new Date()).length;
            document.getElementById('active-events').textContent = activeEvents;
        }

        function showEventModal() {
            document.getElementById('eventModal').classList.remove('hidden');
        }

        function hideEventModal() {
            document.getElementById('eventModal').classList.add('hidden');
        }

        async function handleEventSubmit(event) {
            event.preventDefault();
            
            const eventData = {
                title: document.getElementById('eventTitle').value,
                description: document.getElementById('eventDescription').value,
                event_type: document.getElementById('eventType').value,
                event_date: document.getElementById('eventDate').value,
                location: document.getElementById('eventLocation').value,
                organizer: document.getElementById('eventOrganizer').value,
                max_attendees: parseInt(document.getElementById('eventMaxAttendees').value) || null
            };

            try {
                const response = await fetch('/api/events', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(eventData)
                });

                const result = await response.json();
                
                if (result.status === 'success') {
                    showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø¯Ø« Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                    hideEventModal();
                    loadEvents();
                    document.getElementById('eventForm').reset();
                } else {
                    throw new Error(result.message);
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø¯Ø«:', error);
                showToast('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø¯Ø«: ' + error.message, 'error');
            }
        }

        // =================== Ø¯ÙˆØ§Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª ===================

        async function loadSuggestions() {
            try {
                const response = await fetch('/api/suggestions');
                const data = await response.json();
                
                if (data.status === 'success') {
                    displaySuggestions(data.data);
                    updateSuggestionsStats(data.data);
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª:', error);
                showToast('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª', 'error');
            }
        }

        function displaySuggestions(suggestions) {
            const grid = document.getElementById('suggestions-grid');
            if (!grid) return;

            if (suggestions.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center py-12 text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯</div>';
                return;
            }

            grid.innerHTML = suggestions.map(suggestion => `
                <div class="card p-6 hover:shadow-lg transition-shadow">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-bold text-gray-800">${suggestion.title}</h3>
                        <div class="flex gap-2">
                            <span class="px-3 py-1 rounded-full text-sm ${getSuggestionStatusClass(suggestion.status)}">${getSuggestionStatusLabel(suggestion.status)}</span>
                            <span class="px-3 py-1 rounded-full text-sm ${getSuggestionPriorityClass(suggestion.priority)}">${getSuggestionPriorityLabel(suggestion.priority)}</span>
                        </div>
                    </div>
                    
                    <p class="text-gray-600 mb-4">${suggestion.description}</p>
                    
                    <div class="space-y-2 mb-4">
                        <div class="flex items-center text-sm text-gray-500">
                            <i class="fas fa-tag mr-2"></i>
                            ${getSuggestionCategoryLabel(suggestion.category)}
                        </div>
                        ${suggestion.benefits ? `
                            <div class="flex items-center text-sm text-gray-500">
                                <i class="fas fa-star mr-2"></i>
                                ${suggestion.benefits.substring(0, 100)}...
                            </div>
                        ` : ''}
                        <div class="flex items-center text-sm text-gray-500">
                            <i class="fas fa-thumbs-up mr-2"></i>
                            ${suggestion.votes_for || 0} ØªØ£ÙŠÙŠØ¯ | ${suggestion.votes_against || 0} Ù…Ø¹Ø§Ø±Ø¶Ø©
                        </div>
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <div class="flex gap-2">
                            <button onclick="voteForSuggestion('${suggestion.id}')" class="bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600">
                                <i class="fas fa-thumbs-up mr-1"></i>Ø£Ø¤ÙŠØ¯
                            </button>
                            <button onclick="voteAgainstSuggestion('${suggestion.id}')" class="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600">
                                <i class="fas fa-thumbs-down mr-1"></i>Ø£Ø¹Ø§Ø±Ø¶
                            </button>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="editSuggestion('${suggestion.id}')" class="text-blue-600 hover:text-blue-800">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteSuggestion('${suggestion.id}')" class="text-red-600 hover:text-red-800">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getSuggestionStatusClass(status) {
            const classes = {
                'pending': 'bg-yellow-100 text-yellow-700',
                'approved': 'bg-green-100 text-green-700',
                'rejected': 'bg-red-100 text-red-700',
                'under_review': 'bg-blue-100 text-blue-700'
            };
            return classes[status] || 'bg-gray-100 text-gray-700';
        }

        function getSuggestionStatusLabel(status) {
            const labels = {
                'pending': 'â³ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',
                'approved': 'âœ… Ù…Ù‚Ø¨ÙˆÙ„',
                'rejected': 'âŒ Ù…Ø±ÙÙˆØ¶',
                'under_review': 'ğŸ” ØªØ­Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©'
            };
            return labels[status] || status;
        }

        function getSuggestionPriorityClass(priority) {
            const classes = {
                'urgent': 'bg-red-100 text-red-700',
                'high': 'bg-orange-100 text-orange-700',
                'medium': 'bg-yellow-100 text-yellow-700',
                'low': 'bg-green-100 text-green-700'
            };
            return classes[priority] || 'bg-gray-100 text-gray-700';
        }

        function getSuggestionPriorityLabel(priority) {
            const labels = {
                'urgent': 'ğŸš¨ Ø¹Ø§Ø¬Ù„',
                'high': 'ğŸ”´ Ø¹Ø§Ù„ÙŠØ©',
                'medium': 'ğŸŸ¡ Ù…ØªÙˆØ³Ø·Ø©',
                'low': 'ğŸŸ¢ Ù…Ù†Ø®ÙØ¶Ø©'
            };
            return labels[priority] || priority;
        }

        function getSuggestionCategoryLabel(category) {
            const labels = {
                'technology': 'ğŸ”§ ØªÙ‚Ù†ÙŠ',
                'events': 'ğŸ‰ ÙØ¹Ø§Ù„ÙŠØ§Øª',
                'services': 'ğŸ›ï¸ Ø®Ø¯Ù…Ø§Øª',
                'education': 'ğŸ“š ØªØ¹Ù„ÙŠÙ…ÙŠ',
                'social': 'ğŸ‘¥ Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ',
                'business': 'ğŸ’¼ ØªØ¬Ø§Ø±ÙŠ',
                'other': 'ğŸ“ Ø£Ø®Ø±Ù‰'
            };
            return labels[category] || category;
        }

        function updateSuggestionsStats(suggestions) {
            document.getElementById('total-suggestions').textContent = suggestions.length;
            document.getElementById('suggestions-count').textContent = suggestions.length;
            document.getElementById('suggestions-total').textContent = suggestions.length;
            
            const pending = suggestions.filter(s => s.status === 'pending').length;
            const approved = suggestions.filter(s => s.status === 'approved').length;
            const highPriority = suggestions.filter(s => s.priority === 'high' || s.priority === 'urgent').length;
            
            document.getElementById('suggestions-pending').textContent = pending;
            document.getElementById('suggestions-approved').textContent = approved;
            document.getElementById('approved-suggestions').textContent = approved;
            document.getElementById('suggestions-high-priority').textContent = highPriority;
        }

        function showSuggestionModal() {
            document.getElementById('suggestionModal').classList.remove('hidden');
        }

        function hideSuggestionModal() {
            document.getElementById('suggestionModal').classList.add('hidden');
        }

        async function handleSuggestionSubmit(event) {
            event.preventDefault();
            
            const suggestionData = {
                title: document.getElementById('suggestionTitle').value,
                description: document.getElementById('suggestionDescription').value,
                category: document.getElementById('suggestionCategory').value,
                priority: document.getElementById('suggestionPriority').value,
                benefits: document.getElementById('suggestionBenefits').value,
                estimated_budget: document.getElementById('suggestionBudget').value,
                estimated_timeline: document.getElementById('suggestionTimeline').value,
                required_resources: document.getElementById('suggestionResources').value
            };

            try {
                const response = await fetch('/api/suggestions', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(suggestionData)
                });

                const result = await response.json();
                
                if (result.status === 'success') {
                    showToast('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                    hideSuggestionModal();
                    loadSuggestions();
                    document.getElementById('suggestionForm').reset();
                } else {
                    throw new Error(result.message);
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­:', error);
                showToast('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­: ' + error.message, 'error');
            }
        }

        async function voteForSuggestion(suggestionId) {
            await voteSuggestion(suggestionId, true);
        }

        async function voteAgainstSuggestion(suggestionId) {
            await voteSuggestion(suggestionId, false);
        }

        async function voteSuggestion(suggestionId, isFor) {
            try {
                const response = await fetch(`/api/suggestions/${suggestionId}/vote`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ vote: isFor })
                });

                const result = await response.json();
                
                if (result.status === 'success') {
                    showToast(isFor ? 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ ØªØ£ÙŠÙŠØ¯Ùƒ!' : 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ù…Ø¹Ø§Ø±Ø¶ØªÙƒ!', 'success');
                    loadSuggestions();
                } else {
                    throw new Error(result.message);
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙˆÙŠØª:', error);
                showToast('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙˆÙŠØª: ' + error.message, 'error');
            }
        }

        // =================== Ø¯ÙˆØ§Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ© ===================

        async function loadLibrary() {
            try {
                const response = await fetch('/api/library');
                const data = await response.json();
                
                if (data.status === 'success') {
                    displayLibrary(data.data);
                    updateLibraryStats(data.data);
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø©:', error);
                showToast('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø©', 'error');
            }
        }

        function displayLibrary(items) {
            const grid = document.getElementById('library-grid');
            if (!grid) return;

            if (items.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center py-12 text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙŠØ§Øª ÙÙŠ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø¨Ø¹Ø¯</div>';
                return;
            }

            grid.innerHTML = items.map(item => `
                <div class="card p-6 hover:shadow-lg transition-shadow">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-bold text-gray-800">${item.title}</h3>
                        <span class="px-3 py-1 rounded-full text-sm ${getLibraryTypeClass(item.content_type)}">${getLibraryTypeLabel(item.content_type)}</span>
                    </div>
                    
                    <p class="text-gray-600 mb-4">${item.description}</p>
                    
                    <div class="space-y-2 mb-4">
                        ${item.author ? `
                            <div class="flex items-center text-sm text-gray-500">
                                <i class="fas fa-user mr-2"></i>
                                ${item.author}
                            </div>
                        ` : ''}
                        <div class="flex items-center text-sm text-gray-500">
                            <i class="fas fa-tag mr-2"></i>
                            ${getLibraryCategoryLabel(item.category)}
                        </div>
                        <div class="flex items-center text-sm text-gray-500">
                            <i class="fas fa-eye mr-2"></i>
                            ${item.views || 0} Ù…Ø´Ø§Ù‡Ø¯Ø©
                        </div>
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <div class="flex gap-2">
                            ${item.file_url ? `
                                <button onclick="viewLibraryItem('${item.id}')" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                                    <i class="fas fa-eye mr-1"></i>Ø¹Ø±Ø¶
                                </button>
                                <button onclick="downloadLibraryItem('${item.id}')" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">
                                    <i class="fas fa-download mr-1"></i>ØªØ­Ù…ÙŠÙ„
                                </button>
                            ` : ''}
                        </div>
                        <div class="flex gap-2">
                            <button onclick="editLibraryItem('${item.id}')" class="text-blue-600 hover:text-blue-800">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteLibraryItem('${item.id}')" class="text-red-600 hover:text-red-800">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getLibraryTypeClass(type) {
            const classes = {
                'document': 'bg-blue-100 text-blue-700',
                'book': 'bg-green-100 text-green-700',
                'article': 'bg-yellow-100 text-yellow-700',
                'video': 'bg-red-100 text-red-700',
                'audio': 'bg-purple-100 text-purple-700',
                'image': 'bg-pink-100 text-pink-700'
            };
            return classes[type] || 'bg-gray-100 text-gray-700';
        }

        function getLibraryTypeLabel(type) {
            const labels = {
                'document': 'ğŸ“„ ÙˆØ«ÙŠÙ‚Ø©',
                'book': 'ğŸ“š ÙƒØªØ§Ø¨',
                'article': 'ğŸ“ Ù…Ù‚Ø§Ù„',
                'video': 'ğŸ¥ ÙÙŠØ¯ÙŠÙˆ',
                'audio': 'ğŸµ ØµÙˆØªÙŠ',
                'image': 'ğŸ–¼ï¸ ØµÙˆØ±Ø©',
                'presentation': 'ğŸ“Š Ø¹Ø±Ø¶',
                'research': 'ğŸ”¬ Ø¨Ø­Ø«'
            };
            return labels[type] || type;
        }

        function getLibraryCategoryLabel(category) {
            const labels = {
                'family_history': 'ğŸ›ï¸ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©',
                'genealogy': 'ğŸŒ³ Ø§Ù„Ø£Ù†Ø³Ø§Ø¨',
                'documents': 'ğŸ“‹ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø±Ø³Ù…ÙŠØ©',
                'photos': 'ğŸ“¸ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ø°ÙƒØ±ÙŠØ§Øª',
                'achievements': 'ğŸ† Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª',
                'stories': 'ğŸ“– Ø§Ù„Ù‚ØµØµ ÙˆØ§Ù„Ø­ÙƒØ§ÙŠØ§Øª',
                'education': 'ğŸ“ Ø§Ù„ØªØ¹Ù„ÙŠÙ… ÙˆØ§Ù„Ù…Ù‡Ø§Ø±Ø§Øª',
                'business': 'ğŸ’¼ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ ÙˆØ§Ù„ØªØ¬Ø§Ø±Ø©'
            };
            return labels[category] || category;
        }

        function updateLibraryStats(items) {
            document.getElementById('total-library').textContent = items.length;
            document.getElementById('library-count').textContent = items.length;
            document.getElementById('library-total-items').textContent = items.length;
            
            const featured = items.filter(item => item.is_featured).length;
            const totalViews = items.reduce((sum, item) => sum + (item.views || 0), 0);
            const totalDownloads = items.reduce((sum, item) => sum + (item.downloads || 0), 0);
            
            document.getElementById('library-featured-items').textContent = featured;
            document.getElementById('library-total-views').textContent = totalViews;
            document.getElementById('library-total-downloads').textContent = totalDownloads;
        }

        function showLibraryModal() {
            document.getElementById('libraryModal').classList.remove('hidden');
        }

        function hideLibraryModal() {
            document.getElementById('libraryModal').classList.add('hidden');
        }

        async function handleLibrarySubmit(event) {
            event.preventDefault();
            
            const libraryData = {
                title: document.getElementById('libraryTitle').value,
                description: document.getElementById('libraryDescription').value,
                content_type: document.getElementById('libraryType').value,
                category: document.getElementById('libraryCategory').value,
                author: document.getElementById('libraryAuthor').value,
                keywords: document.getElementById('libraryKeywords').value,
                date_created: document.getElementById('libraryDate').value
            };

            try {
                const response = await fetch('/api/library', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(libraryData)
                });

                const result = await response.json();
                
                if (result.status === 'success') {
                    showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                    hideLibraryModal();
                    loadLibrary();
                    document.getElementById('libraryForm').reset();
                } else {
                    throw new Error(result.message);
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰:', error);
                showToast('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰: ' + error.message, 'error');
            }
        }

        // =================== Ø¯ÙˆØ§Ù„ Ø¹Ø§Ù…Ø© ===================

        function formatDate(dateString) {
            if (!dateString) return 'Ù„Ù… ÙŠØ­Ø¯Ø¯';
            const date = new Date(dateString);
            return date.toLocaleDateString('ar-SA', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        async function loadAllSections() {
            await loadEvents();
            await loadSuggestions(); 
            await loadLibrary();
            loadDashboardStats();
        }

        async function loadDashboardStats() {
            try {
                // ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡
                const familyResponse = await fetch('/api/family-members');
                const familyData = await familyResponse.json();
                if (familyData.status === 'success') {
                    document.getElementById('total-members').textContent = familyData.count;
                    document.getElementById('family-count').textContent = familyData.count;
                }

                // ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
                const eventsResponse = await fetch('/api/events');
                const eventsData = await eventsResponse.json();
                if (eventsData.status === 'success') {
                    document.getElementById('total-events').textContent = eventsData.count;
                    document.getElementById('events-count').textContent = eventsData.count;
                }

                // ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
                const suggestionsResponse = await fetch('/api/suggestions');
                const suggestionsData = await suggestionsResponse.json();
                if (suggestionsData.status === 'success') {
                    document.getElementById('total-suggestions').textContent = suggestionsData.count;
                    document.getElementById('suggestions-count').textContent = suggestionsData.count;
                }

                // ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙƒØªØ¨Ø©
                const libraryResponse = await fetch('/api/library');
                const libraryData = await libraryResponse.json();
                if (libraryData.status === 'success') {
                    document.getElementById('total-library').textContent = libraryData.count;
                    document.getElementById('library-count').textContent = libraryData.count;
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…:', error);
            }
        }

        // Ø¯Ø§Ù„Ø© Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
        function showSection(sectionName) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø­Ø¯Ø¯
            const targetSection = document.getElementById(sectionName + '-section');
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ØªÙ†Ù‚Ù„
            const navItems = document.querySelectorAll('.nav-item, .nav-item-mobile');
            navItems.forEach(item => item.classList.remove('active'));
            
            const activeNavItem = document.querySelector(`[onclick="showSection('${sectionName}')"]`);
            if (activeNavItem) {
                activeNavItem.classList.add('active');
            }
            
            // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø³Ù… Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
            switch(sectionName) {
                case 'events':
                    loadEvents();
                    break;
                case 'suggestions':
                    loadSuggestions();
                    break;
                case 'library':
                    loadLibrary();
                    break;
                case 'home':
                    loadDashboardStats();
                    break;
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            loadAllSections();
        });
        
        });
    </script>

</body>
</html>